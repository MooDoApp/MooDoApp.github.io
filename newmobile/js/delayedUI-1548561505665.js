(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{533:function(e,t,a){"use strict";var n=a(7),o=a.n(n),i=a(8),s=a.n(i),r=a(16),l=a.n(r),c=a(9),u=a.n(c),d=a(17),m=a.n(d),h=a(0),p=a(4),f=a(2),g=a.n(f),v=a(19),y=a(5),C=a(3),k=a(81),E=a(13),x=function(e){function t(){return o()(this,t),l()(this,u()(t).apply(this,arguments))}return m()(t,e),s()(t,[{key:"close",value:function(e){C.a.isMobile&&y.a.closeKeyboard(),this.props.onClose&&this.props.onClose(),p.default.menus.closeModal(this.props.modalID,e)}},{key:"onCloseButton",value:function(e){this.props.onCloseButton?this.props.onCloseButton():this.close()}},{key:"onEscapeKey",value:function(){this.props.noCancel||this.close()}},{key:"render",value:function(){var e,t,a,n=this.props,o=this.getChildByKey("sidebar"),i=this.getChildByKey("content"),s=this.getChildByKey("buttons"),r=C.a.isMobile,l={maxHeight:!C.a.isMobile&&n.height?"85%":null},c=h.default.classNames("fancyModal c-bg-app popup c-shadow-popup",n.className,{"flexbox flexvert":C.a.isMobile},{small:n.small},{hasSidebar:!!o},{hasTitle:r&&!!n.title},{hasButtons:!!s}),u=h.default.classNames("fancyModalWrapper",{"small flexbox":n.small}),d=h.default.classNames("fancyModalContent c-border c-background f1",i.props.className),m=C.a.isMobile?h.default.topBarHeight:36,p=g.a.createElement(n.scrollable?k.a:"div",{className:d},i.props.children||i);if(C.a.isMobile)return n.confirmIcon?e=g.a.createElement(E.a,{className:"fancyModalMobileConfirm",icon:n.confirmIcon,iconSize:20,width:m,height:m,onClick:n.onConfirm}):n.confirmText&&(e=g.a.createElement(E.a,{className:"fancyModalMobileConfirm",width:n.topButtonWidth,fontSize:14,height:m,onClick:n.onConfirm},n.confirmText)),!1!==n.closeButton&&(t=h.default.isString(n.closeButton)?g.a.createElement(E.a,{className:"fancyModalClose",width:n.topButtonWidth,fontSize:14,height:m,onClick:this.onCloseButton},n.closeButton):g.a.createElement(E.a,{className:"fancyModalClose",icon:"icon-close",iconSize:20,width:m,height:m,onClick:this.onCloseButton})),g.a.createElement("span",{className:u},g.a.createElement("div",{className:c,style:l,id:n.id},g.a.createElement("div",{className:"flexbox"},t,g.a.createElement("div",{className:"fancyModalTitle f1"},n.title),e),p));if(n.small||(l.width=n.width,l.height=n.height,l.minWidth=n.minWidth),o){var f={width:n.sidebarWidth||180};a=g.a.createElement("div",{className:"fancyModalSidebar",style:f},o.props.children)}return g.a.createElement("span",{className:u},!n.noBackdrop&&g.a.createElement("div",{className:"fancyModalBackdrop",onClick:!1!==n.backdropClose?this.close.bind(this,!1):void 0}),g.a.createElement("div",{className:c,style:l,id:n.id},r&&!1!==n.closeButton&&g.a.createElement(E.a,{className:"fancyModalClose",icon:"icon-close",iconSize:20,width:m,height:m,onClick:this.onCloseButton,tooltip:"Close"}),r&&n.title&&g.a.createElement("div",{className:"fancyModalTitle"},n.title),g.a.createElement("div",{className:"fancyModalInside flexbox flex1"},a,g.a.createElement("div",{className:"fancyModalContentArea c-border-light c-background flexbox flexvert f1"},p,s&&g.a.createElement("div",{className:h.default.classNames("fancyModalButtons c-background")},s)))))}}]),t}(v.a);t.a=x},534:function(e,t,a){"use strict";var n=a(66),o=a.n(n),i=a(76),s=a.n(i),r=a(7),l=a.n(r),c=a(8),u=a.n(c),d=a(16),m=a.n(d),h=a(9),p=a.n(h),f=a(17),g=a.n(f),v=a(0),y=a(2),C=a.n(y),k=function(e){function t(){return l()(this,t),m()(this,p()(t).apply(this,arguments))}return g()(t,e),u()(t,[{key:"getValue",value:function(){return this.refs.select.value}},{key:"setValue",value:function(e){this.refs.select.value=e}},{key:"onChange",value:function(e){this.props.onChange&&this.props.onChange(this.getValue())}},{key:"render",value:function(){var e=this.props,t=e.onChange,a=e.className,n=e.children,i=s()(e,["onChange","className","children"]),r=v.default.classNames(a,"fancySelect c-background c-border");return C.a.createElement("select",o()({},i,{className:r,ref:"select",onChange:t?this.onChange:void 0}),n)}}]),t}(a(19).a);t.a=k},535:function(e,t,a){"use strict";var n=a(0),o=a(1),i=a(4),s=a(2),r=a.n(s),l=a(19).b.createClass({displayName:"ReactContact",componentDisplay:o.a.ComponentDisplay.Everywhere,onClickNumber:function(e,t){i.default.menus.closeContextMenu(),n.default.openUrl(e.link,t,!0)},onClickEmail:function(e,t){var a=n.default.vmMain.getDefaultEmailPlugin();if(a.isActive()){i.default.menus.closeContextMenu();var o={to:[{text:"",email:e.address}]};i.default.menus.openComposeEmail(a,void 0,void 0,o)}else n.default.openUrl(e.link,t,!0)},render:function(){var e=this,t=this.props.contact;return r.a.createElement("div",{className:"contactPreview"},r.a.createElement("div",{className:"contactName c-border"},t.text),t.phoneNumbers&&t.phoneNumbers.map(function(t){return r.a.createElement("div",{className:"contactRow contactPhone",key:t.number},r.a.createElement("i",{className:"contactButton icon-phone c-foreground-super-faded"}),r.a.createElement("span",{className:"contactNumber link",onClick:e.onClickNumber.bind(e,t)},t.number),r.a.createElement("span",{className:"phoneType c-foreground-faded"},t.type))}),t.emails&&t.emails.map(function(t){return r.a.createElement("div",{className:"contactRow contactEmail",key:t.address},r.a.createElement("i",{className:"icon-mail_outline contactButton c-foreground-super-faded"}),r.a.createElement("span",{className:"contactEmail link",onClick:e.onClickEmail.bind(e,t)},t.address))}))}});t.a=l},536:function(e,t,a){"use strict";a.r(t);var n=a(66),o=a.n(n),i=a(7),s=a.n(i),r=a(8),l=a.n(r),c=a(16),u=a.n(c),d=a(9),m=a.n(d),h=a(17),p=a.n(h),f=a(1),g=a(4),v=a(2),y=a.n(v),C=a(19),k=a(13),E=a(67),x=a(533),M=function(e){function t(){return s()(this,t),u()(this,m()(t).apply(this,arguments))}return p()(t,e),l()(t,[{key:"init",value:function(){this.createObservables({errorText:""})}},{key:"onMount",value:function(){this.refs.code.focus()}},{key:"onClickConfirm",value:function(){var e=this,t=this.refs.code.getValue();this.props.onSelect(t).then(function(){g.default.menus.closeModal(f.a.Modals.EnterCode)}).catch(function(t){e.errorText.set(t)})}},{key:"onClickCancel",value:function(){!1!==this.props.noCancel&&g.default.menus.closeModal(f.a.Modals.EnterCode)}},{key:"render",value:function(){var e=this.props,t=e.text,a=e.noCancel,n=e.isPassword;return y.a.createElement(x.a,o()({},this.props,{id:"modalEnterCode",closeButton:!1,width:360,scrollable:!1,modalID:f.a.Modals.EnterCode,backdropClose:!1,ref:"modal"}),y.a.createElement("div",{key:"content"},y.a.createElement("div",{className:"mb16 c-foreground"},t),y.a.createElement(E.a,{ref:"code",type:n&&"password",onEnter:this.onClickConfirm}),y.a.createElement("div",{className:"red"},this.state.errorText),y.a.createElement("div",{style:{marginTop:24,textAlign:"right"}},!a&&y.a.createElement(k.a,{width:100,onClick:this.onClickCancel},"CANCEL"),y.a.createElement(k.a,{primary:!0,width:100,onClick:this.onClickConfirm},"CONFIRM"))))}}]),t}(C.a);t.default=M},537:function(e,t,a){"use strict";a.r(t);var n=a(66),o=a.n(n),i=a(1),s=a(4),r=a(2),l=a.n(r),c=a(19),u=a(59),d=a(40),m=a(101),h=c.b.createClass({displayName:"ReactContextMenuSelectGmailAccount",componentDisplay:i.a.ComponentDisplay.Everywhere,addPane:function(e){this.props.onSelected(e)},render:function(){var e=this,t=this.props,a=s.default.pluginManager.getPluginGmail(),n=a.getSyncAccounts();return l.a.createElement(u.a,o()({},t,{key:"contextMenuTitle",id:"contextMenuTitle",maxHeight:400}),t.showHeader&&l.a.createElement(m.a,{topHeader:!0},"Open Gmail Account"),n.map(function(t){var n=a.getDefaultDisplayItem(t);return l.a.createElement(d.a,{key:t,onClick:e.addPane.bind(e,n)},t)}))}});t.default=h},538:function(e,t,a){"use strict";a.r(t);var n=a(66),o=a.n(n),i=a(1),s=a(4),r=a(2),l=a.n(r),c=a(19),u=a(41),d=a(67),m=a(59),h=a(13),p=c.b.createClass({displayName:"ReactContextMenuInsertLink",componentDisplay:i.a.ComponentDisplay.Everywhere,init:function(){var e=this.props.text,t=i.a.Regexp.MDLink,a=new RegExp(/\S{2,}\.[^0-9.\s]{2,}\S*$/);t.lastIndex=0;var n=t.exec(e);n?(this.text=n[2],this.link=n[3]):null===a.exec(e)?this.text=e:this.link=e},getHotkeys:function(){return[u.a.create(i.a.KeyCode.Enter,!0,i.a.Primary.Either,i.a.Shift.Either,this.onClick),u.a.create(i.a.KeyCode.Escape,!0,i.a.Primary.Either,i.a.Shift.Either,this.close)]},onMount:function(){var e;(e=this.link||!this.text?this.refs.text:this.refs.link).focus(),e.selectAll()},close:function(){s.default.menus.closeContextMenu("ReactContextMenuInsertLink")},onClickRemove:function(){var e=this.refs.text.getValue();this.props.onInsertLink({text:e,url:""})},onClick:function(){var e=this.refs.text.getValue(),t=this.refs.link.getValue();(e||t)&&s.default.menus.isContextMenuOpen("ReactContextMenuInsertLink")&&(this.close(),t&&!t.startsWith("http")&&(t="http://"+t),this.props.onInsertLink({text:e,url:t}))},render:function(){return l.a.createElement(m.a,o()({},this.props,{key:"contextMenuInsertLink",id:"contextMenuInsertLink"}),l.a.createElement("div",{className:"flexbox"},l.a.createElement("span",null,"Text"),l.a.createElement(d.a,{className:"f1",ref:"text",height:28,width:260,value:this.text||this.link,onEnter:this.onClick,onEscape:this.close})),l.a.createElement("div",{className:"flexbox"},l.a.createElement("span",null,"Link"),l.a.createElement(d.a,{className:"f1",ref:"link",height:28,width:260,value:this.link,onEnter:this.onClick,onEscape:this.close})),l.a.createElement("div",{className:"flexbox",style:{marginTop:16}},this.link&&l.a.createElement(h.a,{cancel:!0,height:32,onClick:this.onClickRemove},"REMOVE"),l.a.createElement("div",{className:"f1"}),l.a.createElement(h.a,{primary:!0,height:32,onClick:this.onClick},"INSERT")))}});t.default=p},539:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a(4),i=a(2),s=a.n(i),r=a(19),l=a(535),c=a(59),u=r.b.createClass({displayName:"ReactContextMenuContactDetails",componentDisplay:n.a.ComponentDisplay.Everywhere,onClose:function(){o.default.menus.closeContextMenu("ReactContextMenuContactDetails")},render:function(){return s.a.createElement(c.a,{key:"contextMenuContactDetails",id:"contextMenuContactDetails",element:this.props.element,position:this.props.position},s.a.createElement(l.a,{contact:this.props.contact,onClose:this.onClose}))}});t.default=u},540:function(e,t,a){"use strict";a.r(t);var n=a(66),o=a.n(n),i=a(1),s=a(4),r=a(2),l=a.n(r),c=a(19),u=a(13),d=a(59),m=c.b.createClass({displayName:"ReactContextMenuMobileOpenLink",componentDisplay:i.a.ComponentDisplay.Mobile,onClickOpen:function(){this.props.onClick(),s.default.menus.closeContextMenu()},render:function(){var e=this.props;return l.a.createElement(d.a,o()({},e,{key:"contextMenuMobileOpenLink",id:"contextMenuMobileOpenLink",className:"flexbox"}),l.a.createElement("div",{className:"f1"},e.html),l.a.createElement(u.a,{primary:!0,onClick:this.onClickOpen},"OPEN"))}});t.default=m},541:function(e,t,a){"use strict";a.r(t);var n=a(66),o=a.n(n),i=a(0),s=a(1),r=a(4),l=a(3),c=a(6),u=a(2),d=a.n(u),m=a(19),h=a(45),p=a(73),f=a(21),g=a(5),v=a(100),y=a(13),C=a(59),k=a(40),E=m.b.createClass({displayName:"ReactContextMenuDropBucket",componentDisplay:s.a.ComponentDisplay.Everywhere,init:function(){this.createObservables({draggingItem:void 0})},onMount:function(){f.a.listen("droppedItem",this.onItemDropped)},onUnmount:function(){f.a.unlisten("droppedItem",this.onItemDropped)},getState:function(){return{items:r.default.dropBucket.getItems(),isDragging:r.default.DragDrop.isVisible}},createEvent:function(e,t){var a=i.default.findChild(t.target,"item")||i.default.findParent(t.target,"item",5);return{fromDropBucket:!0,startSrc:a,target:a,clientX:t.clientX,clientY:t.clientY,eventX:t.eventX||t.clientX,eventY:t.eventY||t.clientY,pageX:t.pageX,pageY:t.pageY,preventDefault:i.default.emptyFn,stopPropagation:i.default.emptyFn,stopImmediatePropagation:i.default.emptyFn,pane:e.pane}},onMouseDown:function(e,t){if(e.item&&l.a.isMobile){var a=this.createEvent(e,t);r.default.DragDrop.startDragItem=e.item,e.item.dragStart(a),e.item.dragMove(a)}},onClickItem:function(e,t){var a=this;if(!i.default.hasClass(t.target,"fancyButton")&&!l.a.isMobile){var n={mode:s.a.AutocompleteMode.Move,text:"Select item to move to",buttonText:"MOVE",elementDisplay:t.target,pane:this.props.pane,onSelected:function(t){c.e.beginAction();var n=e.item.clone(t.item,s.a.ChangeType.Local);t.item.insertItem(n,0),e.item.parent().removeChild(e.item,s.a.ChangeType.Local),r.default.dropBucket.removeItemEntry(e.id),0===a.state.items.length&&r.default.menus.closeContextMenu(),c.e.endAction()}};h.a.showPopup(n)}},onMouseMove:function(e,t){if(e.item&&l.a.isMobile){var a=this.createEvent(e,t);g.a.onMouseMoveDocument(a),e.item.onMove(a),this.draggingItem.set(e.item)}},onMouseUp:function(e,t){if(e.item&&l.a.isMobile){var a=this.createEvent(e,t);e.item.onEnd(a),this.draggingItem.set(void 0),0===this.state.items.length&&r.default.menus.closeContextMenu()}},onCloseButton:function(e,t){e.item&&r.default.dropBucket.hasItemEntry(e.item)&&r.default.dropBucket.removeItemEntry(e.item.id),t.stopPropagation()},onItemDropped:function(e){r.default.dropBucket.hasItemEntry(e)&&r.default.dropBucket.removeItemEntry(e.id)},_renderBucketItem:function(e,t){return e.item?d.a.createElement(v.a,{item:e.item,allowDrag:!0}):d.a.createElement(p.a,null,e.text)},render:function(){for(var e=0,t=this.props,a=this.state,n=[],s=0;s<a.items.length;s++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var r=a.items[s],c=r.item,u=r.id,m={width:"100%",overflow:"hidden"},h=i.default.classNames({dragging:a.draggingItem===c});l.a.isMobile||(m.maxWidth="335px"),n.push(d.a.createElement(k.a,{key:u,className:h,onClick:this.onClickItem.bind(this,r),clickCloses:!1,hasButtons:!0,hoverEffects:!0},d.a.createElement(p.a,{style:m,onMouseDown:this.onMouseDown.bind(this,r),onMouseMove:this.onMouseMove.bind(this,r),onMouseUp:this.onMouseUp.bind(this,r)},this._renderBucketItem(r,s)),d.a.createElement(y.a,{icon:"icon-close",width:"48px",iconSize:20,onClick:this.onCloseButton.bind(this,r)})))}return d.a.createElement(C.a,o()({},t,{key:"contextMenuDropBucket",id:"contextMenuDropBucket",supportArrows:!0}),n)}});t.default=E},542:function(e,t,a){"use strict";a.r(t);var n=a(66),o=a.n(n),i=a(1),s=a(4),r=a(2),l=a.n(r),c=a(19),u=a(62),d=a(59),m=a(13),h=c.b.createClass({displayName:"ReactContextMenuAuthorize",componentDisplay:i.a.ComponentDisplay.Everywhere,onClickEnable:function(){u.a.refresh(),u.a.enableOfflineFeatures(!1,this.onEnable)},onEnable:function(e){e&&s.default.menus.closeContextMenu()},render:function(){return l.a.createElement(d.a,o()({},this.props,{key:"contextMenuAuthorize",id:"contextMenuAuthorize"}),l.a.createElement("div",null,this.props.message),l.a.createElement("div",{className:"center"},l.a.createElement(m.a,{primary:!0,raised:!0,onClick:this.onClickEnable},"AUTHORIZE")))}});t.default=h},543:function(e,t,a){"use strict";a.r(t);var n=a(66),o=a.n(n),i=a(0),s=a(1),r=a(2),l=a.n(r),c=a(19),u=a(73),d=a(13),m=a(59),h=c.b.createClass({displayName:"ReactContextMenuMobileFilter",componentDisplay:s.a.ComponentDisplay.Mobile,init:function(){this.listenTo(this.props.pane.search.onChanged)},getState:function(){for(var e=0,t=this.props.pane.search,a={hasFilter:!1},n=0;n<t.filters.length;n++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var o=t.filters[n];a[o.name]=o.value,0!==o.value&&(a.hasFilter=!0)}return a},onClickClear:function(){for(var e=0,t=this.props.pane.search,a=0;a<t.filters.length;a++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var n=t.filters[a];0!==this.state[n.name]&&t.setFilter(n.name,0)}},onClickFilter:function(e,t){var a=this.props.pane.search;a.getFilterValue(e.name)===t&&(t=0),a.setFilter(e.name,t)},renderSearchButton:function(e,t){var a=i.default.classNames("searchFilterButton c-border",e.icon,{yes:t>0},{no:t<0},{selected:t===this.state[e.name]});return l.a.createElement(u.a,{className:a,onClick:this.onClickFilter.bind(this,e,t)})},renderSearchFilter:function(e){for(var t=0,a=(e.text||e.name).capitalize(),n=a.length-1;n>=1;n--){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;a[n]===a[n].toUpperCase()&&(a=a.substr(0,n)+" "+a.substr(n))}return l.a.createElement("div",{key:e.name,className:"searchFilter flexbox"},l.a.createElement("div",{className:"menuItemText f1"},a),this.renderSearchButton(e,1),!1!==e.canBeNegated?this.renderSearchButton(e,-1):l.a.createElement("div",{className:"searchFilterButton"}))},renderSearchPriorityButton:function(e,t){var a=i.default.classNames("searchPriorityButton c-border",{p0:t===s.a.VMLIFlag.P0},{p1:t===s.a.VMLIFlag.P1},{p2:t===s.a.VMLIFlag.P2},{selected:t===this.state[e.name]});return l.a.createElement(u.a,{className:a,onClick:this.onClickFilter.bind(this,e,t)})},renderSearchPriority:function(e){return l.a.createElement("div",{key:e.name,className:"searchPriority flexbox"},this.renderSearchPriorityButton(e,s.a.VMLIFlag.P0),this.renderSearchPriorityButton(e,s.a.VMLIFlag.P1),this.renderSearchPriorityButton(e,s.a.VMLIFlag.P2))},render:function(){for(var e,t=0,a=this.props,n=a.pane.search,i=[],s=!0,r=0;r<n.filters.length;r++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var c=n.filters[r];c.enabled.get()&&(c.isOption&&s&&(i.push(l.a.createElement("hr",{key:"hrOption"})),s=!1),c.icon?i.push(this.renderSearchFilter(c)):"priority"===c.name&&(e=this.renderSearchPriority(c)))}return l.a.createElement(m.a,o()({},a,{key:"contextMenuMobileFilter",id:"contextMenuMobileFilter"}),l.a.createElement(d.a,{icon:"icon-close",display:"block",enabled:this.state.hasFilter,onClick:this.onClickClear},"Clear filters"),l.a.createElement("div",{className:"searchFilter filterTitle flexbox c-foreground-very-faded c-border"},l.a.createElement("div",{className:"menuItemText f1"},"Filter"),l.a.createElement("div",null,"Show"),l.a.createElement("div",null,"Hide")),i,e&&l.a.createElement("div",{className:"searchFilter filterTitle c-foreground-very-faded c-border"},"Minimum Priority"),e)}});t.default=h},544:function(e,t,a){"use strict";a.r(t);var n=a(66),o=a.n(n),i=a(7),s=a.n(i),r=a(8),l=a.n(r),c=a(16),u=a.n(c),d=a(9),m=a.n(d),h=a(17),p=a.n(h),f=a(0),g=a(1),v=a(4),y=a(3),C=a(2),k=a(19),E=a(532),x=(a(531),a(67)),M=a(59),b=a(63),N=a(13),w=a(57),D=a(87),S=Object(E.c)(E.a),T=function(e){function t(){return s()(this,t),u()(this,m()(t).apply(this,arguments))}return p()(t,e),l()(t,[{key:"init",value:function(){for(var e=0,t=[],a=0;a<24;a++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var n=a%12===0?"12":a>12?a-12:a,o=a>=12?"pm":"am";t.push(n+":00 "+o),t.push(n+":30 "+o)}if(this.times=t,this.createObservables({selectedDate:{start:void 0,end:void 0},selectedTimes:[],text:void 0}),this.updateText(),this.textOffset=this.props.textOffset,void 0===this.textOffset){var i=this.props.item.getParsedText(),s=i.indexOf(g.a.CharDate);this.textOffset=s>=0?s:i.length}}},{key:"onMount",value:function(){this.updateDateTime()}},{key:"setMooDate",value:function(e){var t=this.props.item,a=this.textOffset,n=t.getParsedText();if(t.setMooDate(e,g.a.ChangeType.Local),e&&void 0!==a&&t.getRawText().indexOf(g.a.CharDate)<0){var o=a,i="";n[a-1]===g.a.PrefixDate?o--:" "!==n[o]&&(i=" ");var s=n.substr(a);s=s?" "+s:" ",n=(n.substr(0,o)+i+g.a.CharDate+s).replace(/  /g," "),t.setText(n,g.a.ChangeType.Local)}}},{key:"getMooDate",value:function(){return this.props.item.getMooDate()}},{key:"onInputChange",value:function(e){f.default.timeoutOnce("ctxMenuDateUpdateDate",this._onInputChangeTimeout.bind(this,e),200)}},{key:"_onInputChangeTimeout",value:function(e){var t=b.a.parseText(e);this.setMooDate(t),this.updateDateTime(),this.text.set(e)}},{key:"onClickClearDate",value:function(){this.onInputChange("")}},{key:"onClickSave",value:function(){v.default.menus.closeContextMenu("ReactContextMenuDate")}},{key:"updateDateTime",value:function(){var e=this.getMooDate();if(e){var t=e.getTime();if(t){var a=0;t=Math.round(t/36e4);for(var n=2*Math.floor(t/10)+(t%10>0?1:0),o=e.getDuration()/(30*g.a.MSPerMinute)||2,i=[],s=n;s<n+o;s++){if(a++>5e3&&__infLoop&&__infLoop(a))throw new RangeError;i.push(s)}this.selectedTimes.set(i),this.refs.times.scrollTop=28*(n-3)}if(e.isRange()){var r=e.getStart(),l=e.getEnd();r||(r=new Date),l||(l=new Date(r).addMonths(3)),this.selectedDate.set({start:r,end:l})}else this.selectedDate.set(e.getAllDates())}else this.selectedDate.set(void 0)}},{key:"onMouseDownTime",value:function(e){this._mouseDownOnTime=e,this.selectedTimes.set([e]);var t=this.getMooDate();t||(t=w.a.now(),this.setMooDate(t)),t.setHours(e/2),t.setDuration(30*g.a.MSPerMinute),this.updateText(),document.addEventListener("mouseup",this.onMouseUpTime)}},{key:"onMouseMoveTime",value:function(e){if(void 0!==this._mouseDownOnTime){var t,a,n=0,o=this.selectedTimes.get();e<=this._mouseDownOnTime?(t=e,a=this._mouseDownOnTime):(t=this._mouseDownOnTime,a=e),o=[];for(var i=t;i<=a;i++){if(n++>5e3&&__infLoop&&__infLoop(n))throw new RangeError;o.push(i)}this.duration=o.length>0?30*o.length*g.a.MSPerMinute:void 0,this.getMooDate().setDuration(this.duration),this.updateText(),this.selectedTimes.set(o)}}},{key:"onMouseUpTime",value:function(){this.setMooDate(this.getMooDate()),this._mouseDownOnTime=void 0,document.removeEventListener("mouseup",this.onMouseUpTime)}},{key:"onSelectDate",value:function(e){this.selectedDate.set(e),this.setMooDate(e.start&&e.end?w.a.fromRange(e.start,e.end,(this.state.selectedTimes[0]||0)/2,this.duration):void 0),this.updateText()}},{key:"onChangeRepeatComplete",value:function(e){var t=this.getMooDate();if(t){var a=this.props.item;t.setRepeatOnComplete(e),a.onMooDateUpdated(g.a.ChangeType.Local)}}},{key:"onInputEnter",value:function(){v.default.menus.closeContextMenu("ReactContextMenuDate")}},{key:"updateText",value:function(){var e=this.getMooDate();this.text.set(e?e.toText():"")}},{key:"render",value:function(){var e=this,t=this.state,a=this.getMooDate(),n=a&&a.repeatComplete,i=this.times.map(function(a,n){var o=t.selectedTimes.indexOf(n)>=0,i=f.default.classNames({"c-popup-item":!o},{selected:o});return C.createElement("div",{key:a,className:i,onMouseDown:e.onMouseDownTime.bind(e,n),onMouseMove:e.onMouseMoveTime.bind(e,n)},a)});return C.createElement(M.a,o()({},this.props,{id:"contextMenuDate",width:352,maxHeight:1800}),C.createElement("div",{className:"flexbox"},C.createElement(x.a,{className:"f1",placeholder:"Type or select a date",onChange:this.onInputChange,onEnter:this.onInputEnter,value:t.text,focused:!0,border:!1,ref:"input"}),C.createElement(N.a,{height:40,onClick:this.onClickClearDate},"Clear"),y.a.isMobile&&C.createElement(N.a,{primary:!0,raised:!0,height:40,onClick:this.onClickSave},"Save")),C.createElement("div",null,C.createElement(D.a,{initialChecked:n,onChange:this.onChangeRepeatComplete},"Repeat from complete date")),C.createElement("div",{className:"calendarContainer flexbox c-border-heavy",style:{width:352,height:200}},C.createElement(E.b,{Component:S,autoFocus:!1,width:252,height:200,rowHeight:36,selected:t.selectedDate,onSelect:this.onSelectDate,displayOptions:{showHeader:!1,showOverlay:!1}}),C.createElement("div",{className:"times c-border-heavy scrollable f1",ref:"times"},i)))}}]),t}(k.a);t.default=T},545:function(e,t,a){"use strict";a.r(t);var n=a(7),o=a.n(n),i=a(8),s=a.n(i),r=a(16),l=a.n(r),c=a(9),u=a.n(c),d=a(17),m=a.n(d),h=a(0),p=a(3),f=a(1),g=a(4),v=a(2),y=a.n(v),C=a(72),k=a.n(C),E=a(19),x=a(45),M=a(100),b=a(535),N=0,w=1,D=2,S=4,T=8,I=["now","soon","later","someday"],A=["today","tomorrow"],P=["next"],R=["mon","tue","wed","thu","fri","sat","sun"],O=["january","february","march","april","may","june","july","august","september","october","november","december"],F=["every"],L=["first","other","last"],B=[0,1,2,3,4,5,6],V=(I.concat(F).concat(A).concat(L).concat(P).concat(R).concat(O),E.b.createClass({displayName:"ReactAutocompleteDates",componentDisplay:f.a.ComponentDisplay.Everywhere,init:function(){this.text="",this.createObservables({nextDateWord:N})},isInMode:function(e){return 0===e?0===this.state.nextDateWord:h.default.isFlagSet(this.state.nextDateWord,e)},getShortMonth:function(e){return Date.CultureInfo.abbreviatedMonthNames[e]},getLongMonth:function(e){return Date.CultureInfo.monthNames[e]},getShortDay:function(e){return Date.CultureInfo.abbreviatedDayNames[e]},getLongDay:function(e){return Date.CultureInfo.dayNames[e]},getMonthList:function(){var e=0,t=(new Date).getMonth()-1;t<0&&(t=12+t);for(var a=t+1+5,n=[],o=t;o<a;++o){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var i=o%12;n.push(i)}return n},nextWordOptions:function(e){var t=e.toLowerCase().split(" "),a=t[t.length-1];if(""===a&&(a=t[t.length-2]),I.indexOf(a)>=0)return N;if(F.indexOf(a)>=0)return w|T;if(L.indexOf(a)>=0)return w;if(A.indexOf(a)>=0)return S;if(P.indexOf(a)>=0)return w;if(R.indexOf(a)>=0)return S;if(O.indexOf(a)>=0)return D;var n=parseInt(a,10);return isNaN(n)?a.indexOf(":")>=0?S:N:S},onMouseDown:function(e){h.default.preventAndStop(e)},onTapDate:function(e){var t=e.target;if("SPAN"===t.nodeName){var a=t.getAttribute("data-text")||t.textContent.trim(),n=this.nextWordOptions(a),o=n===N;this.nextDateWord.set(n),this.text+=a,h.default.findParentID(t,"autocompleteHours",2)||h.default.findParentID(t,"autocompleteMinutes",2)||(this.text+=" "),this.props.setText(this.text),o&&this.props.onSelected()}},render:function(){var e=this,t=(this.state.nextDateWord,""===this.text);return y.a.createElement("div",{id:"autocompleteDates",className:"f1",onMouseDown:this.onMouseDown,onClick:this.onTapDate},(this.isInMode(N)||this.isInMode(w))&&y.a.createElement("div",{id:"autocompleteDate"},!this.isInMode(T)&&y.a.createElement("div",{className:h.default.classNames({disabled:!t})},y.a.createElement("span",null,"today"),y.a.createElement("span",null,"tomorrow"),y.a.createElement("span",null,"next"),y.a.createElement("span",null,"every")),this.isInMode(T)&&y.a.createElement("div",null,y.a.createElement("span",null,"first"),y.a.createElement("span",null,"other"),y.a.createElement("span",null,"last")),y.a.createElement("div",{id:"datePickerDays"},B.map(function(t){var a=e.getLongDay(t);return y.a.createElement("span",{key:a},e.getShortDay(t))})),y.a.createElement("div",{className:h.default.classNames({disabled:!t})},e.getMonthList().map(function(t){var a=e.getLongMonth(t);return y.a.createElement("span",{key:a,"data-text":a},e.getShortMonth(t))}))),this.isInMode(D)&&y.a.createElement("div",{id:"autocompleteDay"},y.a.createElement("div",{className:"flexcolumn"},y.a.createElement("div",{className:"autocompleteDays"},Array.apply(0,Array(31)).map(function(e,t){return y.a.createElement("span",{key:t},t+1)})))),this.isInMode(S)&&y.a.createElement("div",{id:"autocompleteTime"},y.a.createElement("div",{className:"flexcolumn"},y.a.createElement("div",{id:"autocompleteHours"},Array.apply(0,Array(12)).map(function(e,t){return y.a.createElement("span",{key:t},t+1)}))),y.a.createElement("div",{className:"flexcolumn"},y.a.createElement("div",{id:"autocompleteMinutes"},y.a.createElement("span",null,":15"),y.a.createElement("span",null,":30"),y.a.createElement("span",null,":45"))),y.a.createElement("div",{className:"flexcolumn"},y.a.createElement("div",{id:"autocompleteAMPM"},y.a.createElement("span",null,"am"),y.a.createElement("span",null,"pm")))))}})),K=a(13),H=a(67),U=a(81),z=a(59),W=a(40),G=a(534),Y=a(18),j=function(e){function t(){return o()(this,t),l()(this,u()(t).apply(this,arguments))}return m()(t,e),s()(t,[{key:"init",value:function(){var e=this.props;this.createObservables({selectedIndex:e.elementInput||e.fromPane||e.onlyMatches?0:-1,expanded:-1,selectedDocument:Y.a.getDefaultDocument()})}},{key:"onMount",value:function(){if(this.hasOwnInput()){var e=this.props,t=this.refs.input;t&&(t.focus(),t.updateAutocomplete(e.item||e.items&&e.items[0]))}document.addEventListener("keydown",this.onInputKeyDown,!0)}},{key:"componentWillReceiveProps",value:function(e){this.props.matches!==e.matches&&this.updateState(e)}},{key:"onUnmount",value:function(){document.removeEventListener("keydown",this.onInputKeyDown,!0)}},{key:"onBeforeChanged",value:function(e,t){var a=this.refs;if(e.matches!==t.matches&&!e.hasSpecialMatches){this.expanded.set(-1,!1),e.expanded=-1;var n=!a.input||!this.props.allowCustom&&a.input.getValue()&&this.state.matches.length>0?0:-1;this.selectedIndex.set(n,!1),e.selectedIndex=n}}},{key:"onAfterChanged",value:function(e,t){e.matches.length>t.matches.length&&setTimeout(function(){this.refs.contextMenu&&this.refs.contextMenu.updateState()}.bind(this),0)}},{key:"getState",value:function(e){var t=this.getSpecialMatches();return{matches:e.matches||t||x.a.matches,hasSpecialMatches:!!t,kbsize:p.a.kbsize,owner:x.a.owner}}},{key:"updateTextFromIndex",value:function(){if(this.hasOwnInput()){var e=this.refs.input,t=this.selectedIndex.get(),a="";if(t>=0){var n=this.state.matches[t];a=this.getInsertText(n)}e.setValue(a),e.selectEnd()}}},{key:"onInputKeyDown",value:function(e){var t=this.state,a=this.props;if(a.allowCustom&&e.keyCode===f.a.KeyCode.Enter)this.onSelected(),h.default.preventDefault(e),h.default.stopPropagation(e);else if(t.matches.length>0){var n=this.selectedIndex.get();if(t.matches.length>1&&(e.keyCode===f.a.KeyCode.DownArrow||e.keyCode===f.a.KeyCode.UpArrow)){if(e.keyCode===f.a.KeyCode.UpArrow?--n<(a.allowCustom?-1:0)&&(n=t.matches.length-1):e.keyCode===f.a.KeyCode.DownArrow&&++n>t.matches.length-1&&(n=a.allowCustom?-1:0),n!==this.selectedIndex.get()&&(this.selectedIndex.set(n),this.updateTextFromIndex(),n>=0)){var o=this.refs["item_"+this.selectedIndex.get()];try{h.default.PAssert(1611,o,"Item must exist in autocomplete to be scrolled to")}catch(s){h.default.reportError(s)}if(o){var i=k.a.findDOMNode(o);h.default.scrollIntoView(i,f.a.ScrollDuration.Default)}}h.default.preventDefault(e)}else e.keyCode===f.a.KeyCode.RightArrow?this.expanded.set(n):e.keyCode===f.a.KeyCode.Enter&&n>=0&&(this.onSelected(),h.default.preventDefault(e),h.default.stopPropagation(e))}}},{key:"onEscapeKey",value:function(){this.hide()}},{key:"hide",value:function(){x.a.hide()}},{key:"onMouseOver",value:function(e){this.selectedIndex.set(e)}},{key:"onClick",value:function(e){this.selectedIndex.set(e),this.updateTextFromIndex(),this.onSelected()}},{key:"onButtonClick",value:function(){this.onSelected()}},{key:"hasOwnInput",value:function(){return p.a.isMobile||!this.props.elementInput&&!this.props.fromPane&&!this.props.onlyMatches}},{key:"onSelected",value:function(){var e,t,a=this.props,n=this.state,o=this.refs.input,i={owner:n.owner,index:a.indexInPane};if(a.allowCustom)(a.allowEmpty||o.getValue())&&(t={text:o.getValue()});else{var s=this.selectedIndex.get();t=this.state.matches[s]}t&&("contact"===t.type&&"email"===this.props.mode?(e=x.a.insertMatch(""),i.token=t):"item"===t.type?(e=x.a.insertMatch(""),i.item=t.item):e=x.a.insertMatch(this.getInsertText(t)),e&&(i.value=e.text,i.offset=e.offset),a.onSelected?a.onSelected(i):n.owner&&n.owner.onAutocompleteSelected&&n.owner.onAutocompleteSelected(i),this.hide())}},{key:"getInsertText",value:function(e){return"email"===this.props.mode?e.text+" <"+e.email+">":"snooze"===e.type?e.insertText:e.text}},{key:"insertHighlight",value:function(e){var t=[],a=x.a.getText(),n=e.toUpperCase().indexOf(a.toUpperCase());return n>=0&&a.length>0?(n>0&&t.push(e.substr(0,n)),t.push(y.a.createElement("span",{key:"match",className:"ac-match c-bg-autocomplete-highlight"},e.substr(n,a.length))),e.length>n+a.length&&t.push(e.substr(n+a.length))):t=e,t}},{key:"onClickExpand",value:function(e,t){this.expanded.set(e),t.stopPropagation()}},{key:"onClickExpandedInput",value:function(e){e.stopPropagation()}},{key:"onSelectedAddChild",value:function(){var e=this.props,t=this.state,a=t.expanded,n=t.matches[a];if(e.onSelected){var o={item:n.item,subItemText:this.refs.inputAdd.getValue()};e.onSelected(o)}}},{key:"getSpecialMatches",value:function(){if("snooze"===this.props.mode){var e=new Date,t=e.getHours(),a=e.getDay(),n=e.clone().clearTime().addHours(Math.min(t+3,23+59/60)),o=e.clone().clearTime();t<18?o.addHours(19):o.addHours(Math.min(t+2,23+59/60));var i=e.clone().clearTime();a<6?i.addDays(6-e.getDay()).addHours(9):6===a?i.addDays(1).addHours(9):i.addHours(Math.min(t+3,23+59/60));var s=e.clone().clearTime();a>0?s.addDays(8-e.getDay()).addHours(9):s.addDays(1).addHours(9);var r=e.clone().clearTime().addDays(1).addHours(9),l=e.clone().clearTime().addDays(1).addHours(19);return[{type:"snooze",icon:"icon-access_time",iconColor:"#f30",text:"Later Today",insertText:"Today "+n.toString(g.default.International.getFormat(f.a.DFormat.ShortTime)),date:n,showDay:!1},{type:"snooze",icon:"icon-access_time",iconColor:"#fa0",text:"Tonight",insertText:"Today "+o.toString(g.default.International.getFormat(f.a.DFormat.ShortTime)),date:o,showDay:!1},{type:"snooze",icon:"icon-access_time",iconColor:"#fd0",text:"Tomorrow Morning",insertText:"Tomorrow "+r.toString(g.default.International.getFormat(f.a.DFormat.ShortTime)),date:r,showDay:!0},{type:"snooze",icon:"icon-access_time",iconColor:"#2a6",text:"Tomorrow Night",insertText:"Tomorrow "+l.toString(g.default.International.getFormat(f.a.DFormat.ShortTime)),date:l,showDay:!0},{type:"snooze",icon:"icon-access_time",iconColor:h.default.colorBlue,text:"This Weekend",insertText:i.toString(g.default.International.getFormat(f.a.DFormat.NoPadShortDayTime)),date:i,showDay:!0},{type:"snooze",icon:"icon-access_time",iconColor:"#b0d",text:"Next Week",insertText:s.toString(g.default.International.getFormat(f.a.DFormat.NoPadShortDayTime)),date:s,showDay:!0}]}}},{key:"onCloseButton",value:function(){g.default.menus.closeContextMenu()}},{key:"setText",value:function(e){this.refs.input.setValue(e)}},{key:"onAutocompleteDateChange",value:function(e){this.setText(e),this.refs.input.selectEnd()}},{key:"onChangeDocument",value:function(e){this.selectedDocument.set(Y.a.getDocumentById(e))}},{key:"renderSpecialAutocomplete",value:function(){if(p.a.isMobile&&"date"===this.props.mode)return y.a.createElement(V,{setText:this.onAutocompleteDateChange,onSelected:this.onSelected})}},{key:"renderRightContent",value:function(){var e=this.state;if(e.matches.length>0&&e.selectedIndex>=0){var t,a=e.matches[e.selectedIndex];if("contact"===a.type&&(t=y.a.createElement(b.a,{contact:a})),t)return y.a.createElement("div",{className:"newAutocompleteRightContent c-border"},t)}}},{key:"renderObject",value:function(e,t){var a;switch(e.type){case"contact":if(e.text&&e.email){a=this.insertHighlight(e.text);var n=this.insertHighlight(" <"+e.email+">");return y.a.createElement("span",null,y.a.createElement("span",{className:"contact c-contact"},a),n)}if(e.email)return e.email;if(e.text)return a=this.insertHighlight(e.text),y.a.createElement("span",{className:"contact c-contact"},a);break;case"tag":return a=this.insertHighlight(e.text),y.a.createElement(y.a.Fragment,null,y.a.createElement("span",{className:"tag c-tag"},a),y.a.createElement("span",{className:"number c-foreground-faded"},e.count));case"date":return a=this.insertHighlight(e.text),y.a.createElement("span",{className:"date c-date"},a);case"snooze":var o=(e.showDay?e.date.toString("dddd")+" ":"")+e.date.toString("h:mm tt");return y.a.createElement(y.a.Fragment,null,y.a.createElement("span",{className:"snoozeDate"},e.text),y.a.createElement("span",{className:"snoozeDetail"},o));case"item":var i=e.item,s=h.default.parentTextForItem(i),r=t===this.state.expanded,l=h.default.classNames("autocompleteItem flexbox",{hasParent:!!s},{itemExpanded:r}),c=this.props.mode===f.a.AutocompleteMode.Move;return y.a.createElement("div",{className:l},y.a.createElement("div",{className:"autocompleteItemInside f1"},s&&y.a.createElement("div",{className:"parentPath c-foreground-very-faded"},s),y.a.createElement(M.a,{key:i.id,item:i}),c&&r&&y.a.createElement(H.a,{ref:"inputAdd",placeholder:"Add subitem",buttonText:"MOVE TO CHILD",focused:!0,onButtonClick:this.onSelectedAddChild,onClick:this.onClickExpandedInput})),c&&y.a.createElement(K.a,{icon:r?"icon-angle-down":"icon-angle-right",className:"autocompleteExpand",width:46,height:46,onClick:this.onClickExpand.bind(this,t),tooltip:"Add sub-item"}));case f.a.AutocompleteMode.GmailLabel:return a=this.insertHighlight(e.text),y.a.createElement("span",null,a);default:try{h.default.PAssert(1612,!1,"Invalid insert text",e.type)}catch(u){h.default.reportError(u)}}}},{key:"render",value:function(){for(var e=0,t=this.state,a=this.props,n=[],o=0;o<t.matches.length;o++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var i=t.matches[o],s=h.default.classNames("c-border-light autocomplete_"+i.type,{selected:o===t.selectedIndex});n.push(y.a.createElement(W.a,{key:o,ref:"item_"+o,icon:i.icon,iconColor:i.iconColor,className:s,onMouseOver:this.onMouseOver.bind(this,o),canClose:!1,noMouseUp:!0,onClick:this.onClick.bind(this,o)},this.renderObject(i,o)))}var r,l=a.text,c=a.buttonText;this.hasOwnInput()&&(r=!!a.allowEmpty||(a.allowCustom?void 0:t.selectedIndex>=0));var u,d,m=h.default.classNames("newAutocomplete flexbox",a.className,{contextMenuMobile:p.a.isMobile},{flexvert:this.hasOwnInput()},{hasOwnInput:this.hasOwnInput()},{expanded:-1!==t.expanded}),f=p.a.isMobile&&p.a.windowHeight()-t.kbsize,g=p.a.isMobile?{}:{minWidth:260,maxWidth:320};if(p.a.isMobile&&"full"===a.position)u=y.a.createElement("div",{className:"newAutocompleteTopBar flexbox c-border"},y.a.createElement(K.a,{className:"fancyModalClose",icon:"icon-close",iconSize:20,width:h.default.topBarHeight,height:h.default.topBarHeight,onClick:this.onCloseButton}),y.a.createElement(H.a,{ref:"input",display:"block",className:"f1",height:h.default.topBarHeight,placeholder:a.text,autocompleteMode:a.mode,padding:{left:16,right:16},border:!1})),d=this.renderSpecialAutocomplete();else if(!p.a.isMobile&&this.hasOwnInput()){var v=a.documentSelector&&t.selectedDocument.getRootItem()||a.item||a.items&&a.items[0];u=y.a.createElement("div",{className:"newAutocompleteTopBar c-border-heavy"},a.documentSelector&&y.a.createElement("div",{className:"flexbox",style:{padding:8}},y.a.createElement("div",{style:{paddingRight:16}},"Document:"),y.a.createElement(G.a,{className:"f1",defaultValue:t.selectedDocument.id,onChange:this.onChangeDocument},Y.a.documentsArray.get().map(function(e){return y.a.createElement("option",{key:e.id,value:e.id},e.text.get())}))),y.a.createElement(H.a,{ref:"input",display:"block",className:"f1",placeholder:l,autocompleteMode:a.mode,padding:{left:16,right:16},tokens:a.tokens,onTokenRemoved:a.onTokenRemoved,border:!1,buttonText:c,onEscape:this.onEscapeKey,buttonEnabled:r,onButtonClick:this.onButtonClick,autocompleteItem:v}))}var C=y.a.createElement(U.a,{className:"autocompleteMatches f1",style:g},n);return a.onlyMatches?C:y.a.createElement(z.a,{className:m,id:a.id,element:a.elementDisplay,maxWidth:"none",height:f,positionOffset:a.positionOffset,position:a.position,useElementPosition:!p.a.isMobile||"email"===a.mode,overflowHeight:"shrink",ref:"contextMenu"},u,d,!d&&C,!p.a.isMobile&&this.renderRightContent())}}]),t}(E.a);t.default=j},546:function(e,t,a){"use strict";a.r(t);var n=a(66),o=a.n(n),i=a(0),s=a(1),r=a(4),l=a(2),c=a.n(l),u=a(19),d=a(5),m=a(3),h=a(21),p=a(6),f=a(325),g=u.b.createClass({displayName:"ReactNoteEditor",componentDisplay:s.a.ComponentDisplay.Everywhere,init:function(){var e=this.props,t=e.item.hasNote()&&e.item.getNote(),a=t?t.getParsedText():void 0;this.createObservables({hasValue:!!a})},onUnmount:function(){clearTimeout(this._noteUpdateTimeout),this._noteUpdateTimeout=void 0,this._saveNote(),m.a.isMobile&&d.a.closeKeyboard()},getValue:function(){return this.refs.noteText.getValue()},_saveNote:function(){p.e.beginAction(),r.default.PaneUpdateBatcher.beginUpdateItems();var e=this.props.item,t=e.hasNote()&&e.getNote(),a=this.refs.noteText.getValue();!t&&a&&(t=e.createNote()),t&&(a!==t.getRawText()&&t.setText(a,s.a.ChangeType.Local),a||e.setNote(void 0,s.a.ChangeType.Local)),r.default.PaneUpdateBatcher.commitUpdateItems(),p.e.endAction()},onChange:function(){var e=this.refs.noteText.getValue().length>0;e!==this.hasValue.get()&&(this.hasValue.set(e),e&&this.props.onValueSet&&requestAnimationFrame(this.props.onValueSet)),clearTimeout(this._noteUpdateTimeout),this._noteUpdateTimeout=setTimeout(this._saveNote,8e3)},render:function(){var e=this.props,t=r.default.DisplaySettings.fontSize(),a=e.item.hasNote()&&e.item.getNote(),n=a?a.getParsedText():void 0,o=a?void 0:"Add note",i=this.state.hasValue?e.heightValue:e.heightEmpty,s=!e.item.canHaveNote();return c.a.createElement(f.a,{ref:"noteText",className:e.className,value:n,placeholder:o,focused:e.focused,onChange:this.onChange,onKeyDown:e.onKeyDown,selectionStart:e.selectionStart,selectionEnd:e.selectionEnd,fontSize:t,margin:0,height:i,tabIndex:e.tabIndex,richText:!!e.richText&&!!e.goFullscreen,goFullscreen:e.richText&&e.goFullscreen,onClickClose:e.onClickClose,isReadOnly:s})}}),v=a(59),y=u.b.createClass({displayName:"ReactNotePopup",componentDisplay:s.a.ComponentDisplay.Everywhere,init:function(){this.createObservables({isFullscreen:!1})},getState:function(){return{maxWidth:this.props.pane.getWidth()-20}},onMount:function(){m.a.isMobile||h.a.listen("windowResize",this.onResize)},onResize:function(){this.updateState(),setTimeout(function(){this.refs.menu.updateState()}.bind(this),300)},onUnmount:function(){var e=this.props.item;m.a.isMobile||h.a.unlisten("windowResize",this.onResize),d.a.selectIndex(this.props.index-1,e.getParsedText().length),m.a.isMobile&&i.default.keyboardToolbar.show(s.a.KeyboardToolbarMode.Item)},onKeyPress:function(e){m.a.getKeyCode(e)!==s.a.KeyCode.Enter||!e.shiftKey||e.altKey||e.ctrlKey||e.metaKey||(r.default.menus.closeContextMenu(),e.preventDefault(),e.stopPropagation())},onClickClose:function(){r.default.menus.closeContextMenu()},onGoFullscreen:function(e){console.log(e),this.isFullscreen.set(e)},render:function(){var e=this.props,t=this.state,a=this.state.maxWidth,n=m.a.isMobile&&e.bottom,i={overflow:t.isFullscreen?"visible":void 0};return c.a.createElement(v.a,o()({},this.props,{key:e.note.id+"_Note",id:"contextMenuNote",width:600,maxWidth:a,bottom:n,style:i,ref:"menu"}),c.a.createElement(g,{ref:"noteText",item:e.item,focused:!0,onKeyPress:this.onKeyPress,selectionStart:e.selectionStart,selectionEnd:e.selectionEnd,richText:!0,goFullscreen:this.onGoFullscreen,onClickClose:this.onClickClose}))}});t.default=y},547:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a(1),i=a(4),s=a(3),r=a(2),l=a.n(r),c=a(99),u=a(19),d={ReactAutocomplete:a(545),ReactContextMenuSelectGmailAccount:a(537),ReactContextMenuInsertLink:a(538),ReactContextMenuContactDetails:a(539),ReactContextMenuMobileOpenLink:a(540),ReactNotePopup:a(546),ReactContextMenuDropBucket:a(541),ReactContextMenuAuthorize:a(542),ReactContextMenuMobileFilter:a(543),ReactContextMenuDate:a(544)},m=u.b.createClass({displayName:"ReactContextMenusMobile",componentDisplay:o.a.ComponentDisplay.Everywhere,getState:function(){return{contextMenus:i.default.menus.contextMenuStack,noFade:i.default.menus.contextMenuNoFade,isDragging:i.default.DragDrop.isVisible}},close:function(e,t){i.default.menus.isContextMenuOpen(e.fn)&&i.default.menus.closeContextMenu(e.fn),t.preventDefault(),t.stopPropagation()},render:function(){for(var e=0,t=this.state,a=[],o=0;o<t.contextMenus.length;o++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var i=t.contextMenus[o];if(i.noBackdrop||a.push(l.a.createElement("div",{key:"backdrop_"+o,className:"contextMenusBackdrop",onTouchStart:this.close.bind(this,i)})),i.fn)a.push(i.fn(i));else if(i.componentName){i.key=i.key||i.componentName,i.id=i.id||i.key;var r=d[i.componentName].default;a.push(l.a.createElement(r,i))}}var u=n.default.classNames("contextMenusReact",{open:a.length>0},{takeClick:a.length>0&&!i.noBackdrop},{none:0===a.length},{hideBackground:t.noFade||s.a.isMobile&&t.isDragging});return l.a.createElement(c.CSSTransitionGroup,{className:u,transitionName:"contextMenuAnim",transitionEnterTimeout:150,transitionLeaveTimeout:200},a)}});t.default=m},548:function(e,t,a){"use strict";a.r(t);var n=a(66),o=a.n(n),i=a(7),s=a.n(i),r=a(8),l=a.n(r),c=a(16),u=a.n(c),d=a(9),m=a.n(d),h=a(17),p=a.n(h),f=a(0),g=a(1),v=a(4),y=a(49),C=a(2),k=a.n(C),E=a(19),x=a(533),M=a(13),b=a(87),N=a(81),w=function(e){function t(){return s()(this,t),u()(this,m()(t).apply(this,arguments))}return p()(t,e),l()(t,[{key:"init",value:function(){}},{key:"getState",value:function(){var e=this.props.importer;return{waitingText:e.waitingText,documents:e.documentsObs,showTryAgain:e.showTryAgain}}},{key:"close",value:function(){y.a.createDefaultState(),v.default.menus.closeModal(g.a.Modals.ImportMoodo)}},{key:"sortCmpDocs",value:function(e,t){return t.date.getTime()-e.date.getTime()}},{key:"onClickTryAgain",value:function(){this.props.tryAgain()}},{key:"onClickCancel",value:function(){this.close()}},{key:"onClickImport",value:function(e,t){var a=this,n=Object.keys(this.refs).filter(function(e){return e.startsWith("checkbox_")&&a.refs[e].getValue()}).map(function(e){return a.refs[e].props.itemID});return this.props.importer.importWithDocuments(n),this.close(),!0}},{key:"render",value:function(){var e=this.props.withDocuments,t=this.state,a=t.waitingText,n=t.documents,i=t.showTryAgain,s=!a&&f.default.objectValues(n);return s&&s.sort(this.sortCmpDocs),k.a.createElement(x.a,o()({},this.props,{id:"modalImport",title:"Import Data",width:400,height:e?600:300,modalID:g.a.Modals.ImportMoodo,ref:"modal"}),k.a.createElement("div",{key:"content"},k.a.createElement("div",{className:"flexbox flexvert",style:{height:"100%"}},k.a.createElement("div",{className:"setupTitle"},"Import from Moo.do"),k.a.createElement(N.a,{className:"importMoodoWrapper f1"},a&&k.a.createElement(k.a.Fragment,null,k.a.createElement("div",{className:"c-foreground-light",dangerouslySetInnerHTML:{__html:a}}),i&&k.a.createElement("div",{className:"center"},k.a.createElement(M.a,{marginTop:24,raised:!0,onClick:this.onClickTryAgain},"Try again"))),!a&&s.map(function(e){var t=e.id;return k.a.createElement(b.a,{key:t,itemID:t,ref:"checkbox_"+t,style:{marginBottom:24}},k.a.createElement("div",{className:"mooDocText bold"},e.text),k.a.createElement("div",{className:"mooDocDate c-foreground-faded"},e.date.toString(v.default.International.getFormat(g.a.DFormat.MonthDayYearLong))))})),e&&k.a.createElement("div",{style:{marginTop:32,textAlign:"right"}},k.a.createElement(M.a,{raised:!0,onClick:this.onClickCancel},"CANCEL"),k.a.createElement(M.a,{raised:!0,primary:!0,marginLeft:16,enabled:!a,onClick:this.onClickImport},"IMPORT")))))}}]),t}(E.a);t.default=w},549:function(e,t,a){"use strict";a.r(t);var n=a(7),o=a.n(n),i=a(8),s=a.n(i),r=a(16),l=a.n(r),c=a(9),u=a.n(c),d=a(17),m=a.n(d),h=a(0),p=a(4),f=a(2),g=a.n(f),v=a(19),y=a(1),C=a(13),k=a(533),E=function(e){function t(){return o()(this,t),l()(this,u()(t).apply(this,arguments))}return m()(t,e),s()(t,[{key:"onClickCancel",value:function(){this.props.onCancel(),p.default.menus.closeModal(y.a.Modals.ConfirmEncrypt)}},{key:"onClickDownload",value:function(){h.default.saveFile(this.props.password,"moodo encryption password.txt")}},{key:"onClickYes",value:function(){this.props.onYes(),p.default.menus.closeModal(y.a.Modals.ConfirmEncrypt)}},{key:"render",value:function(){return g.a.createElement(k.a,{id:"modalConfirmEncrypt",closeButton:!1,small:!0,backdropClose:!1,scrollable:!1,modalID:y.a.Modals.ConfirmEncrypt,ref:"modal"},g.a.createElement("div",{key:"content"},g.a.createElement("p",null,"It is very important that you remember this password."),g.a.createElement("p",{style:{color:"red",fontWeight:"bold"}},"It cannot be reset."),g.a.createElement("p",null,"Are you sure you want to set an encryption password?")),g.a.createElement("div",{key:"buttons"},g.a.createElement(C.a,{raised:!0,cancel:!0,onClick:this.onClickCancel},"Cancel"),g.a.createElement(C.a,{raised:!0,marginLeft:16,onClick:this.onClickDownload},"Download Password"),g.a.createElement(C.a,{raised:!0,primary:!0,marginLeft:16,onClick:this.onClickYes},"Yes")))}}]),t}(v.a);t.default=E},550:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a(1),i=a(4),s=a(2),r=a.n(s),l=a(99),c=a(19),u=a(66),d=a.n(u),m=a(41),h=a(13),p=a(67),f=a(533),g=c.b.createClass({displayName:"ReactModalPrompt",componentDisplay:o.a.ComponentDisplay.Everywhere,getHotkeys:function(){return[m.a.create(o.a.KeyCode.Enter,!0,o.a.Primary.Either,o.a.Shift.Either,this.onClickYes)]},onClickYes:function(){this.refs.modal.close(this.refs.input.getValue())},onClickNo:function(){this.refs.modal.close(!1)},render:function(){return r.a.createElement(f.a,d()({},this.props,{id:"modalPrompt",title:this.props.text,small:!0,scrollable:!1,modalID:o.a.Modals.Prompt,ref:"modal"}),r.a.createElement("div",{key:"content"},r.a.createElement(p.a,{focused:!0,ref:"input"})),r.a.createElement("div",{key:"buttons"},r.a.createElement(h.a,{primary:!0,width:100,onClick:this.onClickYes},"OK"),r.a.createElement(h.a,{width:100,onClick:this.onClickNo},"NO")))}}),v=a(133),y=c.b.createClass({displayName:"ReactModalEmailReply",componentDisplay:o.a.ComponentDisplay.Everywhere,onMount:function(){var e=this.props,t=this.refs.compose;setTimeout(function(){e.responseMode===o.a.EmailResponseMode.Forward?t.focusTo():t.focusBody()},250)},onUnmount:function(){i.default.EmailPreview.setMessageResponseMode(this.props.inReplyToMessage.id,o.a.EmailResponseMode.None)},onClickSend:function(){this.refs.compose.send(),this.refs.modal.close()},onComposeClose:function(){var e=this.refs.modal;e&&e.close()},onCloseButton:function(){this.refs.compose.discard()},_getModalTitle:function(e){var t;return e===o.a.EmailResponseMode.Reply?t="Reply":e===o.a.EmailResponseMode.ReplyAll?t="Reply All":e===o.a.EmailResponseMode.Forward?t="Forward":e===o.a.EmailResponseMode.Other&&(t="Compose"),t},render:function(){var e=this.props,t=e.responseMode,a=this._getModalTitle(t);return r.a.createElement(f.a,d()({},e,{id:"modalEmailReply",title:a,modalID:o.a.Modals.EmailReply,ref:"modal",confirmIcon:"icon-send",onConfirm:this.onClickSend,onCloseButton:this.onCloseButton}),r.a.createElement(v.a,{key:"content",threadAttach:e.threadAttach,message:e.message,ref:"compose",onClose:this.onComposeClose,responseMode:this.state.responseMode}))}}),C=c.b.createClass({displayName:"ReactModalAlert",componentDisplay:o.a.ComponentDisplay.Everywhere,getHotkeys:function(){return[m.a.create(o.a.KeyCode.Enter,!0,o.a.Primary.Either,o.a.Shift.Either,this.onClickButton)]},onClickButton:function(){this.refs.modal.close()},render:function(){var e=this.props.actionText||"OKAY";return r.a.createElement(f.a,{id:"modalAlert",closeButton:!1,small:!0,backdropClose:!1,scrollable:!1,modalID:o.a.Modals.Alert,ref:"modal"},r.a.createElement("div",{key:"content",dangerouslySetInnerHTML:{__html:this.props.text}}),r.a.createElement("div",{key:"buttons"},r.a.createElement(h.a,{primary:!0,onClick:this.onClickButton},e)))}}),k=c.b.createClass({displayName:"ReactModalConfirm",componentDisplay:o.a.ComponentDisplay.Everywhere,getHotkeys:function(){return[m.a.create(o.a.KeyCode.Escape,!0,o.a.Primary.Either,o.a.Shift.Either,this.onClickNo),m.a.create(o.a.KeyCode.N,!0,o.a.Primary.Either,o.a.Shift.Either,this.onClickNo),m.a.create(o.a.KeyCode.Enter,!0,o.a.Primary.Either,o.a.Shift.Either,this.onClickYes),m.a.create(o.a.KeyCode.Y,!0,o.a.Primary.Either,o.a.Shift.Either,this.onClickYes)]},onClickYes:function(){this.refs.modal.close(!0)},onClickNo:function(){this.refs.modal.close(!1)},render:function(){return r.a.createElement(f.a,d()({},this.props,{id:"modalConfirm",small:!0,backdropClose:!1,scrollable:!1,closeButton:!1,modalID:o.a.Modals.Confirm,ref:"modal"}),r.a.createElement("div",{key:"content"},this.props.text),r.a.createElement("div",{key:"buttons"},r.a.createElement(h.a,{primary:!0,width:100,onClick:this.onClickYes},"YES"),r.a.createElement(h.a,{width:100,onClick:this.onClickNo},"NO")))}}),E=a(7),x=a.n(E),M=a(8),b=a.n(M),N=a(16),w=a.n(N),D=a(9),S=a.n(D),T=a(17),I=a.n(T),A=a(27),P=function(e){function t(){return x()(this,t),w()(this,S()(t).apply(this,arguments))}return I()(t,e),b()(t,[{key:"render",value:function(){var e=n.default.classNames("fancyTable c-border-heavy",this.props.className);return r.a.createElement("div",{className:e,id:this.props.id},this.props.children)}}]),t}(c.a),R=a(534),O=a(81),F=a(60),L=a(121),B=function(e){function t(){return x()(this,t),w()(this,S()(t).apply(this,arguments))}return I()(t,e),b()(t,[{key:"init",value:function(){this.createObservables({page:0,error:!1,pendingChanges:[],defaultAcl:o.a.DocumentAccessRoles.Write})}},{key:"getState",value:function(){var e=i.default.settings.encryptionKeys,t=this.props.doc;return{acl:t.acl,isShared:t.isShared(),encryptionKeys:e,hasDocPassword:e.get()&&!!e.get()[t.id]}}},{key:"onClickShare",value:function(e,t){var a=this,n=this.refs.invite,o=n.getTokens().map(function(e){return e.email});if(this.error.set(""),o&&o.length>0)return this.props.doc.shareWithUser(o,this.state.defaultAcl).then(function(e){t(),e.error&&a.error.set(e.error)}),n.clearValue(),n.clearTokens(),!0}},{key:"onChangeSelectRole",value:function(e,t){var a=+t;this.props.doc.shareWithUser([e.email],a)}},{key:"onChangeDefaultRole",value:function(e){this.defaultAcl.set(+e.target.value)}},{key:"onClickRemovePermission",value:function(e,t,a){var n=this;return this.props.doc.shareWithUser([e.email],null).then(function(e){a(),e.error&&n.error.set(e.error)}),!0}},{key:"onClickCancel",value:function(){i.default.menus.closeModal(o.a.Modals.ShareDoc)}},{key:"onClickSkip",value:function(e,t){var a=this;if(i.default.settings.hasUserPassword()){var n=this.props.doc;return F.a.updateDocumentEncryption(n,i.default.crypto.getGlobalKeyInfo()).then(function(){a.page.set(1),t()}),!0}this.page.set(1)}},{key:"onClickEncrypt",value:function(e,t){var a=this.props.doc,n=this.refs.pass1.getValue(),o=this.refs.pass2.getValue(),s=a.id;if(n===o)return L.a.backupDocumentAll(a).then(function(){i.default.crypto.addKey({name:s,password:n,sentinelSalt:a.id}).then(function(e){F.a.updateDocumentEncryption(a,e).then(function(){t()})})}),!0;this.error.set("Passwords do not match")}},{key:"renderSelect",value:function(e,t){return r.a.createElement(R.a,{value:e,onChange:t,style:{height:28,marginTop:6,marginRight:8}},r.a.createElement("option",{value:o.a.DocumentAccessRoles.Admin},"Admin"),r.a.createElement("option",{value:o.a.DocumentAccessRoles.Write},"Write"))}},{key:"renderPageEncryption",value:function(){var e={marginTop:8,width:240};return r.a.createElement("div",null,r.a.createElement("div",{className:"font-big4 bold"},"Make this document extra secure?"),r.a.createElement("div",{className:"modal-subtitle font-small1 c-foreground-light",style:{marginTop:16}},"This document will be encrypted using this password for an extra level of security. You will need to give this password to anyone you share the document with. For your security, Moo.do cannot recover your password, so keep your password safe!"),r.a.createElement("div",{className:"flexbox flex-center"},r.a.createElement("div",{style:{marginTop:16}},r.a.createElement(p.a,{type:"password",placeholder:"Password",ref:"pass1",style:e}),r.a.createElement(p.a,{type:"password",placeholder:"Confirm Password",ref:"pass2",style:e}))),r.a.createElement("div",{className:"flexbox flex-center"},r.a.createElement("div",{style:{marginTop:20}},r.a.createElement(h.a,{raised:!0,onClick:this.onClickSkip},"SKIP"),r.a.createElement(h.a,{primary:!0,raised:!0,style:{marginLeft:24},onClick:this.onClickEncrypt},"ENCRYPT"))))}},{key:"renderPageShare",value:function(){var e=this,t=this.props.doc,a=this.state,n=Object.keys(a.acl).filter(function(e){return e!==A.a.getEncryptionUid()}).map(function(e){return{uid:e,name:a.acl[e].t,email:a.acl[e].e,role:a.acl[e].r}});return r.a.createElement(O.a,{style:{height:"100%"}},r.a.createElement(P,null,r.a.createElement("div",{className:"fancyTableHeader font-big4 bold",style:{marginBottom:8}},"Share ",t.text.get()),n.map(function(a){var n=a.name?"".concat(a.name," <").concat(a.email,">"):a.email;return r.a.createElement("div",{key:a.uid,className:"flexbox"},r.a.createElement("div",{className:"f1"},n),e.renderSelect(a.role,e.onChangeSelectRole.bind(e,a)),t.isAdmin()&&r.a.createElement(h.a,{icon:"icon-close",width:40,height:40,onClick:e.onClickRemovePermission.bind(e,a)}))})),t.isAdmin()&&r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"flexbox",style:{marginTop:24}},r.a.createElement(p.a,{id:"inputShareInvite",className:"f1",placeholder:"Enter an mail address",autocompleteMode:"email",ref:"invite",style:{marginRight:8}}),this.renderSelect(this.state.defaultAcl,this.onChangeDefaultRole)),r.a.createElement(h.a,{primary:!0,raised:!0,onClick:this.onClickShare,style:{marginTop:16}},"INVITE")),a.error&&r.a.createElement("div",{className:"error"},a.error),!t.isAdmin()&&r.a.createElement("div",{className:"modal-group"},r.a.createElement("div",{className:"shareNotOwned gd"},"Only the creator of this file can share it with others. Please contact the creator to share it with others."),r.a.createElement(h.a,{id:"shareOkay",raised:!0,onClick:this.onClickCancel},"OKAY")))}},{key:"render",value:function(){var e=this.props,t=this.state;e.doc;return r.a.createElement(f.a,{id:"shareDoc",modalID:o.a.Modals.ShareDoc,ref:"modal",title:"Share File",width:500,height:320},r.a.createElement("div",{key:"content"},t.hasDocPassword||t.isShared||1===t.page?this.renderPageShare():this.renderPageEncryption()))}}]),t}(c.a),V=a(3),K=a(26),H=function(e){function t(){return x()(this,t),w()(this,S()(t).apply(this,arguments))}return I()(t,e),b()(t,[{key:"init",value:function(){this.createObservables({isFocused:this.props.focused||!1})}},{key:"onMount",value:function(){var e=this,t=this.refs.input;this.props.value&&(t.value=this.props.value),this.props.focused&&requestAnimationFrame(function(){t&&(t.focus(),void 0!==e.props.selectionStart&&(t.selectionStart=e.props.selectionStart),void 0!==e.props.selectionEnd&&(t.selectionEnd=e.props.selectionEnd),t.scrollTop=0)})}},{key:"onUnmount",value:function(){this.isFocused.get()&&this.onBlur()}},{key:"focus",value:function(){this.refs.input.focus()}},{key:"blur",value:function(){this.refs.input.blur()}},{key:"getValue",value:function(){return this.refs.input.value}},{key:"setValue",value:function(e){this.refs.input.value=e}},{key:"getSelectionStart",value:function(){return this.refs.input.selectionStart}},{key:"getSelectionEnd",value:function(){return this.refs.input.selectionEnd}},{key:"onFocus",value:function(e){n.default.vmMain.activeInput.set(this),this.isFocused.set(!0),this.props.onEscape&&(this.__hotkeyEscape=m.a.pushStackEscape(this.handleEscapeKey)),this.props.onFocus&&this.props.onFocus(e)}},{key:"onBlur",value:function(e){n.default.vmMain.activeInput.set(null),this.isFocused.set(!1),this.__hotkeyEscape&&(m.a.popStack(this.__hotkeyEscape),this.__hotkeyEscape=void 0),this.props.onBlur&&this.props.onBlur(e)}},{key:"onKeyPress",value:function(e){this.props.onKeyPress&&this.props.onKeyPress(e)}},{key:"handleEscapeKey",value:function(){this.props.onEscape&&this.props.onEscape()}},{key:"render",value:function(){var e=this.props,t=n.default.classNames("fancyTextarea c-background c-foreground",e.className),a=!!e.spellCheck||null,o={fontSize:e.fontSize,height:e.height||150,margin:void 0!==e.margin?e.margin:"16px 0",overflow:e.height<=34&&"hidden"};return r.a.createElement("textarea",{className:t,style:o,ref:"input",readOnly:!!e.isReadOnly,spellCheck:a,onClick:e.onClick,onChange:e.onChange,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:e.onKeyDown,onKeyPress:e.onKeyPress,placeholder:e.placeholder,tabIndex:e.tabIndex})}}]),t}(c.a),U=function(e){function t(){return x()(this,t),w()(this,S()(t).apply(this,arguments))}return I()(t,e),b()(t,[{key:"onClickUV",value:function(e){n.default.openUrl("https://feedback.moo.do/",e),n.default.sendEvent("Menu","FeedbackUserVoice")}},{key:"onClickTwitter",value:function(e){n.default.openUrl("https://www.twitter.com/MooDoApp",e),n.default.sendEvent("Menu","FeedbackTwitter")}},{key:"onClickFacebook",value:function(e){n.default.openUrl("https://www.facebook.com/MooDoApp",e),n.default.sendEvent("Menu","FeedbackFacebook")}},{key:"onClickGooglePlus",value:function(e){n.default.openUrl("https://www.google.com/+MooDoApp",e),n.default.sendEvent("Menu","FeedbackGoogle")}},{key:"onClickCancel",value:function(e){i.default.menus.closeModal(o.a.Modals.ReportBug)}},{key:"onClickSend",value:function(e){var t=this.refs.description.getValue();if(t&&t.length>2){i.default.sendFeedback("Moo.do Feedback",t),i.default.menus.closeModal(o.a.Modals.ReportBug),i.default.toasts.pushMessage({text:"Thanks for taking the time to send us feedback!"}),n.default.sendEvent("Menu","SendFeedback"),V.a.isMobile&&K.a.reset()}}},{key:"render",value:function(){var e={paddingBottom:V.a.getKBSize()};return r.a.createElement(f.a,{id:"reportBug",modalID:o.a.Modals.ReportBug,ref:"modal",title:"Contact Support",width:450,height:500},r.a.createElement("div",{key:"content"},r.a.createElement("div",{className:"c-foreground-light"},"If you're requesting a feature, it's often easier to vote it up (or add it) on our UserVoice page."),r.a.createElement("div",{className:"center"},r.a.createElement(h.a,{className:"mc",primary:!0,onClick:this.onClickUV},"Open UserVoice")),r.a.createElement("br",null),r.a.createElement("div",{className:"c-foreground-light"},"Or talk to us on your favorite social network."),r.a.createElement("div",{className:"feedbackIcons marginCenter flexbox flex-center",style:{width:150}},r.a.createElement(h.a,{width:50,height:50,icon:"icon-twitter",tooltip:"@MooDoApp",onClick:this.onClickTwitter}),r.a.createElement(h.a,{width:50,height:50,marginLeft:16,icon:"icon-facebook",tooltip:"MooDoApp",onClick:this.onClickFacebook}),r.a.createElement(h.a,{width:50,height:50,marginLeft:16,icon:"icon-google-plus",tooltip:"+MooDoApp",onClick:this.onClickGooglePlus})),V.a.isMobile?r.a.createElement("div",{className:"mat-subheader c-foreground-light flexbox",style:{lineHeight:"36px",marginBottom:16}},r.a.createElement("span",{className:"f1"},"Or send us a message directly."),r.a.createElement(h.a,{raised:!0,primary:!0,marginLeft:16,onClick:this.onClickSend,style:{verticalAlign:"bottom"}},"SEND")):r.a.createElement("div",{className:"mat-subheader c-foreground-light"},"Or send us a message directly."),r.a.createElement(H,{focused:!0,id:"bugDescription",height:200,ref:"description",margin:0})),r.a.createElement("div",{key:"buttons",style:e},r.a.createElement(h.a,{raised:!0,onClick:this.onClickCancel},"CANCEL"),r.a.createElement(h.a,{raised:!0,primary:!0,marginLeft:16,onClick:this.onClickSend},"SEND")))}}]),t}(c.a),z=c.b.createClass({displayName:"ReactModalOptions",componentDisplay:o.a.ComponentDisplay.Everywhere,onClickOption:function(e){this.refs.modal.close(e)},render:function(){return r.a.createElement(f.a,d()({},this.props,{id:"modalOptions",title:"Please Choose",small:!0,backdropClose:!1,scrollable:!1,modalID:o.a.Modals.Options,ref:"modal"}),r.a.createElement("div",{key:"content"},this.props.text),r.a.createElement("div",{key:"buttons"},this.props.options.map(function(e,t){return r.a.createElement(h.a,{key:t,raised:!0,width:120,margin:"0 8px",onClick:this.onClickOption.bind(this,e)},e)}.bind(this)),r.a.createElement(h.a,{cancel:!0,raised:!0,width:100,margin:"0 8px",onClick:this.onClickOption},"Cancel")))}}),W=a(62),G=a(87),Y=a(18),j=c.b.createClass({displayName:"ReactModalMobileSettings",componentDisplay:o.a.ComponentDisplay.Mobile,init:function(){var e=0;W.a.refresh();for(var t={enableNotifications:!i.default.settings.disableNotifications.get()},a=W.a.pluginsAvailable,n=0;n<a.length;++n){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var o=a[n];t[o+"Enabled"]=W.a.isPluginEnabled(o)}this.createObservables(t)},getState:function(){return{hasPremiumFeatures:i.default.billingManager.hasPremiumFeaturesObservable,gmailSyncAccounts:W.a.GmailSyncAccounts}},onSaveButton:function(){var e=0,t=W.a.pluginsAvailable,a=this.state;a.enableNotifications!==!i.default.settings.disableNotifications.get()&&W.a.toggleNotifications();var n=[o.a.PluginID.Contacts,o.a.PluginID.Gmail].filter(function(e){var t=e+"Enabled";return a[t]&&a[t]!==W.a.isPluginEnabled(e)}).map(function(e){return{id:e}});if(n.length>0){W.a.enablePlugins(n,!1,function(e){})}for(var s=0;s<t.length;++s){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var r=t[s],l=r+"Enabled";a[l]||a[l]===W.a.isPluginEnabled(r)||W.a.togglePlugin(r)}this.refs.modal.close()},onClickSendFeedback:function(){i.default.menus.openModal(o.a.Modals.ReportBug),n.default.sendEvent("Menu","GiveFeedback")},onClickReconnect:function(){n.default.reload()},onClickLogout:function(){i.default.setup.logoutClicked()},renderPluginOptionCheckbox:function(e,t,a){return r.a.createElement(G.a,{checked:this[e+"_"+t],setObs:!0},a)},renderPluginCheckbox:function(e,t,a){var n=e+"Enabled";return r.a.createElement(G.a,{checked:this[n],setObs:!0,disabled:!0},a,t)},linkAccount:function(e,t,a){0},removeAccount:function(e){0},enableGmailSync:function(e,t){},onClickFullSync:function(e,t){return i.default.pluginManager.getPluginGmail().syncAllAccountsFull(t),!0},renderAccount:function(e){var t=i.default.pluginManager.getPlugin(o.a.PluginID.Gmail).isEnabled(),a=this.state.gmailSyncAccounts.indexOf(e)>=0,s=n.default.classNames("accountRow");return r.a.createElement("div",{key:"row"+e,className:s},r.a.createElement(G.a,{disabled:!t,checked:a&&!0,error:!1,onChange:this.enableGmailSync.bind(this,e)},r.a.createElement(h.a,{icon:"icon-close",iconSize:20,display:"inline",width:50,height:50,onClick:this.removeAccount.bind(this,e)}),r.a.createElement("span",null,e)))},renderAccounts:function(){return this.getAccountList().map(this.renderAccount)},getAccountList:function(){var e=[];e.pushOnlyUniques(this.state.linkedAccounts),e.pushOnlyUniques(this.state.gmailSyncAccounts);return e.filter(function(e){return""!==e})},render:function(){var e=this.props,t=this.state,a=i.default.billingManager,n=(a.isTrialState(),+o.a.jsVersion);return r.a.createElement(f.a,d()({},e,{id:"modalMobileSettings",title:"Settings",modalID:o.a.Modals.MobileSettings,ref:"modal",topButtonWidth:80,closeButton:"CANCEL",confirmText:"SAVE",onConfirm:this.onSaveButton}),r.a.createElement("div",{key:"content"},r.a.createElement("div",{className:"modalSection"},r.a.createElement("div",{className:"modalSectionTitle"},"OPTIONS"),r.a.createElement("div",{className:"modalSectionList"},r.a.createElement(G.a,{checked:this.enableNotifications,setObs:!0},"Notifications"))),r.a.createElement("div",{className:"modalSection"},r.a.createElement("div",{className:"modalSectionTitle"},"PLUGINS"),r.a.createElement("div",{className:"modalSectionList featureCheckboxes"},this.renderPluginCheckbox(o.a.PluginID.Contacts,"Google Contacts",r.a.createElement("img",{src:"/img/plugin-gcontacts.png"})),t[o.a.PluginID.Contacts+"Enabled"]&&r.a.createElement(h.a,{height:44,primary:!0},"Refresh Contacts"),this.renderPluginCheckbox(o.a.PluginID.Gmail,"Gmail",r.a.createElement("img",{src:"/img/plugin-gmail.png"})),r.a.createElement("div",{className:"c-foreground-faded",style:{fontSize:13,padding:"8px 0"}},"Modifying plugin settings on mobile is in development. For now please modify these settings in the desktop app."))),r.a.createElement("div",{className:"modalSection"},r.a.createElement("div",{className:"modalSectionTitle"},"ACTIONS"),r.a.createElement("div",{className:"modalSectionList"},t[o.a.PluginID.Gmail+"Enabled"]&&r.a.createElement(h.a,{height:44,primary:!0,onClick:this.onClickFullSync},"Force full email sync"),r.a.createElement(h.a,{height:44,primary:!0,onClick:this.onClickSendFeedback},"Contact Support"),r.a.createElement(h.a,{height:44,primary:!0,enabled:Y.a.isOnline(),onClick:this.onClickLogout},"Logout"))),r.a.createElement("div",{className:"modalSection"},r.a.createElement("div",{className:"modalSectionTitle"},"ACCOUNT STATUS"),r.a.createElement("div",{className:"modalSectionList modalSectionText g"},a.hasPremium()&&r.a.createElement("div",{className:"text"},"Premium since ",a.getPremiumStartDate().toString(i.default.International.getFormat(o.a.DFormat.LongStrDate))),r.a.createElement("div",{className:"text"},"Logged in as ",i.default.settings.activeUser.get()),r.a.createElement("div",{className:"text"},"Please open Moo.do on your computer to modify your account."))),r.a.createElement("div",{className:"modalSection"},r.a.createElement("div",{className:"modalSectionTitle"},"APP INFO"),r.a.createElement("div",{className:"modalSectionList modalSectionText g"},V.a.isDevURL&&r.a.createElement("div",{className:"text"},window.location.hostname),r.a.createElement("div",{className:"text"},"Version: ",n),r.a.createElement("div",{className:"text"},new Date(n).toString(i.default.International.getFormat(o.a.DFormat.ShortDayTime))))),void 0))}}),X=c.b.createClass({displayName:"ReactModalEmailCompose",componentDisplay:o.a.ComponentDisplay.Everywhere,onClickSend:function(){this.refs.compose.send(),this.refs.modal.close()},onComposeClose:function(){i.default.menus.closeContextMenu(),this.refs.modal&&this.refs.modal.close()},onCloseButton:function(){this.refs.compose.discard()},render:function(){var e=this.props;return r.a.createElement(f.a,d()({},e,{id:"modalEmailCompose",title:"New Message",modalID:o.a.Modals.EmailCompose,ref:"modal",confirmIcon:"icon-send",onConfirm:this.onClickSend,onCloseButton:this.onCloseButton}),r.a.createElement(v.a,{key:"content",threadAttach:e.threadAttach,message:e.message,ref:"compose",onClose:this.onComposeClose,showSubject:!0,focus:"to"}))}}),q=a(536),J=Object.assign||function(e){for(var t=0,a=1;a<arguments.length;a++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var n=arguments[a];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Z=c.b.createClass({displayName:"ReactModalsMobile",componentDisplay:o.a.ComponentDisplay.Everywhere,getState:function(){return{modals:i.default.menus.modalStack}},renderModal:function(e){var t=e.id,a=t===o.a.Modals.Alert&&C||t===o.a.Modals.Confirm&&k||t===o.a.Modals.Prompt&&g||t===o.a.Modals.Options&&z||t===o.a.Modals.EmailReply&&y||t===o.a.Modals.EmailCompose&&X||t===o.a.Modals.MobileSettings&&j||t===o.a.Modals.ReportBug&&U||t===o.a.Modals.EnterCode&&q.default||t===o.a.Modals.ShareDoc&&B;try{n.default.PAssert(1472,a,"Could not find modal with id "+t)}catch(i){n.default.reportError(i)}return r.a.createElement(a,J({key:e.id},e))},render:function(){for(var e=0,t=[],a=0;a<this.state.modals.length;a++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;t.push(this.renderModal(this.state.modals[a]))}var o=n.default.classNames("modals",{none:0===t.length});return r.a.createElement(l.CSSTransitionGroup,{className:o,transitionName:"modalTransition",transitionEnterTimeout:400,transitionLeaveTimeout:300},t)}});t.default=Z}}]);
