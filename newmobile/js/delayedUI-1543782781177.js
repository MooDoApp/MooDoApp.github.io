(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{314:function(e,t,n){"use strict";var o=n(0),a=n(3),r=n(4),i=n.n(r),s=n(13),l=n(5),c=n(2),u=n(57),d=n(10);function p(e){return(p="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var n=0,o=0;o<t.length;o++){if(n++>5e3&&__infLoop&&__infLoop(n))throw new RangeError;var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function f(e,t){return!t||"object"!==p(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),f(this,h(t).apply(this,arguments))}var n,r,p;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,s["a"]),n=t,(r=[{key:"close",value:function(e){c.a.isMobile&&l.a.closeKeyboard(),this.props.onClose&&this.props.onClose(),a.default.menus.closeModal(this.props.modalID,e)}},{key:"onCloseButton",value:function(e){this.props.onCloseButton?this.props.onCloseButton():this.close()}},{key:"onEscapeKey",value:function(){this.props.noCancel||this.close()}},{key:"render",value:function(){var e,t,n,a=this.props,r=this.getChildByKey("sidebar"),s=this.getChildByKey("content"),l=this.getChildByKey("buttons"),p=c.a.isMobile,m={maxHeight:!c.a.isMobile&&a.height?"85%":null},f=o.default.classNames("fancyModal c-bg-app popup c-shadow-popup",a.className,{"flexbox flexvert":c.a.isMobile},{small:a.small},{hasSidebar:!!r},{hasTitle:p&&!!a.title},{hasButtons:!!l}),h=o.default.classNames("fancyModalWrapper",{"small flexbox":a.small}),y=o.default.classNames("fancyModalContent c-border c-background f1",s.props.className),g=c.a.isMobile?o.default.topBarHeight:36,v=i.a.createElement(a.scrollable?u.a:"div",{className:y},s.props.children||s);if(c.a.isMobile)return a.confirmIcon?e=i.a.createElement(d.a,{className:"fancyModalMobileConfirm",icon:a.confirmIcon,iconSize:20,width:g,height:g,onClick:a.onConfirm}):a.confirmText&&(e=i.a.createElement(d.a,{className:"fancyModalMobileConfirm",width:a.topButtonWidth,fontSize:14,height:g,onClick:a.onConfirm},a.confirmText)),!1!==a.closeButton&&(t=o.default.isString(a.closeButton)?i.a.createElement(d.a,{className:"fancyModalClose",width:a.topButtonWidth,fontSize:14,height:g,onClick:this.onCloseButton},a.closeButton):i.a.createElement(d.a,{className:"fancyModalClose",icon:"icon-close",iconSize:20,width:g,height:g,onClick:this.onCloseButton})),i.a.createElement("span",{className:h},i.a.createElement("div",{className:f,style:m,id:a.id},i.a.createElement("div",{className:"flexbox"},t,i.a.createElement("div",{className:"fancyModalTitle f1"},a.title),e),v));if(a.small||(m.width=a.width,m.height=a.height,m.minWidth=a.minWidth),r){var b={width:a.sidebarWidth||180};n=i.a.createElement("div",{className:"fancyModalSidebar",style:b},r.props.children)}return i.a.createElement("span",{className:h},!a.noBackdrop&&i.a.createElement("div",{className:"fancyModalBackdrop",onClick:!1!==a.backdropClose?this.close.bind(this,!1):void 0}),i.a.createElement("div",{className:f,style:m,id:a.id},p&&!1!==a.closeButton&&i.a.createElement(d.a,{className:"fancyModalClose",icon:"icon-close",iconSize:20,width:g,height:g,onClick:this.onCloseButton,tooltip:"Close"}),p&&a.title&&i.a.createElement("div",{className:"fancyModalTitle"},a.title),i.a.createElement("div",{className:"fancyModalInside flexbox flex1"},n,i.a.createElement("div",{className:"fancyModalContentArea c-border-light c-background flexbox flexvert f1"},v,l&&i.a.createElement("div",{className:o.default.classNames("fancyModalButtons c-background")},l)))))}}])&&m(n.prototype,r),p&&m(n,p),t}();t.a=g},315:function(e,t,n){"use strict";var o=n(0),a=n(1),r=n(3),i=n(4),s=n.n(i),l=n(13).b.createClass({displayName:"ReactContact",componentDisplay:a.a.ComponentDisplay.Everywhere,onClickNumber:function(e,t){r.default.menus.closeContextMenu(),o.default.openUrl(e.link,t,!0)},onClickEmail:function(e,t){var n=o.default.vmMain.getDefaultEmailPlugin();if(n.isActive()){r.default.menus.closeContextMenu();var a={to:[{text:"",email:e.address}]};r.default.menus.openComposeEmail(n,void 0,void 0,a)}else o.default.openUrl(e.link,t,!0)},render:function(){var e=this,t=this.props.contact;return s.a.createElement("div",{className:"contactPreview"},s.a.createElement("div",{className:"contactName c-border"},t.text),t.phoneNumbers&&t.phoneNumbers.map(function(t){return s.a.createElement("div",{className:"contactRow contactPhone",key:t.number},s.a.createElement("i",{className:"contactButton icon-phone c-foreground-super-faded"}),s.a.createElement("span",{className:"contactNumber link",onClick:e.onClickNumber.bind(e,t)},t.number),s.a.createElement("span",{className:"phoneType c-foreground-faded"},t.type))}),t.emails&&t.emails.map(function(t){return s.a.createElement("div",{className:"contactRow contactEmail",key:t.address},s.a.createElement("i",{className:"icon-mail_outline contactButton c-foreground-super-faded"}),s.a.createElement("span",{className:"contactEmail link",onClick:e.onClickEmail.bind(e,t)},t.address))}))}});t.a=l},316:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n(3),r=n(4),i=n.n(r),s=n(13),l=n(10),c=n(44),u=n(314);function d(e){return(d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(){return(p=Object.assign||function(e){for(var t=0,n=1;n<arguments.length;n++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e}).apply(this,arguments)}function m(e,t){for(var n=0,o=0;o<t.length;o++){if(n++>5e3&&__infLoop&&__infLoop(n))throw new RangeError;var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function f(e,t){return!t||"object"!==d(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var g=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),f(this,h(t).apply(this,arguments))}var n,r,d;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,s["a"]),n=t,(r=[{key:"init",value:function(){this.createObservables({errorText:""})}},{key:"onMount",value:function(){this.refs.code.focus()}},{key:"onClickConfirm",value:function(){var e=this,t=this.refs.code.getValue();this.props.onSelect(t).then(function(){a.default.menus.closeModal(o.a.Modals.EnterCode)}).catch(function(t){e.errorText.set(t)})}},{key:"onClickCancel",value:function(){!1!==this.props.noCancel&&a.default.menus.closeModal(o.a.Modals.EnterCode)}},{key:"render",value:function(){var e=this.props,t=e.text,n=e.noCancel,a=e.isPassword;return i.a.createElement(u.a,p({},this.props,{id:"modalEnterCode",closeButton:!1,width:360,scrollable:!1,modalID:o.a.Modals.EnterCode,backdropClose:!1,ref:"modal"}),i.a.createElement("div",{key:"content"},i.a.createElement("div",{className:"mb16 c-foreground"},t),i.a.createElement(c.a,{ref:"code",type:a&&"password",onEnter:this.onClickConfirm}),i.a.createElement("div",{className:"red"},this.state.errorText),i.a.createElement("div",{style:{marginTop:24,textAlign:"right"}},!n&&i.a.createElement(l.a,{width:100,onClick:this.onClickCancel},"CANCEL"),i.a.createElement(l.a,{primary:!0,width:100,onClick:this.onClickConfirm},"CONFIRM"))))}}])&&m(n.prototype,r),d&&m(n,d),t}();t.default=g},317:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n(3),r=n(4),i=n.n(r),s=n(13),l=n(43),c=n(32),u=n(82);function d(){return(d=Object.assign||function(e){for(var t=0,n=1;n<arguments.length;n++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e}).apply(this,arguments)}var p=s.b.createClass({displayName:"ReactContextMenuSelectGmailAccount",componentDisplay:o.a.ComponentDisplay.Everywhere,addPane:function(e){this.props.onSelected(e)},render:function(){var e=this,t=this.props,n=a.default.pluginManager.getPluginGmail(),o=n.getSyncAccounts();return i.a.createElement(l.a,d({},t,{key:"contextMenuTitle",id:"contextMenuTitle",maxHeight:400}),t.showHeader&&i.a.createElement(u.a,{topHeader:!0},"Open Gmail Account"),o.map(function(t){var o=n.getDefaultDisplayItem(t);return i.a.createElement(c.a,{key:t,onClick:e.addPane.bind(e,o)},t)}))}});t.default=p},318:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n(3),r=n(4),i=n.n(r),s=n(13),l=n(27),c=n(44),u=n(43),d=n(10);function p(){return(p=Object.assign||function(e){for(var t=0,n=1;n<arguments.length;n++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e}).apply(this,arguments)}var m=s.b.createClass({displayName:"ReactContextMenuInsertLink",componentDisplay:o.a.ComponentDisplay.Everywhere,init:function(){var e=this.props.text,t=o.a.Regexp.MDLink,n=new RegExp(/\S{2,}\.[^0-9.\s]{2,}\S*$/);t.lastIndex=0;var a=t.exec(e);a?(this.text=a[2],this.link=a[3]):null===n.exec(e)?this.text=e:this.link=e},getHotkeys:function(){return[l.a.create(o.a.KeyCode.Enter,!0,o.a.Primary.Either,o.a.Shift.Either,this.onClick),l.a.create(o.a.KeyCode.Escape,!0,o.a.Primary.Either,o.a.Shift.Either,this.close)]},onMount:function(){var e;(e=this.link||!this.text?this.refs.text:this.refs.link).focus(),e.selectAll()},close:function(){a.default.menus.closeContextMenu("ReactContextMenuInsertLink")},onClickRemove:function(){var e=this.refs.text.getValue();this.props.onInsertLink({text:e,url:""})},onClick:function(){var e=this.refs.text.getValue(),t=this.refs.link.getValue();(e||t)&&a.default.menus.isContextMenuOpen("ReactContextMenuInsertLink")&&(this.close(),t&&!t.startsWith("http")&&(t="http://"+t),this.props.onInsertLink({text:e,url:t}))},render:function(){return i.a.createElement(u.a,p({},this.props,{key:"contextMenuInsertLink",id:"contextMenuInsertLink"}),i.a.createElement("div",{className:"flexbox"},i.a.createElement("span",null,"Text"),i.a.createElement(c.a,{className:"f1",ref:"text",height:28,width:260,value:this.text||this.link,onEnter:this.onClick,onEscape:this.close})),i.a.createElement("div",{className:"flexbox"},i.a.createElement("span",null,"Link"),i.a.createElement(c.a,{className:"f1",ref:"link",height:28,width:260,value:this.link,onEnter:this.onClick,onEscape:this.close})),i.a.createElement("div",{className:"flexbox",style:{marginTop:16}},this.link&&i.a.createElement(d.a,{cancel:!0,height:32,onClick:this.onClickRemove},"REMOVE"),i.a.createElement("div",{className:"f1"}),i.a.createElement(d.a,{primary:!0,height:32,onClick:this.onClick},"INSERT")))}});t.default=m},319:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n(3),r=n(4),i=n.n(r),s=n(13),l=n(315),c=n(43),u=s.b.createClass({displayName:"ReactContextMenuContactDetails",componentDisplay:o.a.ComponentDisplay.Everywhere,onClose:function(){a.default.menus.closeContextMenu("ReactContextMenuContactDetails")},render:function(){return i.a.createElement(c.a,{key:"contextMenuContactDetails",id:"contextMenuContactDetails",element:this.props.element,position:this.props.position},i.a.createElement(l.a,{contact:this.props.contact,onClose:this.onClose}))}});t.default=u},320:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n(3),r=n(4),i=n.n(r),s=n(13),l=n(10),c=n(43);function u(){return(u=Object.assign||function(e){for(var t=0,n=1;n<arguments.length;n++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e}).apply(this,arguments)}var d=s.b.createClass({displayName:"ReactContextMenuMobileOpenLink",componentDisplay:o.a.ComponentDisplay.Mobile,onClickOpen:function(){this.props.onClick(),a.default.menus.closeContextMenu()},render:function(){var e=this.props;return i.a.createElement(c.a,u({},e,{key:"contextMenuMobileOpenLink",id:"contextMenuMobileOpenLink",className:"flexbox"}),i.a.createElement("div",{className:"f1"},e.html),i.a.createElement(l.a,{primary:!0,onClick:this.onClickOpen},"OPEN"))}});t.default=d},321:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n(1),r=n(3),i=n(2),s=n(6),l=n(4),c=n.n(l),u=n(13),d=n(31),p=n(49),m=n(14),f=n(5),h=n(65),y=n(10),g=n(43),v=n(32);function b(){return(b=Object.assign||function(e){for(var t=0,n=1;n<arguments.length;n++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e}).apply(this,arguments)}var E=u.b.createClass({displayName:"ReactContextMenuDropBucket",componentDisplay:a.a.ComponentDisplay.Everywhere,init:function(){this.createObservables({draggingItem:void 0})},onMount:function(){m.a.listen("droppedItem",this.onItemDropped)},onUnmount:function(){m.a.unlisten("droppedItem",this.onItemDropped)},getState:function(){return{items:o.default.vmMain.dropBucket.getItems(),isDragging:r.default.DragDrop.isVisible}},createEvent:function(e,t){var n=o.default.findChild(t.target,"item")||o.default.findParent(t.target,"item",5);return{fromDropBucket:!0,startSrc:n,target:n,clientX:t.clientX,clientY:t.clientY,eventX:t.eventX||t.clientX,eventY:t.eventY||t.clientY,pageX:t.pageX,pageY:t.pageY,preventDefault:o.default.emptyFn,stopPropagation:o.default.emptyFn,stopImmediatePropagation:o.default.emptyFn,pane:e.pane}},onMouseDown:function(e,t){if(e.item&&i.a.isMobile){var n=this.createEvent(e,t);r.default.DragDrop.startDragItem=e.item,e.item.dragStart(n),e.item.dragMove(n)}},onClickItem:function(e,t){if(!o.default.hasClass(t.target,"fancyButton")&&!i.a.isMobile){var n={mode:a.a.AutocompleteMode.Move,text:"Select item to move to",buttonText:"MOVE",elementDisplay:t.target,onSelected:function(t){s.e.beginAction();var n=e.item.clone(t.item,a.a.ChangeType.Local);t.item.insertItem(n,0),e.item.parent().removeChild(e.item,a.a.ChangeType.Local),o.default.vmMain.dropBucket.removeTextEntry(e.id),0===this.state.items.length&&r.default.menus.closeContextMenu(),s.e.endAction()}.bind(this)};d.a.showPopup(n)}},onMouseMove:function(e,t){if(e.item&&i.a.isMobile){var n=this.createEvent(e,t);f.a.onMouseMoveDocument(n),e.item.onMove(n),this.draggingItem.set(e.item)}},onMouseUp:function(e,t){if(e.item&&i.a.isMobile){var n=this.createEvent(e,t);e.item.onEnd(n),this.draggingItem.set(void 0),0===this.state.items.length&&r.default.menus.closeContextMenu()}},onCloseButton:function(e,t){e.item&&o.default.vmMain.dropBucket.hasItemEntry(e.item)&&o.default.vmMain.dropBucket.removeItemEntry(e.item),o.default.vmMain.dropBucket.hasTextEntry(e.id)&&o.default.vmMain.dropBucket.consumeTextEntry(e.id),t.stopPropagation()},onItemDropped:function(e){o.default.vmMain.dropBucket.hasItemEntry(e)&&o.default.vmMain.dropBucket.removeItemEntry(e),o.default.vmMain.dropBucket.hasTextEntry(e.id)&&o.default.vmMain.dropBucket.removeTextEntry(e.id)},_renderBucketItem:function(e,t){return e.item?c.a.createElement(h.a,{item:e.item,allowDrag:!0}):c.a.createElement(p.a,null,e.text)},render:function(){for(var e=0,t=this.props,n=this.state,a=[],r=0;r<n.items.length;r++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var s=n.items[r],l=s.item,u=s.id,d={width:"100%",overflow:"hidden"},m=o.default.classNames({dragging:n.draggingItem===l});i.a.isMobile||(d.maxWidth="335px"),a.push(c.a.createElement(v.a,{key:u,className:m,onClick:this.onClickItem.bind(this,s),clickCloses:!1,hasButtons:!0,hoverEffects:!0},c.a.createElement(p.a,{style:d,onMouseDown:this.onMouseDown.bind(this,s),onMouseMove:this.onMouseMove.bind(this,s),onMouseUp:this.onMouseUp.bind(this,s)},this._renderBucketItem(s,r)),c.a.createElement(y.a,{icon:"icon-close",width:"48px",iconSize:20,onClick:this.onCloseButton.bind(this,s)})))}return c.a.createElement(g.a,b({},t,{key:"contextMenuDropBucket",id:"contextMenuDropBucket",supportArrows:!0}),a)}});t.default=E},322:function(e,t,n){"use strict";n.r(t);var o=n(1),a=n(3),r=n(4),i=n.n(r),s=n(13),l=n(41),c=n(43),u=n(10);function d(){return(d=Object.assign||function(e){for(var t=0,n=1;n<arguments.length;n++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e}).apply(this,arguments)}var p=s.b.createClass({displayName:"ReactContextMenuAuthorize",componentDisplay:o.a.ComponentDisplay.Everywhere,onClickEnable:function(){l.a.refresh(),l.a.enableOfflineFeatures(!1,this.onEnable)},onEnable:function(e){e&&a.default.menus.closeContextMenu()},render:function(){return i.a.createElement(c.a,d({},this.props,{key:"contextMenuAuthorize",id:"contextMenuAuthorize"}),i.a.createElement("div",null,this.props.message),i.a.createElement("div",{className:"center"},i.a.createElement(u.a,{primary:!0,raised:!0,onClick:this.onClickEnable},"AUTHORIZE")))}});t.default=p},323:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n(1),r=n(4),i=n.n(r),s=n(13),l=n(49),c=n(10),u=n(43);function d(){return(d=Object.assign||function(e){for(var t=0,n=1;n<arguments.length;n++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e}).apply(this,arguments)}var p=s.b.createClass({displayName:"ReactContextMenuMobileFilter",componentDisplay:a.a.ComponentDisplay.Mobile,init:function(){this.listenTo(this.props.pane.search.onChanged)},getState:function(){for(var e=0,t=this.props.pane.search,n={hasFilter:!1},o=0;o<t.filters.length;o++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var a=t.filters[o];n[a.name]=a.value,0!==a.value&&(n.hasFilter=!0)}return n},onClickClear:function(){for(var e=0,t=this.props.pane.search,n=0;n<t.filters.length;n++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var o=t.filters[n];0!==this.state[o.name]&&t.setFilter(o.name,0)}},onClickFilter:function(e,t){var n=this.props.pane.search;n.getFilterValue(e.name)===t&&(t=0),n.setFilter(e.name,t)},renderSearchButton:function(e,t){var n=o.default.classNames("searchFilterButton c-border",e.icon,{yes:t>0},{no:t<0},{selected:t===this.state[e.name]});return i.a.createElement(l.a,{className:n,onClick:this.onClickFilter.bind(this,e,t)})},renderSearchFilter:function(e){for(var t=0,n=(e.text||e.name).capitalize(),o=n.length-1;o>=1;o--){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;n[o]===n[o].toUpperCase()&&(n=n.substr(0,o)+" "+n.substr(o))}return i.a.createElement("div",{key:e.name,className:"searchFilter flexbox"},i.a.createElement("div",{className:"menuItemText f1"},n),this.renderSearchButton(e,1),!1!==e.canBeNegated?this.renderSearchButton(e,-1):i.a.createElement("div",{className:"searchFilterButton"}))},renderSearchPriorityButton:function(e,t){var n=o.default.classNames("searchPriorityButton c-border",{p0:t===a.a.VMLIFlag.P0},{p1:t===a.a.VMLIFlag.P1},{p2:t===a.a.VMLIFlag.P2},{selected:t===this.state[e.name]});return i.a.createElement(l.a,{className:n,onClick:this.onClickFilter.bind(this,e,t)})},renderSearchPriority:function(e){return i.a.createElement("div",{key:e.name,className:"searchPriority flexbox"},this.renderSearchPriorityButton(e,a.a.VMLIFlag.P0),this.renderSearchPriorityButton(e,a.a.VMLIFlag.P1),this.renderSearchPriorityButton(e,a.a.VMLIFlag.P2))},render:function(){for(var e,t=0,n=this.props,o=n.pane.search,a=[],r=!0,s=0;s<o.filters.length;s++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var l=o.filters[s];l.enabled.get()&&(l.isOption&&r&&(a.push(i.a.createElement("hr",{key:"hrOption"})),r=!1),l.icon?a.push(this.renderSearchFilter(l)):"priority"===l.name&&(e=this.renderSearchPriority(l)))}return i.a.createElement(u.a,d({},n,{key:"contextMenuMobileFilter",id:"contextMenuMobileFilter"}),i.a.createElement(c.a,{icon:"icon-close",display:"block",enabled:this.state.hasFilter,onClick:this.onClickClear},"Clear filters"),i.a.createElement("div",{className:"searchFilter filterTitle flexbox c-foreground-very-faded c-border"},i.a.createElement("div",{className:"menuItemText f1"},"Filter"),i.a.createElement("div",null,"Show"),i.a.createElement("div",null,"Hide")),a,e&&i.a.createElement("div",{className:"searchFilter filterTitle c-foreground-very-faded c-border"},"Minimum Priority"),e)}});t.default=p},324:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n(1),r=n(3),i=n(4),s=n.n(i),l=n(13),c=n(5),u=n(2),d=n(14),p=n(6),m=n(225),f=l.b.createClass({displayName:"ReactNoteEditor",componentDisplay:a.a.ComponentDisplay.Everywhere,init:function(){var e=this.props,t=e.item.hasNote()&&e.item.getNote(),n=t?t.getParsedText():void 0;this.createObservables({hasValue:!!n})},onUnmount:function(){clearTimeout(this._noteUpdateTimeout),this._noteUpdateTimeout=void 0,this._saveNote(),u.a.isMobile&&c.a.closeKeyboard()},getValue:function(){return this.refs.noteText.getValue()},_saveNote:function(){p.e.beginAction(),r.default.PaneUpdateBatcher.beginUpdateItems();var e=this.props.item,t=e.hasNote()&&e.getNote(),n=this.refs.noteText.getValue();!t&&n&&(t=e.createNote()),t&&(n!==t.getRawText()&&t.setText(n,a.a.ChangeType.Local),n||e.setNote(void 0,a.a.ChangeType.Local)),r.default.PaneUpdateBatcher.commitUpdateItems(),p.e.endAction()},onChange:function(){var e=this.refs.noteText.getValue().length>0;e!==this.hasValue.get()&&(this.hasValue.set(e),e&&this.props.onValueSet&&requestAnimationFrame(this.props.onValueSet)),clearTimeout(this._noteUpdateTimeout),this._noteUpdateTimeout=setTimeout(this._saveNote,8e3)},render:function(){var e=this.props,t=r.default.DisplaySettings.fontSize(),n=e.item.hasNote()&&e.item.getNote(),o=n?n.getParsedText():void 0,a=n?void 0:"Add note",i=this.state.hasValue?e.heightValue:e.heightEmpty,l=!e.item.canHaveNote();return s.a.createElement(m.a,{ref:"noteText",className:e.className,value:o,placeholder:a,focused:e.focused,onChange:this.onChange,onKeyDown:e.onKeyDown,onKeyPress:e.onKeyPress,selectionStart:e.selectionStart,selectionEnd:e.selectionEnd,fontSize:t,margin:0,height:i,tabIndex:e.tabIndex,richText:!!e.richText&&!!e.goFullscreen,goFullscreen:e.richText&&e.goFullscreen,onClickClose:e.onClickClose,isReadOnly:l})}}),h=n(43);function y(){return(y=Object.assign||function(e){for(var t=0,n=1;n<arguments.length;n++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e}).apply(this,arguments)}var g=l.b.createClass({displayName:"ReactNotePopup",componentDisplay:a.a.ComponentDisplay.Everywhere,init:function(){this.createObservables({isFullscreen:!1})},getState:function(){return{maxWidth:this.props.pane.getWidth()-20}},onMount:function(){u.a.isMobile||d.a.listen("windowResize",this.onResize)},onResize:function(){this.updateState(),setTimeout(function(){this.refs.menu.updateState()}.bind(this),300)},onUnmount:function(){var e=this.props.item;u.a.isMobile||d.a.unlisten("windowResize",this.onResize),c.a.selectIndex(this.props.index-1,e.getParsedText().length),u.a.isMobile&&o.default.keyboardToolbar.show(a.a.KeyboardToolbarMode.Item)},onKeyPress:function(e){u.a.getKeyCode(e)!==a.a.KeyCode.Enter||!e.shiftKey||e.altKey||e.ctrlKey||e.metaKey||(r.default.menus.closeContextMenu(),e.preventDefault(),e.stopPropagation())},onClickClose:function(){r.default.menus.closeContextMenu()},onGoFullscreen:function(e){console.log(e),this.isFullscreen.set(e)},render:function(){var e=this.props,t=this.state,n=this.state.maxWidth,o=u.a.isMobile&&e.bottom,a={overflow:t.isFullscreen?"visible":void 0};return s.a.createElement(h.a,y({},this.props,{key:e.note.id+"_Note",id:"contextMenuNote",width:600,maxWidth:n,bottom:o,style:a,ref:"menu"}),s.a.createElement(f,{ref:"noteText",item:e.item,focused:!0,onKeyPress:this.onKeyPress,selectionStart:e.selectionStart,selectionEnd:e.selectionEnd,richText:!0,goFullscreen:this.onGoFullscreen,onClickClose:this.onClickClose}))}});t.default=g},325:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n(2),r=n(1),i=n(3),s=n(4),l=n.n(s),c=n(53),u=n.n(c),d=n(13),p=n(31),m=n(65),f=n(315),h=0,y=1,g=2,v=4,b=8,E=["now","soon","later","someday"],C=["today","tomorrow"],k=["next"],w=["mon","tue","wed","thu","fri","sat","sun"],x=["january","february","march","april","may","june","july","august","september","october","november","december"],M=["every"],S=["first","other","last"],N=[0,1,2,3,4,5,6],_=(E.concat(M).concat(C).concat(S).concat(k).concat(w).concat(x),d.b.createClass({displayName:"ReactAutocompleteDates",componentDisplay:r.a.ComponentDisplay.Everywhere,init:function(){this.text="",this.createObservables({nextDateWord:h})},isInMode:function(e){return 0===e?0===this.state.nextDateWord:o.default.isFlagSet(this.state.nextDateWord,e)},getShortMonth:function(e){return Date.CultureInfo.abbreviatedMonthNames[e]},getLongMonth:function(e){return Date.CultureInfo.monthNames[e]},getShortDay:function(e){return Date.CultureInfo.abbreviatedDayNames[e]},getLongDay:function(e){return Date.CultureInfo.dayNames[e]},getMonthList:function(){var e=0,t=(new Date).getMonth()-1;t<0&&(t=12+t);for(var n=t+1+5,o=[],a=t;a<n;++a){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var r=a%12;o.push(r)}return o},nextWordOptions:function(e){var t=e.toLowerCase().split(" "),n=t[t.length-1];if(""===n&&(n=t[t.length-2]),E.indexOf(n)>=0)return h;if(M.indexOf(n)>=0)return y|b;if(S.indexOf(n)>=0)return y;if(C.indexOf(n)>=0)return v;if(k.indexOf(n)>=0)return y;if(w.indexOf(n)>=0)return v;if(x.indexOf(n)>=0)return g;var o=parseInt(n,10);return isNaN(o)?n.indexOf(":")>=0?v:h:v},onMouseDown:function(e){o.default.preventAndStop(e)},onTapDate:function(e){var t=e.target;if("SPAN"===t.nodeName){var n=t.getAttribute("data-text")||t.textContent.trim(),a=this.nextWordOptions(n),r=a===h;this.nextDateWord.set(a),this.text+=n,o.default.findParentID(t,"autocompleteHours",2)||o.default.findParentID(t,"autocompleteMinutes",2)||(this.text+=" "),this.props.setText(this.text),r&&this.props.onSelected()}},render:function(){var e=this,t=(this.state.nextDateWord,""===this.text);return l.a.createElement("div",{id:"autocompleteDates",className:"f1",onMouseDown:this.onMouseDown,onClick:this.onTapDate},(this.isInMode(h)||this.isInMode(y))&&l.a.createElement("div",{id:"autocompleteDate"},!this.isInMode(b)&&l.a.createElement("div",{className:o.default.classNames({disabled:!t})},l.a.createElement("span",null,"today"),l.a.createElement("span",null,"tomorrow"),l.a.createElement("span",null,"next"),l.a.createElement("span",null,"every")),this.isInMode(b)&&l.a.createElement("div",null,l.a.createElement("span",null,"first"),l.a.createElement("span",null,"other"),l.a.createElement("span",null,"last")),l.a.createElement("div",{id:"datePickerDays"},N.map(function(t){var n=e.getLongDay(t);return l.a.createElement("span",{key:n},e.getShortDay(t))})),l.a.createElement("div",{className:o.default.classNames({disabled:!t})},e.getMonthList().map(function(t){var n=e.getLongMonth(t);return l.a.createElement("span",{key:n,"data-text":n},e.getShortMonth(t))}))),this.isInMode(g)&&l.a.createElement("div",{id:"autocompleteDay"},l.a.createElement("div",{className:"flexcolumn"},l.a.createElement("div",{className:"autocompleteDays"},Array.apply(0,Array(31)).map(function(e,t){return l.a.createElement("span",{key:t},t+1)})))),this.isInMode(v)&&l.a.createElement("div",{id:"autocompleteTime"},l.a.createElement("div",{className:"flexcolumn"},l.a.createElement("div",{id:"autocompleteHours"},Array.apply(0,Array(12)).map(function(e,t){return l.a.createElement("span",{key:t},t+1)}))),l.a.createElement("div",{className:"flexcolumn"},l.a.createElement("div",{id:"autocompleteMinutes"},l.a.createElement("span",null,":15"),l.a.createElement("span",null,":30"),l.a.createElement("span",null,":45"))),l.a.createElement("div",{className:"flexcolumn"},l.a.createElement("div",{id:"autocompleteAMPM"},l.a.createElement("span",null,"am"),l.a.createElement("span",null,"pm")))))}})),O=n(10),D=n(44),T=n(57),P=n(43),I=n(32),R=d.b.createClass({displayName:"ReactAutocomplete",componentDisplay:r.a.ComponentDisplay.Everywhere,init:function(){var e=this.props;this.createObservables({selectedIndex:e.elementInput||e.fromPane||e.onlyMatches?0:-1,expanded:!1})},onMount:function(){if(this.hasOwnInput()){var e=this.props,t=this.refs.input;t&&(t.focus(),t.updateAutocomplete(e.item||e.items&&e.items[0]))}document.addEventListener("keydown",this.onInputKeyDown,!0)},componentWillReceiveProps:function(e){this.props.matches!==e.matches&&this.updateState(e)},onUnmount:function(){document.removeEventListener("keydown",this.onInputKeyDown,!0)},onBeforeChanged:function(e,t){var n=this.refs;if(e.matches!==t.matches&&!e.hasSpecialMatches){this.expanded.set(!1,!1),e.expanded=!1;var o=!n.input||!this.props.allowCustom&&n.input.getValue()&&this.state.matches.length>0?0:-1;this.selectedIndex.set(o,!1),e.selectedIndex=o}},onAfterChanged:function(e,t){e.matches.length>t.matches.length&&setTimeout(function(){this.refs.contextMenu&&this.refs.contextMenu.updateState()}.bind(this),0)},getState:function(e){var t=this.getSpecialMatches();return{matches:e.matches||t||p.a.matches,hasSpecialMatches:!!t,kbsize:a.a.kbsize,owner:p.a.owner}},updateTextFromIndex:function(){if(this.hasOwnInput()){var e=this.refs.input,t=this.selectedIndex.get(),n="";if(t>=0){var o=this.state.matches[t];n=this.getInsertText(o)}e.setValue(n),e.selectEnd()}},onInputKeyDown:function(e){var t=this.state,n=this.props;if(n.allowCustom&&e.keyCode===r.a.KeyCode.Enter)this.onSelected(),o.default.preventDefault(e),o.default.stopPropagation(e);else if(t.matches.length>0){var a=this.selectedIndex.get();if(t.matches.length>1&&(e.keyCode===r.a.KeyCode.DownArrow||e.keyCode===r.a.KeyCode.UpArrow)){if(e.keyCode===r.a.KeyCode.UpArrow?--a<(n.allowCustom?-1:0)&&(a=t.matches.length-1):e.keyCode===r.a.KeyCode.DownArrow&&++a>t.matches.length-1&&(a=n.allowCustom?-1:0),a!==this.selectedIndex.get()&&(this.selectedIndex.set(a),this.updateTextFromIndex(),a>=0)){var i=this.refs["item_"+this.selectedIndex.get()];try{o.default.PAssert(1820,i,"Item must exist in autocomplete to be scrolled to")}catch(l){self.reportError(l)}if(i){var s=u.a.findDOMNode(i);o.default.scrollIntoView(s,r.a.ScrollDuration.Default)}}o.default.preventDefault(e)}else e.keyCode===r.a.KeyCode.RightArrow?this.expanded.set(a):e.keyCode===r.a.KeyCode.Enter&&a>=0&&(this.onSelected(),o.default.preventDefault(e),o.default.stopPropagation(e))}},onEscapeKey:function(){this.hide(!0)},hide:function(e){p.a.hide()},onMouseOver:function(e){this.selectedIndex.set(e)},onClick:function(e){this.selectedIndex.set(e),this.updateTextFromIndex(),this.onSelected()},onButtonClick:function(){this.onSelected()},hasOwnInput:function(){return a.a.isMobile||!this.props.elementInput&&!this.props.fromPane&&!this.props.onlyMatches},onSelected:function(){var e,t,n=this.props,o=this.state,a={owner:o.owner,index:n.indexInPane};if(n.allowCustom)(n.allowEmpty||this.refs.input.getValue())&&(t={text:this.refs.input.getValue()});else{var r=this.selectedIndex.get();t=this.state.matches[r]}t&&("contact"===t.type&&"email"===this.props.mode?(e=p.a.insertMatch(""),a.token=t):"item"===t.type?(e=p.a.insertMatch(""),a.item=t.item):e=p.a.insertMatch(this.getInsertText(t)),e&&(a.value=e.text,a.offset=e.offset),n.onSelected?n.onSelected(a):o.owner&&o.owner.onAutocompleteSelected&&o.owner.onAutocompleteSelected(a),this.hide())},getInsertText:function(e){return"email"===this.props.mode?e.text+" <"+e.email+">":"snooze"===e.type?e.insertText:e.text},insertHighlight:function(e){var t=[],n=p.a.getText(),o=e.toUpperCase().indexOf(n.toUpperCase());return o>=0&&n.length>0?(o>0&&t.push(e.substr(0,o)),t.push(l.a.createElement("span",{key:"match",className:"ac-match c-bg-autocomplete-highlight"},e.substr(o,n.length))),e.length>o+n.length&&t.push(e.substr(o+n.length))):t=e,t},onClickExpand:function(e,t){this.expanded.set(e),t.stopPropagation()},onClickExpandedInput:function(e){e.stopPropagation()},onSelectedAddChild:function(){var e=this.props,t=this.state,n=t.expanded,o=t.matches[n];if(e.onSelected){var a={item:o.item,subItemText:this.refs.inputAdd.getValue()};e.onSelected(a)}},getSpecialMatches:function(){if("snooze"===this.props.mode){var e=new Date,t=e.getHours(),n=e.getDay(),a=e.clone().clearTime().addHours(Math.min(t+3,23+59/60)),s=e.clone().clearTime();t<18?s.addHours(19):s.addHours(Math.min(t+2,23+59/60));var l=e.clone().clearTime();n<6?l.addDays(6-e.getDay()).addHours(9):6===n?l.addDays(1).addHours(9):l.addHours(Math.min(t+3,23+59/60));var c=e.clone().clearTime();n>0?c.addDays(8-e.getDay()).addHours(9):c.addDays(1).addHours(9);var u=e.clone().clearTime().addDays(1).addHours(9),d=e.clone().clearTime().addDays(1).addHours(19);return[{type:"snooze",icon:"icon-access_time",iconColor:"#f30",text:"Later Today",insertText:"Today "+a.toString(i.default.International.getFormat(r.a.DFormat.ShortTime)),date:a,showDay:!1},{type:"snooze",icon:"icon-access_time",iconColor:"#fa0",text:"Tonight",insertText:"Today "+s.toString(i.default.International.getFormat(r.a.DFormat.ShortTime)),date:s,showDay:!1},{type:"snooze",icon:"icon-access_time",iconColor:"#fd0",text:"Tomorrow Morning",insertText:"Tomorrow "+u.toString(i.default.International.getFormat(r.a.DFormat.ShortTime)),date:u,showDay:!0},{type:"snooze",icon:"icon-access_time",iconColor:"#2a6",text:"Tomorrow Night",insertText:"Tomorrow "+d.toString(i.default.International.getFormat(r.a.DFormat.ShortTime)),date:d,showDay:!0},{type:"snooze",icon:"icon-access_time",iconColor:o.default.colorBlue,text:"This Weekend",insertText:l.toString(i.default.International.getFormat(r.a.DFormat.NoPadShortDayTime)),date:l,showDay:!0},{type:"snooze",icon:"icon-access_time",iconColor:"#b0d",text:"Next Week",insertText:c.toString(i.default.International.getFormat(r.a.DFormat.NoPadShortDayTime)),date:c,showDay:!0}]}},onCloseButton:function(){i.default.menus.closeContextMenu()},setText:function(e){this.refs.input.setValue(e)},onAutocompleteDateChange:function(e){this.setText(e),this.refs.input.selectEnd()},renderSpecialAutocomplete:function(){if(a.a.isMobile&&"date"===this.props.mode)return l.a.createElement(_,{setText:this.onAutocompleteDateChange,onSelected:this.onSelected})},renderRightContent:function(){var e=this.state;if(e.matches.length>0&&e.selectedIndex>=0){var t,n=e.matches[e.selectedIndex];if("contact"===n.type&&(t=l.a.createElement(f.a,{contact:n})),t)return l.a.createElement("div",{className:"newAutocompleteRightContent c-border"},t)}},renderObject:function(e,t){var n;switch(e.type){case"contact":if(e.text&&e.email){n=this.insertHighlight(e.text);var a=this.insertHighlight(" <"+e.email+">");return l.a.createElement("span",null,l.a.createElement("span",{className:"contact c-contact"},n),a)}if(e.email)return e.email;if(e.text)return n=this.insertHighlight(e.text),l.a.createElement("span",{className:"contact c-contact"},n);break;case"tag":return n=this.insertHighlight(e.text),l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{className:"tag c-tag"},n),l.a.createElement("span",{className:"number c-foreground-faded"},e.count));case"date":return n=this.insertHighlight(e.text),l.a.createElement("span",{className:"date c-date"},n);case"snooze":var i=(e.showDay?e.date.toString("dddd")+" ":"")+e.date.toString("h:mm tt");return l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{className:"snoozeDate"},e.text),l.a.createElement("span",{className:"snoozeDetail"},i));case"item":var s=e.item,c=o.default.parentTextForItem(s),u=t===this.state.expanded,d=o.default.classNames("autocompleteItem flexbox",{hasParent:!!c},{itemExpanded:u}),p=this.props.mode===r.a.AutocompleteMode.Move;return l.a.createElement("div",{className:d},l.a.createElement("div",{className:"autocompleteItemInside f1"},c&&l.a.createElement("div",{className:"parentPath c-foreground-very-faded"},c),l.a.createElement(m.a,{key:s.id,item:s}),p&&u&&l.a.createElement(D.a,{ref:"inputAdd",placeholder:"Add subitem",buttonText:"MOVE TO CHILD",focused:!0,onButtonClick:this.onSelectedAddChild,onClick:this.onClickExpandedInput})),p&&l.a.createElement(O.a,{icon:u?"icon-angle-down":"icon-angle-right",className:"autocompleteExpand",width:46,height:46,onClick:this.onClickExpand.bind(this,t),tooltip:"Add sub-item"}));case r.a.AutocompleteMode.GmailLabel:return n=this.insertHighlight(e.text),l.a.createElement("span",null,n);default:try{o.default.PAssert(1821,!1,"Invalid insert text",e.type)}catch(f){self.reportError(f)}}},render:function(){for(var e=0,t=this.state,n=this.props,r=[],i=0;i<t.matches.length;i++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var s=t.matches[i],c=o.default.classNames("c-border-light autocomplete_"+s.type,{selected:i===t.selectedIndex});r.push(l.a.createElement(I.a,{key:i,ref:"item_"+i,icon:s.icon,iconColor:s.iconColor,className:c,onMouseOver:this.onMouseOver.bind(this,i),canClose:!1,noMouseUp:!0,onClick:this.onClick.bind(this,i)},this.renderObject(s,i)))}var u,d=n.text,p=n.buttonText;this.hasOwnInput()&&(u=!!n.allowEmpty||(n.allowCustom?void 0:t.selectedIndex>=0));var m,f,h=o.default.classNames("newAutocomplete flexbox",n.className,{contextMenuMobile:a.a.isMobile},{flexvert:this.hasOwnInput()},{hasOwnInput:this.hasOwnInput()},{expanded:!1!==t.expanded}),y=a.a.isMobile&&a.a.windowHeight()-t.kbsize,g=a.a.isMobile?{}:{minWidth:260,maxWidth:320};if(a.a.isMobile&&"full"===n.position)m=l.a.createElement("div",{className:"newAutocompleteTopBar flexbox c-border"},l.a.createElement(O.a,{className:"fancyModalClose",icon:"icon-close",iconSize:20,width:o.default.topBarHeight,height:o.default.topBarHeight,onClick:this.onCloseButton}),l.a.createElement(D.a,{ref:"input",display:"block",className:"f1",height:o.default.topBarHeight,placeholder:n.text,autocompleteMode:n.mode,padding:{left:16,right:16},border:!1})),f=this.renderSpecialAutocomplete();else if(!a.a.isMobile&&this.hasOwnInput()){var v=n.item||n.items&&n.items[0];m=l.a.createElement("div",{className:"newAutocompleteTopBar flexbox c-border-heavy"},l.a.createElement(D.a,{ref:"input",display:"block",className:"f1",placeholder:d,autocompleteMode:n.mode,padding:{left:16,right:16},tokens:n.tokens,onTokenRemoved:n.onTokenRemoved,border:!1,buttonText:p,onEscape:this.onEscape,buttonEnabled:u,onButtonClick:this.onButtonClick,autocompleteItem:v}))}var b=l.a.createElement(T.a,{className:"autocompleteMatches f1",style:g},r);return n.onlyMatches?b:l.a.createElement(P.a,{className:h,id:n.id,element:n.elementDisplay,maxWidth:"none",height:y,positionOffset:n.positionOffset,position:n.position,useElementPosition:!a.a.isMobile||"email"===n.mode,overflowHeight:"shrink",ref:"contextMenu"},m,f,!f&&b,!a.a.isMobile&&this.renderRightContent())}});t.default=R},326:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n(1),r=n(3),i=n(2),s=n(4),l=n.n(s),c=n(64),u=n(13),d={ReactAutocomplete:n(325),ReactContextMenuSelectGmailAccount:n(317),ReactContextMenuInsertLink:n(318),ReactContextMenuContactDetails:n(319),ReactContextMenuMobileOpenLink:n(320),ReactNotePopup:n(324),ReactContextMenuDropBucket:n(321),ReactContextMenuAuthorize:n(322),ReactContextMenuMobileFilter:n(323)},p=u.b.createClass({displayName:"ReactContextMenusMobile",componentDisplay:a.a.ComponentDisplay.Everywhere,getState:function(){return{contextMenus:r.default.menus.contextMenuStack,noFade:r.default.menus.contextMenuNoFade,isDragging:r.default.DragDrop.isVisible}},close:function(e,t){r.default.menus.isContextMenuOpen(e.fn)&&r.default.menus.closeContextMenu(e.fn),t.preventDefault(),t.stopPropagation()},render:function(){for(var e=0,t=this.state,n=[],a=0;a<t.contextMenus.length;a++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var r=t.contextMenus[a];if(r.noBackdrop||n.push(l.a.createElement("div",{key:"backdrop_"+a,className:"contextMenusBackdrop",onTouchStart:this.close.bind(this,r)})),r.fn)n.push(r.fn(r));else if(r.componentName){r.key=r.key||r.componentName,r.id=r.id||r.key;var s=d[r.componentName].default;n.push(l.a.createElement(s,r))}}var u=o.default.classNames("contextMenusReact",{open:n.length>0},{takeClick:n.length>0&&!r.noBackdrop},{none:0===n.length},{hideBackground:t.noFade||i.a.isMobile&&t.isDragging});return l.a.createElement(c.CSSTransitionGroup,{className:u,transitionName:"contextMenuAnim",transitionEnterTimeout:150,transitionLeaveTimeout:200},n)}});t.default=p},327:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n(1),r=n(3),i=n(34),s=n(4),l=n.n(s),c=n(13),u=n(314),d=n(10),p=n(61),m=n(57);function f(e){return(f="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(){return(h=Object.assign||function(e){for(var t=0,n=1;n<arguments.length;n++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e}).apply(this,arguments)}function y(e,t){for(var n=0,o=0;o<t.length;o++){if(n++>5e3&&__infLoop&&__infLoop(n))throw new RangeError;var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function g(e,t){return!t||"object"!==f(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e,t){return(b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var E=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),g(this,v(t).apply(this,arguments))}var n,s,f;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&b(e,t)}(t,c["a"]),n=t,(s=[{key:"init",value:function(){}},{key:"getState",value:function(){var e=this.props.importer;return{waitingText:e.waitingText,documents:e.documentsObs}}},{key:"close",value:function(){i.a.createDefaultState(),r.default.menus.closeModal(a.a.Modals.ImportMoodo)}},{key:"sortCmpDocs",value:function(e,t){return t.date.getTime()-e.date.getTime()}},{key:"onClickCancel",value:function(){this.close()}},{key:"onClickImport",value:function(e,t){var n=this,o=Object.keys(this.refs).filter(function(e){return e.startsWith("checkbox_")&&n.refs[e].getValue()}).map(function(e){return n.refs[e].props.itemID});return this.props.importer.importWithDocuments(o),this.close(),!0}},{key:"render",value:function(){var e=this.state,t=e.waitingText,n=e.documents,i=!t&&o.default.objectValues(n);return i&&i.sort(this.sortCmpDocs),l.a.createElement(u.a,h({},this.props,{id:"modalImport",title:"Import Data",width:400,height:600,modalID:a.a.Modals.ImportMoodo,ref:"modal"}),l.a.createElement("div",{key:"content"},l.a.createElement("div",{className:"flexbox flexvert",style:{height:"100%"}},l.a.createElement("div",{className:"setupTitle"},"Import Moo.do Documents"),l.a.createElement(m.a,{className:"importMoodoWrapper f1"},t&&l.a.createElement("div",{className:"c-foreground-light"},t),!t&&i.map(function(e){var t=e.id;return l.a.createElement(p.a,{key:t,itemID:t,ref:"checkbox_"+t,style:{marginBottom:24}},l.a.createElement("div",{className:"mooDocText bold"},e.text),l.a.createElement("div",{className:"mooDocDate c-foreground-faded"},e.date.toString(r.default.International.getFormat(a.a.DFormat.MonthDayYearLong))))})),l.a.createElement("div",{style:{marginTop:32,textAlign:"right"}},l.a.createElement(d.a,{raised:!0,onClick:this.onClickCancel},"CANCEL"),l.a.createElement(d.a,{raised:!0,primary:!0,marginLeft:16,enabled:!t,onClick:this.onClickImport},"IMPORT")))))}}])&&y(n.prototype,s),f&&y(n,f),t}();t.default=E},328:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n(1),r=n(3),i=n(4),s=n.n(i),l=n(64),c=n(13),u=n(27),d=n(10),p=n(44),m=n(314);function f(){return(f=Object.assign||function(e){for(var t=0,n=1;n<arguments.length;n++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e}).apply(this,arguments)}var h=c.b.createClass({displayName:"ReactModalPrompt",componentDisplay:a.a.ComponentDisplay.Everywhere,getHotkeys:function(){return[u.a.create(a.a.KeyCode.Enter,!0,a.a.Primary.Either,a.a.Shift.Either,this.onClickYes)]},onClickYes:function(){this.refs.modal.close(this.refs.input.getValue())},onClickNo:function(){this.refs.modal.close(!1)},render:function(){return s.a.createElement(m.a,f({},this.props,{id:"modalPrompt",title:this.props.text,small:!0,scrollable:!1,modalID:a.a.Modals.Prompt,ref:"modal"}),s.a.createElement("div",{key:"content"},s.a.createElement(p.a,{focused:!0,ref:"input"})),s.a.createElement("div",{key:"buttons"},s.a.createElement(d.a,{primary:!0,width:100,onClick:this.onClickYes},"OK"),s.a.createElement(d.a,{width:100,onClick:this.onClickNo},"NO")))}}),y=n(81);function g(){return(g=Object.assign||function(e){for(var t=0,n=1;n<arguments.length;n++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e}).apply(this,arguments)}var v=c.b.createClass({displayName:"ReactModalEmailReply",componentDisplay:a.a.ComponentDisplay.Everywhere,onMount:function(){var e=this.props,t=this.refs.compose;setTimeout(function(){e.responseMode===a.a.EmailResponseMode.Forward?t.focusTo():t.focusBody()},250)},onUnmount:function(){r.default.EmailPreview.setMessageResponseMode(this.props.inReplyToMessage.id,a.a.EmailResponseMode.None)},onClickSend:function(){this.refs.compose.send(),this.refs.modal.close()},onComposeClose:function(){var e=this.refs.modal;e&&e.close()},onCloseButton:function(){this.refs.compose.discard()},_getModalTitle:function(e){var t;return e===a.a.EmailResponseMode.Reply?t="Reply":e===a.a.EmailResponseMode.ReplyAll?t="Reply All":e===a.a.EmailResponseMode.Forward?t="Forward":e===a.a.EmailResponseMode.Other&&(t="Compose"),t},render:function(){var e=this.props,t=e.responseMode,n=this._getModalTitle(t);return s.a.createElement(m.a,g({},e,{id:"modalEmailReply",title:n,modalID:a.a.Modals.EmailReply,ref:"modal",confirmIcon:"icon-send",onConfirm:this.onClickSend,onCloseButton:this.onCloseButton}),s.a.createElement(y.a,{key:"content",threadAttach:e.threadAttach,message:e.message,ref:"compose",onClose:this.onComposeClose,responseMode:this.state.responseMode}))}}),b=c.b.createClass({displayName:"ReactModalAlert",componentDisplay:a.a.ComponentDisplay.Everywhere,getHotkeys:function(){return[u.a.create(a.a.KeyCode.Enter,!0,a.a.Primary.Either,a.a.Shift.Either,this.onClickButton)]},onClickButton:function(){this.refs.modal.close()},render:function(){var e=this.props.actionText||"OKAY";return s.a.createElement(m.a,{id:"modalAlert",closeButton:!1,small:!0,backdropClose:!1,scrollable:!1,modalID:a.a.Modals.Alert,ref:"modal"},s.a.createElement("div",{key:"content",dangerouslySetInnerHTML:{__html:this.props.text}}),s.a.createElement("div",{key:"buttons"},s.a.createElement(d.a,{primary:!0,onClick:this.onClickButton},e)))}});function E(){return(E=Object.assign||function(e){for(var t=0,n=1;n<arguments.length;n++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e}).apply(this,arguments)}var C=c.b.createClass({displayName:"ReactModalConfirm",componentDisplay:a.a.ComponentDisplay.Everywhere,getHotkeys:function(){return[u.a.create(a.a.KeyCode.Escape,!0,a.a.Primary.Either,a.a.Shift.Either,this.onClickNo),u.a.create(a.a.KeyCode.N,!0,a.a.Primary.Either,a.a.Shift.Either,this.onClickNo),u.a.create(a.a.KeyCode.Enter,!0,a.a.Primary.Either,a.a.Shift.Either,this.onClickYes),u.a.create(a.a.KeyCode.Y,!0,a.a.Primary.Either,a.a.Shift.Either,this.onClickYes)]},onClickYes:function(){this.refs.modal.close(!0)},onClickNo:function(){this.refs.modal.close(!1)},render:function(){return s.a.createElement(m.a,E({},this.props,{id:"modalConfirm",small:!0,backdropClose:!1,scrollable:!1,closeButton:!1,modalID:a.a.Modals.Confirm,ref:"modal"}),s.a.createElement("div",{key:"content"},this.props.text),s.a.createElement("div",{key:"buttons"},s.a.createElement(d.a,{primary:!0,width:100,onClick:this.onClickYes},"YES"),s.a.createElement(d.a,{width:100,onClick:this.onClickNo},"NO")))}}),k=n(18);function w(e){return(w="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){for(var n=0,o=0;o<t.length;o++){if(n++>5e3&&__infLoop&&__infLoop(n))throw new RangeError;var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function M(e,t){return!t||"object"!==w(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),M(this,S(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(t,c["a"]),n=t,(a=[{key:"render",value:function(){var e=o.default.classNames("fancyTable c-border-heavy",this.props.className);return s.a.createElement("div",{className:e,id:this.props.id},this.props.children)}}])&&x(n.prototype,a),r&&x(n,r),t}();function O(){return(O=Object.assign||function(e){for(var t=0,n=1;n<arguments.length;n++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e}).apply(this,arguments)}var D=c.b.createClass({displayName:"FancySelect",componentDisplay:a.a.ComponentDisplay.Everywhere,getValue:function(){return this.refs.select.value},setValue:function(e){this.refs.select.value=e},render:function(){var e=this.props,t=o.default.classNames(e.className,"fancySelect c-background c-border");return s.a.createElement("select",O({},e,{className:t,ref:"select"}),e.children)}}),T=n(57),P=n(40),I=n(70);function R(e){return(R="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e,t){for(var n=0,o=0;o<t.length;o++){if(n++>5e3&&__infLoop&&__infLoop(n))throw new RangeError;var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function A(e,t){return!t||"object"!==R(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function F(e,t){return(F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var j=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),A(this,B(t).apply(this,arguments))}var n,o,i;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F(e,t)}(t,c["a"]),n=t,(o=[{key:"init",value:function(){this.createObservables({page:0,error:!1,pendingChanges:[],defaultAcl:a.a.DocumentAccessRoles.Write})}},{key:"getState",value:function(){var e=r.default.settings.encryptionKeys,t=this.props.doc;return{acl:this.props.doc.acl,encryptionKeys:e,hasDocPassword:e.get()&&!!e.get()[t.id]}}},{key:"onClickShare",value:function(e,t){var n=this,o=this.refs.invite,a=o.getTokens().map(function(e){return e.email});if(this.error.set(""),a&&a.length>0)return this.props.doc.shareWithUser(a,this.state.defaultAcl).then(function(e){t(),e.error&&n.error.set(e.error)}),o.clearValue(),o.clearTokens(),!0}},{key:"onChangeSelectRole",value:function(e,t){var n=+t.target.value;this.props.doc.shareWithUser([e.email],n)}},{key:"onChangeDefaultRole",value:function(e){this.defaultAcl.set(+e.target.value)}},{key:"onClickRemovePermission",value:function(e,t,n){var o=this;return this.props.doc.shareWithUser([e.email],null).then(function(e){n(),e.error&&o.error.set(e.error)}),!0}},{key:"onClickCancel",value:function(){r.default.menus.closeModal(a.a.Modals.ShareDoc)}},{key:"onClickSkip",value:function(e,t){if(r.default.settings.hasUserPassword()){var n=this.props.doc;return P.a.updateDocumentEncryption(n,null).then(function(){t()}),!0}this.page.set(1)}},{key:"onClickEncrypt",value:function(e,t){var n=this.props.doc,o=this.refs.pass1.getValue(),a=this.refs.pass2.getValue(),i=n.id;if(o===a)return I.a.backupLocal(),r.default.crypto.addKey({name:i,password:o,sentinelSalt:n.id}).then(function(e){P.a.updateDocumentEncryption(n,e).then(function(){t()})}),!0;this.error.set("Passwords do not match")}},{key:"renderSelect",value:function(e,t){return s.a.createElement(D,{value:e,onChange:t,style:{height:28,marginTop:6,marginRight:8}},s.a.createElement("option",{value:a.a.DocumentAccessRoles.Admin},"Admin"),s.a.createElement("option",{value:a.a.DocumentAccessRoles.Write},"Write"))}},{key:"renderPageEncryption",value:function(){var e={marginTop:8,width:240};return s.a.createElement("div",null,s.a.createElement("div",{className:"font-big4 bold"},"Make this document extra secure?"),s.a.createElement("div",{className:"modal-subtitle font-small1 c-foreground-light",style:{marginTop:16}},"This document will be encrypted using this password for an extra level of security. You will need to give this password to anyone you share the document with. For your security, Moo.do cannot recover your password, so keep your password safe!"),s.a.createElement("div",{className:"flexbox flex-center"},s.a.createElement("div",{style:{marginTop:16}},s.a.createElement(p.a,{type:"password",placeholder:"Password",ref:"pass1",style:e}),s.a.createElement(p.a,{type:"password",placeholder:"Confirm Password",ref:"pass2",style:e}))),s.a.createElement("div",{className:"flexbox flex-center"},s.a.createElement("div",{style:{marginTop:20}},s.a.createElement(d.a,{raised:!0,onClick:this.onClickSkip},"SKIP"),s.a.createElement(d.a,{primary:!0,raised:!0,style:{marginLeft:24},onClick:this.onClickEncrypt},"ENCRYPT"))))}},{key:"renderPageShare",value:function(){var e=this,t=this.props.doc,n=this.state,o=Object.keys(n.acl).filter(function(e){return e!==k.a.getUid()}).map(function(e){return{uid:e,name:n.acl[e].t,email:n.acl[e].e,role:n.acl[e].r}});return s.a.createElement(T.a,{style:{height:"100%"}},s.a.createElement(_,null,s.a.createElement("div",{className:"fancyTableHeader font-big4 bold",style:{marginBottom:8}},"Share ",t.text.get()),o.map(function(n){var o=n.name?"".concat(n.name," <").concat(n.email,">"):n.email;return s.a.createElement("div",{key:n.uid,className:"flexbox"},s.a.createElement("div",{className:"f1"},o),e.renderSelect(n.role,e.onChangeSelectRole.bind(e,n)),t.isAdmin()&&s.a.createElement(d.a,{icon:"icon-close",width:40,height:40,onClick:e.onClickRemovePermission.bind(e,n)}))})),t.isAdmin()&&s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"flexbox",style:{marginTop:24}},s.a.createElement(p.a,{id:"inputShareInvite",className:"f1",placeholder:"Enter an mail address",autocompleteMode:"email",ref:"invite",style:{marginRight:8}}),this.renderSelect(this.state.defaultAcl,this.onChangeDefaultRole)),s.a.createElement(d.a,{primary:!0,raised:!0,onClick:this.onClickShare,style:{marginTop:16}},"INVITE")),n.error&&s.a.createElement("div",{className:"error"},n.error),!t.isAdmin()&&s.a.createElement("div",{className:"modal-group"},s.a.createElement("div",{className:"shareNotOwned gd"},"Only the creator of this file can share it with others. Please contact the creator to share it with others."),s.a.createElement(d.a,{id:"shareOkay",raised:!0,onClick:this.onClickCancel},"OKAY")))}},{key:"render",value:function(){var e=this.props,t=this.state;e.doc;return s.a.createElement(m.a,{id:"shareDoc",modalID:a.a.Modals.ShareDoc,ref:"modal",title:"Share File",width:500,height:320},s.a.createElement("div",{key:"content"},t.hasDocPassword||1===t.page?this.renderPageShare():this.renderPageEncryption()))}}])&&L(n.prototype,o),i&&L(n,i),t}(),K=n(2),V=n(17);function U(e){return(U="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z(e,t){for(var n=0,o=0;o<t.length;o++){if(n++>5e3&&__infLoop&&__infLoop(n))throw new RangeError;var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function H(e,t){return!t||"object"!==U(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function G(e,t){return(G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Y=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),H(this,W(t).apply(this,arguments))}var n,a,r;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(t,c["a"]),n=t,(a=[{key:"init",value:function(){this.createObservables({isFocused:this.props.focused||!1})}},{key:"onMount",value:function(){var e=this,t=this.refs.input;this.props.value&&(t.value=this.props.value),this.props.focused&&requestAnimationFrame(function(){t&&(t.focus(),void 0!==e.props.selectionStart&&(t.selectionStart=e.props.selectionStart),void 0!==e.props.selectionEnd&&(t.selectionEnd=e.props.selectionEnd),t.scrollTop=0)})}},{key:"onUnmount",value:function(){this.isFocused.get()&&this.onBlur()}},{key:"focus",value:function(){this.refs.input.focus()}},{key:"blur",value:function(){this.refs.input.blur()}},{key:"getValue",value:function(){return this.refs.input.value}},{key:"setValue",value:function(e){this.refs.input.value=e}},{key:"getSelectionStart",value:function(){return this.refs.input.selectionStart}},{key:"getSelectionEnd",value:function(){return this.refs.input.selectionEnd}},{key:"onFocus",value:function(e){o.default.vmMain.activeInput.set(this),this.isFocused.set(!0),this.props.onEscape&&(this.__hotkeyEscape=u.a.pushStackEscape(this.handleEscapeKey)),this.props.onFocus&&this.props.onFocus(e)}},{key:"onBlur",value:function(e){o.default.vmMain.activeInput.set(null),this.isFocused.set(!1),this.__hotkeyEscape&&(u.a.popStack(this.__hotkeyEscape),this.__hotkeyEscape=void 0),this.props.onBlur&&this.props.onBlur(e)}},{key:"onKeyPress",value:function(e){this.props.onKeyPress&&this.props.onKeyPress(e)}},{key:"handleEscapeKey",value:function(){this.props.onEscape&&this.props.onEscape()}},{key:"render",value:function(){var e=this.props,t=o.default.classNames("fancyTextarea c-background c-foreground",e.className),n=!!e.spellCheck||null,a={fontSize:e.fontSize,height:e.height||150,margin:void 0!==e.margin?e.margin:"16px 0",overflow:e.height<=34&&"hidden"};return s.a.createElement("textarea",{className:t,style:a,ref:"input",readOnly:!!e.isReadOnly,spellCheck:n,onClick:e.onClick,onChange:e.onChange,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:e.onKeyDown,onKeyPress:e.onKeyPress,placeholder:e.placeholder,tabIndex:e.tabIndex})}}])&&z(n.prototype,a),r&&z(n,r),t}();function X(e){return(X="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function q(e,t){for(var n=0,o=0;o<t.length;o++){if(n++>5e3&&__infLoop&&__infLoop(n))throw new RangeError;var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function J(e,t){return!t||"object"!==X(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Z(e){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $(e,t){return($=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Q=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),J(this,Z(t).apply(this,arguments))}var n,i,l;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}(t,c["a"]),n=t,(i=[{key:"onClickUV",value:function(e){o.default.openUrl("https://feedback.moo.do/",e),o.default.sendEvent("Menu","FeedbackUserVoice")}},{key:"onClickTwitter",value:function(e){o.default.openUrl("https://www.twitter.com/MooDoApp",e),o.default.sendEvent("Menu","FeedbackTwitter")}},{key:"onClickFacebook",value:function(e){o.default.openUrl("https://www.facebook.com/MooDoApp",e),o.default.sendEvent("Menu","FeedbackFacebook")}},{key:"onClickGooglePlus",value:function(e){o.default.openUrl("https://www.google.com/+MooDoApp",e),o.default.sendEvent("Menu","FeedbackGoogle")}},{key:"onClickCancel",value:function(e){r.default.menus.closeModal(a.a.Modals.ReportBug)}},{key:"onClickSend",value:function(e){var t=this.refs.description.getValue();if(t&&t.length>2){r.default.sendFeedback("Moo.do Feedback",t),r.default.menus.closeModal(a.a.Modals.ReportBug),r.default.toasts.pushMessage({text:"Thanks for taking the time to send us feedback!"}),o.default.sendEvent("Menu","SendFeedback"),K.a.isMobile&&V.a.reset()}}},{key:"render",value:function(){var e={paddingBottom:K.a.getKBSize()};return s.a.createElement(m.a,{id:"reportBug",modalID:a.a.Modals.ReportBug,ref:"modal",title:"Contact Support",width:450,height:500},s.a.createElement("div",{key:"content"},s.a.createElement("div",{className:"c-foreground-light"},"If you're requesting a feature, it's often easier to vote it up (or add it) on our UserVoice page."),s.a.createElement("div",{className:"center"},s.a.createElement(d.a,{className:"mc",primary:!0,onClick:this.onClickUV},"Open UserVoice")),s.a.createElement("br",null),s.a.createElement("div",{className:"c-foreground-light"},"Or talk to us on your favorite social network."),s.a.createElement("div",{className:"feedbackIcons marginCenter flexbox flex-center",style:{width:150}},s.a.createElement(d.a,{width:50,height:50,icon:"icon-twitter",tooltip:"@MooDoApp",onClick:this.onClickTwitter}),s.a.createElement(d.a,{width:50,height:50,marginLeft:16,icon:"icon-facebook",tooltip:"MooDoApp",onClick:this.onClickFacebook}),s.a.createElement(d.a,{width:50,height:50,marginLeft:16,icon:"icon-google-plus",tooltip:"+MooDoApp",onClick:this.onClickGooglePlus})),s.a.createElement("div",{className:"mat-subheader c-foreground-light"},"Or send us a message directly."),s.a.createElement(Y,{focused:!0,id:"bugDescription",height:200,ref:"description",margin:0})),s.a.createElement("div",{key:"buttons",style:e},s.a.createElement(d.a,{raised:!0,onClick:this.onClickCancel},"CANCEL"),s.a.createElement(d.a,{raised:!0,primary:!0,marginLeft:16,onClick:this.onClickSend},"SEND")))}}])&&q(n.prototype,i),l&&q(n,l),t}();function ee(){return(ee=Object.assign||function(e){for(var t=0,n=1;n<arguments.length;n++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e}).apply(this,arguments)}var te=c.b.createClass({displayName:"ReactModalOptions",componentDisplay:a.a.ComponentDisplay.Everywhere,onClickOption:function(e){this.refs.modal.close(e)},render:function(){return s.a.createElement(m.a,ee({},this.props,{id:"modalOptions",title:"Please Choose",small:!0,backdropClose:!1,scrollable:!1,modalID:a.a.Modals.Options,ref:"modal"}),s.a.createElement("div",{key:"content"},this.props.text),s.a.createElement("div",{key:"buttons"},this.props.options.map(function(e,t){return s.a.createElement(d.a,{key:t,raised:!0,width:120,margin:"0 8px",onClick:this.onClickOption.bind(this,e)},e)}.bind(this)),s.a.createElement(d.a,{cancel:!0,raised:!0,width:100,margin:"0 8px",onClick:this.onClickOption},"Cancel")))}}),ne=n(41),oe=n(61),ae=n(12);function re(){return(re=Object.assign||function(e){for(var t=0,n=1;n<arguments.length;n++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e}).apply(this,arguments)}var ie=c.b.createClass({displayName:"ReactModalMobileSettings",componentDisplay:a.a.ComponentDisplay.Mobile,init:function(){var e=0;ne.a.refresh();for(var t={enableNotifications:!r.default.settings.disableNotifications.get()},n=ne.a.pluginsAvailable,o=0;o<n.length;++o){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var a=n[o];t[a+"Enabled"]=ne.a.isPluginEnabled(a)}this.createObservables(t)},getState:function(){return{driveStatus:o.default.vmMain.gdriveStatusObs,hasPremiumFeatures:r.default.billingManager.hasPremiumFeaturesObservable,gmailSyncAccounts:ne.a.GmailSyncAccounts}},onSaveButton:function(){var e=0,t=ne.a.pluginsAvailable,n=this.state;n.enableNotifications!==!r.default.settings.disableNotifications.get()&&ne.a.toggleNotifications();var o=[a.a.PluginID.Contacts,a.a.PluginID.Gmail].filter(function(e){var t=e+"Enabled";return n[t]&&n[t]!==ne.a.isPluginEnabled(e)}).map(function(e){return{id:e}});if(o.length>0){ne.a.enablePlugins(o,!1,function(e){})}for(var i=0;i<t.length;++i){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var s=t[i],l=s+"Enabled";n[l]||n[l]===ne.a.isPluginEnabled(s)||ne.a.togglePlugin(s)}this.refs.modal.close()},onClickSendFeedback:function(){r.default.menus.openModal(a.a.Modals.ReportBug),o.default.sendEvent("Menu","GiveFeedback")},onClickReauthorize:function(){ne.a.enableOfflineFeatures(!0)},onClickReconnect:function(){o.default.reload()},onClickLogout:function(){o.default.vmSetup.logoutClicked()},renderPluginOptionCheckbox:function(e,t,n){return s.a.createElement(oe.a,{checked:this[e+"_"+t],setObs:!0},n)},renderPluginCheckbox:function(e,t,n){var o=e+"Enabled";return s.a.createElement(oe.a,{checked:this[o],setObs:!0,disabled:!0},n,t)},linkAccount:function(e,t,n){0},removeAccount:function(e){0},enableGmailSync:function(e,t){var n=r.default.pluginManager.getPluginGmail(),o=function(){ne.a.refresh()};t?this.linkAccount(e,[a.a.GScope.GmailCompose,a.a.GScope.GmailModify],function(e,t){e?n.addSyncAccount(t,function(e){e||o(),ne.a.refresh()}):o()}):n.removeSyncAccount(e,function(e){e||o(),ne.a.refresh()})},renderAccount:function(e){var t=r.default.pluginManager.getPlugin(a.a.PluginID.Gmail).isEnabled(),n=this.state.gmailSyncAccounts.indexOf(e)>=0,i=o.default.classNames("accountRow");return s.a.createElement("div",{key:"row"+e,className:i},s.a.createElement(oe.a,{disabled:!t,checked:n&&!0,error:!1,onChange:this.enableGmailSync.bind(this,e)},s.a.createElement(d.a,{icon:"icon-close",iconSize:20,display:"inline",width:50,height:50,onClick:this.removeAccount.bind(this,e)}),s.a.createElement("span",null,e)))},renderAccounts:function(){return this.getAccountList().map(this.renderAccount)},getAccountList:function(){var e=[];e.pushOnlyUniques(this.state.linkedAccounts),e.pushOnlyUniques(this.state.gmailSyncAccounts);return e.filter(function(e){return""!==e})},render:function(){var e=this.props,t=this.state,n=r.default.billingManager,o=(n.isTrialState(),+a.a.__jsVersion);return s.a.createElement(m.a,re({},e,{id:"modalMobileSettings",title:"Settings",modalID:a.a.Modals.MobileSettings,ref:"modal",topButtonWidth:80,closeButton:"CANCEL",confirmText:"SAVE",onConfirm:this.onSaveButton}),s.a.createElement("div",{key:"content"},s.a.createElement("div",{className:"modalSection"},s.a.createElement("div",{className:"modalSectionTitle"},"OPTIONS"),s.a.createElement("div",{className:"modalSectionList"},s.a.createElement(oe.a,{checked:this.enableNotifications,setObs:!0},"Notifications"))),s.a.createElement("div",{className:"modalSection"},s.a.createElement("div",{className:"modalSectionTitle"},"PLUGINS"),s.a.createElement("div",{className:"modalSectionList featureCheckboxes"},this.renderPluginCheckbox(a.a.PluginID.Contacts,"Google Contacts",s.a.createElement("i",{className:"icon-group"})),t[a.a.PluginID.Contacts+"Enabled"]&&s.a.createElement(d.a,{height:44,primary:!0},"Refresh Contacts"),this.renderPluginCheckbox(a.a.PluginID.Gmail,"Gmail",s.a.createElement("img",{src:"/img/plugin-gmail.png"})),s.a.createElement("div",{className:"c-foreground-faded",style:{fontSize:13,padding:"8px 0"}},"Modifying plugin settings on mobile is in development. For now please modify these settings in the desktop app."))),s.a.createElement("div",{className:"modalSection"},s.a.createElement("div",{className:"modalSectionTitle"},"ACTIONS"),s.a.createElement("div",{className:"modalSectionList"},s.a.createElement(d.a,{height:44,primary:!0,onClick:this.onClickReauthorize},"Reauthorize"),s.a.createElement(d.a,{height:44,primary:!0,onClick:this.onClickSendFeedback},"Contact Support"),s.a.createElement(d.a,{height:44,primary:!0,enabled:ae.a.isOnline(),onClick:this.onClickLogout},"Logout"))),s.a.createElement("div",{className:"modalSection"},s.a.createElement("div",{className:"modalSectionTitle"},"ACCOUNT STATUS"),s.a.createElement("div",{className:"modalSectionList modalSectionText g"},n.hasPremium()&&s.a.createElement("div",{className:"text"},"Premium since ",n.getPremiumStartDate().toString(r.default.International.getFormat(a.a.DFormat.LongStrDate))),s.a.createElement("div",{className:"text"},"Logged in as ",r.default.settings.activeUser.get()),s.a.createElement("div",{className:"text"},"Please open Moo.do on your computer to modify your account."))),s.a.createElement("div",{className:"modalSection"},s.a.createElement("div",{className:"modalSectionTitle"},"APP INFO"),s.a.createElement("div",{className:"modalSectionList modalSectionText g"},K.a.isDevURL&&s.a.createElement("div",{className:"text"},window.location.hostname),s.a.createElement("div",{className:"text"},"Version: ",o),s.a.createElement("div",{className:"text"},new Date(o).toString(r.default.International.getFormat(a.a.DFormat.ShortDayTime))))),void 0))}});function se(){return(se=Object.assign||function(e){for(var t=0,n=1;n<arguments.length;n++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e}).apply(this,arguments)}var le=c.b.createClass({displayName:"ReactModalEmailCompose",componentDisplay:a.a.ComponentDisplay.Everywhere,onClickSend:function(){this.refs.compose.send(),this.refs.modal.close()},onComposeClose:function(){r.default.menus.closeContextMenu(),this.refs.modal&&this.refs.modal.close()},onCloseButton:function(){this.refs.compose.discard()},render:function(){var e=this.props;return s.a.createElement(m.a,se({},e,{id:"modalEmailCompose",title:"New Message",modalID:a.a.Modals.EmailCompose,ref:"modal",confirmIcon:"icon-send",onConfirm:this.onClickSend,onCloseButton:this.onCloseButton}),s.a.createElement(y.a,{key:"content",threadAttach:e.threadAttach,message:e.message,ref:"compose",onClose:this.onComposeClose,showSubject:!0,focus:"to"}))}}),ce=n(316),ue=Object.assign||function(e){for(var t=0,n=1;n<arguments.length;n++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=arguments[n];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e},de=c.b.createClass({displayName:"ReactModalsMobile",componentDisplay:a.a.ComponentDisplay.Everywhere,getState:function(){return{modals:r.default.menus.modalStack}},renderModal:function(e){var t=e.id,n=t===a.a.Modals.Alert&&b||t===a.a.Modals.Confirm&&C||t===a.a.Modals.Prompt&&h||t===a.a.Modals.Options&&te||t===a.a.Modals.EmailReply&&v||t===a.a.Modals.EmailCompose&&le||t===a.a.Modals.MobileSettings&&ie||t===a.a.Modals.ReportBug&&Q||t===a.a.Modals.EnterCode&&ce.default||t===a.a.Modals.ShareDoc&&j;try{o.default.PAssert(1661,n,"Could not find modal with id "+t)}catch(r){self.reportError(r)}return s.a.createElement(n,ue({key:e.id},e))},render:function(){for(var e=0,t=[],n=0;n<this.state.modals.length;n++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;t.push(this.renderModal(this.state.modals[n]))}var a=o.default.classNames("modals",{none:0===t.length});return s.a.createElement(l.CSSTransitionGroup,{className:a,transitionName:"modalTransition",transitionEnterTimeout:400,transitionLeaveTimeout:300},t)}});t.default=de}}]);
