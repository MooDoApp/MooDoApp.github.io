(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{397:function(e,t,a){"use strict";var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(1),f=a(48),p=a(0),g=a(3),v=a.n(g),y=a(4),E=a(20),k=a(102);function C(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var b=function(e){s()(a,e);var t=C(a);function a(){return r()(this,a),t.apply(this,arguments)}return o()(a,[{key:"init",value:function(){this.refModal=v.a.createRef()}},{key:"close",value:function(e){this.props.onClose&&this.props.onClose(),y.default.menus.closeModal(this.props.modalID,e)}},{key:"onCloseButton",value:function(e){this.props.onCloseButton?this.props.onCloseButton():this.close()}},{key:"onEscapeKey",value:function(){this.props.noCancel||this.close()}},{key:"getElement",value:function(){return this.refModal.current}},{key:"render",value:function(){var e,t=this.props,a=this.getChildByKey("sidebar"),n=this.getChildByKey("content"),r=this.getChildByKey("buttons"),i={maxHeight:t.height?"".concat(h.a.ModalMaxHeightPerc,"%"):null,minWidth:t.minWidth,minHeight:t.minHeight,width:t.width,height:t.height},o=p.default.classNames("fancyModal c-bg-app popup c-shadow-popup flexbox flexvert",t.className,{small:t.small},{hasSidebar:!!a},{hasButtons:!!r}),l=p.default.classNames("fancyModalWrapper",{"small flexbox":t.small}),s=p.default.classNames("fancyModalContent c-border c-background f1",n.props.className),c=v.a.createElement(t.scrollable?k.a:"div",{className:s},n.props.children||n);if(a){var u={width:t.sidebarWidth||180};e=v.a.createElement("div",{className:"fancyModalSidebar",style:u},a.props.children)}return v.a.createElement("div",{className:l},!t.noBackdrop&&v.a.createElement(f.b.div,{className:"bg-black fixed inset-0",onClick:!1!==t.backdropClose?this.close.bind(this,!1):void 0,initial:{opacity:0},animate:{opacity:.8},transition:{duration:.25}}),v.a.createElement(f.b.div,{className:o,id:t.id,style:i,ref:this.refModal,initial:{scale:.85},animate:{scale:1},transition:h.a.TransitionSpringMedium},t.title&&!1!==t.closeButton&&v.a.createElement(E.a,{className:"fancyModalClose",icon:"icon-close",iconSize:20,width:36,height:36,onClick:this.onCloseButton,tooltip:"Close"}),t.title&&v.a.createElement("div",{className:"fancyModalTitle"},t.title),v.a.createElement("div",{className:"fancyModalInside flexbox flex1"},e,v.a.createElement("div",{className:"fancyModalContentArea c-border-light c-background flexbox flexvert f1"},c,r&&v.a.createElement("div",{className:p.default.classNames("fancyModalButtons c-background")},r)))))}}]),a}(a(33).a);t.a=b},398:function(e,t,a){"use strict";var n=a(0),r=a(3),i=a.n(r),o=a(21);t.a=Object(o.b)((function(e){var t=e.id,a=e.className,r=e.children,o=n.default.classNames("fancyTable c-border-heavy",a);return i.a.createElement("div",{className:o,id:t},r)}))},399:function(e,t,a){"use strict";var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(0),f=a(3),p=a.n(f),g=a(33),v=a(4);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var E=function(e){s()(a,e);var t=y(a);function a(){return r()(this,a),t.apply(this,arguments)}return o()(a,[{key:"init",value:function(){this.createObservables({isFocused:this.props.focused||!1})}},{key:"onMount",value:function(){var e=this,t=this.refs.input;this.props.value&&(t.value=this.props.value),this.props.focused&&requestAnimationFrame((function(){t&&(t.focus(),void 0!==e.props.selectionStart&&(t.selectionStart=e.props.selectionStart),void 0!==e.props.selectionEnd&&(t.selectionEnd=e.props.selectionEnd),t.scrollTop=0)}))}},{key:"onUnmount",value:function(){this.isFocused.get()&&this.onBlur()}},{key:"focus",value:function(){this.refs.input.focus()}},{key:"blur",value:function(){this.refs.input.blur()}},{key:"getValue",value:function(){return this.refs.input.value}},{key:"setValue",value:function(e){this.refs.input.value=e}},{key:"getSelectionStart",value:function(){return this.refs.input.selectionStart}},{key:"getSelectionEnd",value:function(){return this.refs.input.selectionEnd}},{key:"onFocus",value:function(e){this.isFocused.set(!0),this.props.onEscape&&(this.__hotkeyEscape=v.default.hotkeys.pushStackEscape(this.handleEscapeKey)),this.props.onFocus&&this.props.onFocus(e)}},{key:"onBlur",value:function(e){this.isFocused.set(!1),this.__hotkeyEscape&&(v.default.hotkeys.popStack(this.__hotkeyEscape),this.__hotkeyEscape=void 0),this.props.onBlur&&this.props.onBlur(e)}},{key:"onKeyPress",value:function(e){this.props.onKeyPress&&this.props.onKeyPress(e)}},{key:"handleEscapeKey",value:function(){this.props.onEscape&&this.props.onEscape()}},{key:"render",value:function(){var e=this.props,t=h.default.classNames("fancyTextarea c-background c-foreground",e.className),a=!!e.spellCheck||null,n={fontSize:e.fontSize,height:e.height||150,margin:void 0!==e.margin?e.margin:"16px 0",overflow:e.height<=34&&"hidden"};return p.a.createElement("textarea",{className:t,style:n,ref:"input",readOnly:!!e.isReadOnly,spellCheck:a,onClick:e.onClick,onChange:e.onChange,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:e.onKeyDown,onKeyPress:e.onKeyPress,placeholder:e.placeholder,tabIndex:e.tabIndex})}}]),a}(g.a);t.a=E},400:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(3);function r(e,t,a){Object(n.useEffect)((function(){var t=function(t){return e[t.normCode]&&e[t.normCode](t)};return window.addEventListener(a,t),function(){window.removeEventListener(a,t)}}),t)}var i=function(e,t){return r(e,t,"keydown")}},401:function(e,t,a){"use strict";var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(0),f=a(4),p=a(3),g=a.n(p),v=a(33),y=a(35),E=a(20),k=a(86);function C(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var b=function(e){s()(a,e);var t=C(a);function a(){return r()(this,a),t.apply(this,arguments)}return o()(a,[{key:"init",value:function(){this.refInputEmails=g.a.createRef()}},{key:"getState",value:function(){var e=f.default.billingManager;return{validBilling:e._hasValidBillingData,premiumStatus:e._premiumStatus,inviteEmailSuccess:e.inviteEmailSuccess,inviteEmailError:e.inviteEmailError,inviteCodeError:e.inviteCodeError}}},{key:"onTapInviteUrl",value:function(e){var t=e.target;t!==document.activeElement&&(y.default.selectElement(t),e.preventDefault(),h.default.sendEvent("Billing","TapInviteUrl"))}},{key:"inviteEmails",value:function(){for(var e=0,t=this.refInputEmails.current.getTokens(),a=[],n=0;n<t.length;n++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;a.push(t[n].email)}f.default.billingManager.sendInviteEmail(a)}},{key:"render",value:function(){var e=f.default.billingManager,t=this.state;return g.a.createElement("span",{className:"new-modal-group"},g.a.createElement("div",{className:"new-modal-title"},g.a.createElement("div",{className:"title"},"Share Moo.do with your friends"),g.a.createElement("div",{className:"subtext center"},"Thank you for spreading the ",g.a.createElement("i",{className:"icon-heart red"}))),g.a.createElement("div",{className:"new-modal-center"},g.a.createElement("div",null,g.a.createElement("div",{className:"subtitle"},"Social"),g.a.createElement("span",{className:"shareIcons"},g.a.createElement(E.a,{iconSize:22,icon:"icon-twitter",tooltip:"@MooDoApp",onClick:e.shareTwitter.bind(e)}),g.a.createElement(E.a,{iconSize:22,marginLeft:16,marginRight:16,icon:"icon-facebook",tooltip:"@MooDoApp",onClick:e.shareFacebook.bind(e)}),g.a.createElement(E.a,{iconSize:22,icon:"icon-google-plus",tooltip:"@MooDoApp",onClick:e.shareGoogle.bind(e)})),g.a.createElement("br",null),g.a.createElement("br",null),g.a.createElement("div",{className:"subtitle"},"Share Link"),g.a.createElement("div",{className:"subtext"},e.getSelectText()),g.a.createElement(k.a,{display:"inline-block",width:280,height:36,value:e.getInviteUrl(),onMouseDown:this.onTapInviteUrl,readonly:!0}),g.a.createElement("br",null),g.a.createElement("br",null),g.a.createElement("div",{className:"subtitle"},"Share by email"),g.a.createElement("div",{className:"subtext"},"Separate multiple email addresses with commas."),g.a.createElement(k.a,{ref:this.refInputEmails,width:350,buttonWidth:70,height:36,autocompleteMode:"email",placeholder:"Add friends' email addresses",buttonText:"SEND",onButtonClick:this.inviteEmails}),(t.inviteEmailSuccess||t.inviteEmailError)&&g.a.createElement("div",{id:"inviteEmailMessage",className:h.default.classNames({success:t.inviteEmailSuccess},{error:t.inviteEmailError})},t.inviteEmailSuccess||t.inviteEmailError))))}}]),a}(v.a);t.a=b},402:function(e,t,a){var n=a(126),r=a(411);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(r,i);e.exports=r.locals||{}},403:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(3);function r(e,t){var a=Object(n.useRef)();a.current||(a.current=e.listen(t)),Object(n.useEffect)((function(){return function(){var e;null===(e=a.current)||void 0===e||e.dispose(),a.current=void 0}}),[])}},404:function(e,t,a){"use strict";a.r(t);var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(1),f=a(0),p=a(3),g=a.n(p),v=a(4),y=a(70),E=a(43),k=a(86),C=a(405),b=a(117),x=a(58),D=a(15),w=a(25),S=a(33),M=a(181),N=a(104);function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var I=function(e){s()(a,e);var t=P(a);function a(){return r()(this,a),t.apply(this,arguments)}return o()(a,[{key:"init",value:function(){var e=this.props;this.refVirtualList=Object(p.createRef)(),this.createObservables({selectedIndex:e.elementInput||e.fromPane||e.onlyMatches?0:-1,expanded:-1,selectedDocument:D.a.getDefaultDocument()})}},{key:"onMount",value:function(){if(this.hasOwnInput()){var e=this.props,t=this.refs.input;t&&(t.focus(),t.updateAutocomplete(e.item||e.items&&e.items[0]))}document.addEventListener("keydown",this.onInputKeyDown,!0)}},{key:"componentWillReceiveProps",value:function(e){this.props.matches!==e.matches&&this.updateState(e)}},{key:"onUnmount",value:function(){document.removeEventListener("keydown",this.onInputKeyDown,!0)}},{key:"onBeforeChanged",value:function(e,t){var a=this.refs;if(e.matches!==t.matches&&!e.hasSpecialMatches){this.expanded.set(-1,!1),e.expanded=-1;var n=!a.input||!this.props.allowCustom&&a.input.getValue()&&this.state.matches.length>0?0:-1;this.selectedIndex.set(n,!1),e.selectedIndex=n}}},{key:"onAfterChanged",value:function(e,t){e.matches.length>t.matches.length&&setTimeout(function(){this.refs.contextMenu&&this.refs.contextMenu.updateState()}.bind(this),0)}},{key:"getState",value:function(e){var t=this.getSpecialMatches();return{matches:e.matches||t||x.a.matches,hasSpecialMatches:!!t,owner:x.a.owner}}},{key:"getClassNameForType",value:function(e){return("contact"===e?"autocomplete_contact":"date"===e&&"autocomplete_date")||"gmailLabel"===e&&"autocomplete_gmailLabel"||"header"===e&&"autocomplete_header"||"item"===e&&"autocomplete_item"||"snooze"===e&&"autocomplete_snooze"||"tag"===e&&"autocomplete_tag"}},{key:"updateTextFromIndex",value:function(){if(this.hasOwnInput()){var e=this.refs.input,t=this.selectedIndex.get(),a="";if(t>=0){var n=this.state.matches[t];a=this.getInsertText(n)}e.setValue(a),e.selectEnd()}}},{key:"onInputKeyDown",value:function(e){var t=this.state.matches,a=this.props;if(a.allowCustom&&e.keyCode===h.a.KeyCode.Enter)this.onSelected(),f.default.preventDefault(e),f.default.stopPropagation(e);else if(t.length>0){var n=this.selectedIndex.get();if(t.length>1&&(e.keyCode===h.a.KeyCode.ArrowDown||e.keyCode===h.a.KeyCode.ArrowUp)){var r,i;if(e.keyCode===h.a.KeyCode.ArrowUp)"header"===(null===(r=t[--n])||void 0===r?void 0:r.type)&&n--,n<(a.allowCustom?-1:0)&&(n=t.length-1),"header"===(null===(i=t[n])||void 0===i?void 0:i.type)&&n++;else if(e.keyCode===h.a.KeyCode.ArrowDown){var o;"header"===(null===(o=t[++n])||void 0===o?void 0:o.type)&&n++,n>t.length-1&&(n=a.allowCustom?-1:0)}if(n!==this.selectedIndex.get()&&(this.selectedIndex.set(n),this.updateTextFromIndex(),n>=0))try{this.refVirtualList.current.scrollToIndex({index:n,align:e.keyCode===h.a.KeyCode.ArrowDown?"end":"start",behavior:"auto"})}catch(l){}f.default.preventDefault(e)}else e.keyCode===h.a.KeyCode.ArrowRight?this.expanded.set(n):e.keyCode===h.a.KeyCode.Enter&&n>=0&&(this.onSelected(),f.default.preventDefault(e),f.default.stopPropagation(e))}}},{key:"onEscapeKey",value:function(){this.hide()}},{key:"hide",value:function(){x.a.hide()}},{key:"onMouseMove",value:function(e){this.selectedIndex.set(e)}},{key:"onClick",value:function(e){this.selectedIndex.set(e),this.updateTextFromIndex(),this.onSelected()}},{key:"onButtonClick",value:function(){this.onSelected()}},{key:"hasOwnInput",value:function(){return!this.props.elementInput&&!this.props.fromPane&&!this.props.onlyMatches}},{key:"onSelected",value:function(){var e,t,a=this.props,n=this.state,r=this.refs.input,i={owner:n.owner,index:a.indexInPane};if(a.allowCustom)(a.allowEmpty||r.getValue())&&(t={text:r.getValue()});else{var o=this.selectedIndex.get();t=this.state.matches[o]}t&&("contact"===t.type&&"email"===this.props.mode?i.token=t:"item"===t.type?i.item=t.item:e=x.a.insertMatch(this.getInsertText(t)),e&&(i.value=e.text,i.offset=e.offset),a.onSelected?a.onSelected(i):n.owner&&n.owner.onAutocompleteSelected&&n.owner.onAutocompleteSelected(i),this.hide())}},{key:"getInsertText",value:function(e){return"email"===this.props.mode?e.text+" <"+e.email+">":"snooze"===e.type?e.insertText:e.text}},{key:"insertHighlight",value:function(e){var t=[],a=x.a.getText(),n=e.toUpperCase().indexOf(a.toUpperCase());return n>=0&&a.length>0?(n>0&&t.push(e.substr(0,n)),t.push(g.a.createElement("span",{key:"match",className:"ac-match c-bg-autocomplete-highlight"},e.substr(n,a.length))),e.length>n+a.length&&t.push(e.substr(n+a.length))):t=e,t}},{key:"onClickExpand",value:function(e,t){this.expanded.set(e),t.stopPropagation()}},{key:"onClickExpandedInput",value:function(e){e.stopPropagation()}},{key:"onSelectedAddChild",value:function(){var e=this.props,t=this.state,a=t.expanded,n=t.matches[a];if(e.onSelected){var r={item:n.item,subItemText:this.refs.inputAdd.getValue()};e.onSelected(r)}}},{key:"getSpecialMatches",value:function(){if("snooze"===this.props.mode){var e,t,a,n=new Date,r=n.getHours(),i=n.getDay(),o=w.a.getTodayPlusMS(h.a.MSPerHour*Math.min(r+3,23+59/60));e=r<18?w.a.getTodayPlusMS(19*h.a.MSPerHour):w.a.getTodayPlusMS(h.a.MSPerHour*Math.min(r+2,23+59/60)),t=i<6?w.a.getTodayPlusMS(h.a.MSPerDay*(6-n.getDay())+9*h.a.MSPerHour):6===i?w.a.getTodayPlusMS(1*h.a.MSPerDay+9*h.a.MSPerHour):w.a.getTodayPlusMS(h.a.MSPerHour*Math.min(r+3,23+59/60)),a=i>0?w.a.getTodayPlusMS(h.a.MSPerDay*(8-n.getDay())+9*h.a.MSPerHour):w.a.getTodayPlusMS(h.a.MSPerDay+9*h.a.MSPerHour);var l=w.a.getTodayPlusMS(h.a.MSPerDay+9*h.a.MSPerHour),s=w.a.getTodayPlusMS(h.a.MSPerDay+19*h.a.MSPerHour);return[{type:"snooze",icon:"icon-access_time",iconColor:"#f30",text:"Later Today",insertText:"Today "+o.toString(v.default.International.getFormat(h.a.DFormat.ShortTime)),date:o,showDay:!1},{type:"snooze",icon:"icon-access_time",iconColor:"#fa0",text:"Tonight",insertText:"Today "+e.toString(v.default.International.getFormat(h.a.DFormat.ShortTime)),date:e,showDay:!1},{type:"snooze",icon:"icon-access_time",iconColor:"#fd0",text:"Tomorrow Morning",insertText:"Tomorrow "+l.toString(v.default.International.getFormat(h.a.DFormat.ShortTime)),date:l,showDay:!0},{type:"snooze",icon:"icon-access_time",iconColor:"#2a6",text:"Tomorrow Night",insertText:"Tomorrow "+s.toString(v.default.International.getFormat(h.a.DFormat.ShortTime)),date:s,showDay:!0},{type:"snooze",icon:"icon-access_time",iconColor:f.default.colorBlue,text:"This Weekend",insertText:t.toString(v.default.International.getFormat(h.a.DFormat.NoPadShortDayTime)),date:t,showDay:!0},{type:"snooze",icon:"icon-access_time",iconColor:"#b0d",text:"Next Week",insertText:a.toString(v.default.International.getFormat(h.a.DFormat.NoPadShortDayTime)),date:a,showDay:!0}]}}},{key:"onCloseButton",value:function(){v.default.menus.closeContextMenu()}},{key:"setText",value:function(e){this.refs.input.setValue(e)}},{key:"onAutocompleteDateChange",value:function(e){this.setText(e),this.refs.input.selectEnd()}},{key:"onChangeDocument",value:function(e){this.selectedDocument.set(D.a.getDocumentById(e))}},{key:"renderRightContent",value:function(){var e=this.state;if(e.matches.length>0&&e.selectedIndex>=0){var t,a=e.matches[e.selectedIndex];if("contact"===a.type&&(t=g.a.createElement(C.a,{contact:a})),t)return g.a.createElement("div",{className:"newAutocompleteRightContent c-border"},t)}}},{key:"renderObject",value:function(e,t){var a;switch(e.type){case"header":return g.a.createElement("span",{className:"autocompleteHeader"},e.text);case"contact":if(e.text&&e.email){a=this.insertHighlight(e.text);var n=this.insertHighlight(" <"+e.email+">");return g.a.createElement("span",null,g.a.createElement("span",{className:"contact c-contact"},a),n)}if(e.email)return e.email;if(e.text)return a=this.insertHighlight(e.text),g.a.createElement("span",{className:"contact c-contact"},a);break;case"tag":return a=this.insertHighlight(e.text),g.a.createElement(g.a.Fragment,null,g.a.createElement("span",{className:"tag c-tag"},a),g.a.createElement("span",{className:"number c-foreground-faded"},e.count));case"snooze":var r=(e.showDay?e.date.toString("dddd")+" ":"")+e.date.toString("h:mm tt");return g.a.createElement(g.a.Fragment,null,g.a.createElement("span",{className:"snoozeDate"},e.text),g.a.createElement("span",{className:"snoozeDetail"},r));case"item":var i=e.item,o=f.default.parentTextForItem(i),l=t===this.state.expanded,s=f.default.classNames("autocompleteItem flexbox",{hasParent:!!o},{itemExpanded:l}),c="move"===this.props.mode;return g.a.createElement("div",{className:s},g.a.createElement("div",{className:"autocompleteItemInside f1",style:{width:360}},o&&g.a.createElement("div",{className:"parentPath c-foreground-very-faded"},o),g.a.createElement(b.a,{key:i.id,item:i}),c&&l&&g.a.createElement(k.a,{ref:"inputAdd",placeholder:"Add subitem",buttonText:"MOVE TO CHILD",focused:!0,onButtonClick:this.onSelectedAddChild,onClick:this.onClickExpandedInput})));case"gmailLabel":return a=this.insertHighlight(e.text),g.a.createElement("span",null,a);default:try{f.default.PAssert(1030,!1,"Invalid insert text",e.type)}catch(u){f.default.reportError(u)}}}},{key:"renderMatch",value:function(e){var t=this.state,a=t.selectedIndex,n=t.matches[e];if(n){var r=f.default.classNames("c-border-light",this.getClassNameForType(n.type),{selected:e===a});return g.a.createElement(E.a,{key:e,icon:n.icon,iconColor:n.iconColor,className:r,onMouseMove:"header"!==n.type?this.onMouseMove.bind(this,e):void 0,canClose:!1,noMouseUp:!0,onClick:"header"!==n.type?this.onClick.bind(this,e):void 0},this.renderObject(n,e))}}},{key:"render",value:function(){var e,t,a=this.state,n=a.matches,r=a.selectedIndex,i=a.expanded,o=a.selectedDocument,l=this.props,s=l.text,c=l.buttonText;this.hasOwnInput()&&(t=!!l.allowEmpty||(l.allowCustom?void 0:r>=0));var u,d=f.default.classNames("newAutocomplete flexbox",l.className,{flexvert:this.hasOwnInput()},{hasOwnInput:this.hasOwnInput()},{expanded:-1!==i});if(this.hasOwnInput()){var m=l.documentSelector&&o.getRootItem()||l.item||l.items&&l.items[0];u=g.a.createElement("div",{className:"newAutocompleteTopBar c-border-heavy"},l.documentSelector&&g.a.createElement("div",{className:"flexbox",style:{padding:8}},g.a.createElement("div",{style:{paddingRight:16}},"Document:"),g.a.createElement(M.a,{className:"f1",defaultValue:o.id,onChange:this.onChangeDocument},D.a.getDocumentsArray().map((function(e){return g.a.createElement("option",{key:e.id,value:e.id},e.text.get())})))),g.a.createElement(k.a,{ref:"input",display:"block",className:"f1",placeholder:s,autocompleteMode:l.mode,padding:{left:16,right:16},tokens:l.tokens,onTokenRemoved:l.onTokenRemoved,border:!1,buttonText:c,onEscape:this.onEscapeKey,buttonEnabled:t,onButtonClick:this.onButtonClick,autocompleteItem:m}))}var h=g.a.createElement(N.a,{className:"autocompleteMatches h-full f1",items:n,renderItem:this.renderMatch,defaultItemSize:"item"===(null===n||void 0===n||null===(e=n[0])||void 0===e?void 0:e.type)?46:28,ref:this.refVirtualList});n.map((function(e){return"item"===e.type?46:28}));var p=Math.min(f.default.sum(n.map((function(e){return"item"===e.type?46:28})))+(this.hasOwnInput()?100:0),600);return l.onlyMatches?h:g.a.createElement(y.a,{className:d,id:l.id,element:l.elementDisplay,maxWidth:"none",positionOffset:l.positionOffset,height:p,overflowHeight:"shrink",ref:"contextMenu"},u,h,this.renderRightContent())}}]),a}(S.a);t.default=I},405:function(e,t,a){"use strict";var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(0),f=a(4),p=a(3),g=a.n(p);function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var y=function(e){s()(a,e);var t=v(a);function a(){return r()(this,a),t.apply(this,arguments)}return o()(a,[{key:"onClickNumber",value:function(e,t){f.default.menus.closeContextMenu(),h.default.openUrl(e.link,t,!0)}},{key:"onClickEmail",value:function(e,t){var a=f.default.pluginManager.getPluginGmail();if(a.isActive()){f.default.menus.closeContextMenu();var n={to:[{text:"",email:e.address}]};f.default.menus.openComposeEmail(a,{initData:n})}else h.default.openUrl(e.link,t,!0)}},{key:"render",value:function(){var e=this,t=this.props.contact;return g.a.createElement("div",{className:"contactPreview"},g.a.createElement("div",{className:"contactName c-border"},t.text),t.phoneNumbers&&t.phoneNumbers.map((function(t){return g.a.createElement("div",{className:"contactRow contactPhone",key:t.number},g.a.createElement("i",{className:"contactButton icon-phone c-foreground-super-faded"}),g.a.createElement("span",{className:"contactNumber link",onClick:e.onClickNumber.bind(e,t)},t.number),g.a.createElement("span",{className:"phoneType c-foreground-faded"},t.type))})),t.emails&&t.emails.map((function(t){return g.a.createElement("div",{className:"contactRow contactEmail",key:t.address},g.a.createElement("i",{className:"icon-mail_outline contactButton c-foreground-super-faded"}),g.a.createElement("span",{className:"contactEmail link",onClick:e.onClickEmail.bind(e,t)},t.address))})))}}]),a}(a(33).a);t.a=y},406:function(e,t,a){"use strict";var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(1),f=a(4),p=a(3),g=a.n(p),v=a(33),y=a(196);function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var k=function(e){s()(a,e);var t=E(a);function a(){return r()(this,a),t.apply(this,arguments)}return o()(a,[{key:"init",value:function(){var e=this.props,t=e.item.hasNote()&&e.item.getNote(),a=t?t.getParsedText():void 0;this.createObservables({hasValue:!!a}),this.refNoteText=g.a.createRef()}},{key:"onUnmount",value:function(){clearTimeout(this._noteUpdateTimeout),this._noteUpdateTimeout=void 0,this._saveNote()}},{key:"getValue",value:function(){return this.refNoteText.current.getValue()}},{key:"_saveNote",value:function(){if(this.props.shouldSave){f.default.PaneUpdateBatcher.beginUpdateItems();var e=this.props.item,t=e.hasNote()&&e.getNote(),a=this.refNoteText.current.getValue();!t&&a&&(t=e.createNote()),t&&(a!==t.getRawText()&&t.setText(a,h.a.ChangeType.Local),a||e.setNote(void 0,h.a.ChangeType.Local)),f.default.PaneUpdateBatcher.commitUpdateItems()}}},{key:"onChange",value:function(){var e=this,t=this.refNoteText.current.getValue().length>0;t!==this.hasValue.get()&&(this.hasValue.set(t),t&&this.props.onValueSet&&requestAnimationFrame((function(){return e.props.onValueSet}))),clearTimeout(this._noteUpdateTimeout),this._noteUpdateTimeout=setTimeout(this._saveNote,8e3)}},{key:"render",value:function(){var e=this.props,t=f.default.DisplaySettings.fontSize(),a=e.item.hasNote()&&e.item.getNote(),n=a?a.getParsedText():void 0,r=a?void 0:"Add note",i=this.state.hasValue?e.heightValue:e.heightEmpty,o=!e.item.canHaveNote();return g.a.createElement(y.a,{ref:this.refNoteText,className:e.className,value:n,placeholder:r,focused:e.focused,onChange:this.onChange,onKeyDown:e.onKeyDown,onKeyPress:e.onKeyPress,selectionStart:e.selectionStart,selectionEnd:e.selectionEnd,fontSize:t,margin:0,height:i,tabIndex:e.tabIndex,richText:!!e.richText,onMaximize:e.richText&&e.onMaximize,isMaximized:e.richText&&e.isMaximized,onClickClose:e.onClickClose,isReadOnly:o})}}]),a}(v.a);t.a=k},407:function(e,t,a){"use strict";a.r(t);var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(0),f=a(1),p=a(10),g=a(3),v=a.n(g),y=a(33),E=a(397),k=a(20),C=a(94);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var x=function(e){s()(a,e);var t=b(a);function a(){return r()(this,a),t.apply(this,arguments)}return o()(a,[{key:"init",value:function(){this.createObservables({isLoaded:!1,error:!1}),this.refModal=v.a.createRef()}},{key:"onLoaded",value:function(){this.isLoaded.set(!0)}},{key:"onError",value:function(){this.isLoaded.set(!0,!1),this.error.set("Could not load image")}},{key:"openExternal",value:function(){this.props.buttonAction?this.props.buttonAction():h.default.openUrl(this.props.src),this.close()}},{key:"close",value:function(){this.refModal.current.close()}},{key:"render",value:function(){var e=this.props,t=this.state,a=e.src,n={maxWidth:Math.min(.95*p.a.windowWidth(),900),maxHeight:Math.min(.95*p.a.windowHeight()-30,900),visibility:!t.isLoaded&&"hidden"},r=h.default.classNames({loaded:t.isLoaded});return v.a.createElement(E.a,{id:"modalLightbox",className:r,closeButton:!1,scrollable:!1,modalID:f.a.Modals.Lightbox,ref:this.refModal},v.a.createElement("div",{key:"content"},!t.isLoaded&&v.a.createElement(C.a,{center:!0}),!t.error&&v.a.createElement("img",{src:a,style:n,onLoad:this.onLoaded,onError:this.onError,onClick:this.close,ref:"image"}),t.error&&v.a.createElement("div",{className:"lightboxText"},t.error),t.isLoaded&&v.a.createElement(k.a,{id:"lightboxOpen",className:"c-border-heavy",primary:!0,height:30,onClick:this.openExternal},e.buttonText||(p.a.app?"Open in browser":"Open in new tab"))))}}]),a}(y.a);t.default=x},408:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(38),o=a.n(i),l=a(19),s=a.n(l),c=a(66),u=a.n(c),d=a(1),m=a(3),h=a.n(m),f=a(4),p=a(20),g=a(86),v=a(397),y=a(21),E=a(400);t.default=Object(y.b)((function(e){var t=e.title,a=e.fields,n=e.validate,i=u()(e,["title","fields","validate"]),l=[];a.forEach((function(e,t){l[t]=Object(m.useRef)()}));var c=Object(m.useState)(),y=s()(c,2),k=y[0],C=y[1],b=function(){var e=l.map((function(e){return e.current.getValue()})),t=null===n||void 0===n?void 0:n(e);t?C(t):f.default.menus.closeModal(d.a.Modals.Prompt,e)};return Object(E.a)(o()({},d.a.KeyCode.Enter,b),[]),h.a.createElement(v.a,r()({},i,{id:"modalPrompt",title:t,small:!0,scrollable:!1,modalID:d.a.Modals.Prompt}),h.a.createElement("div",{key:"content"},a.map((function(e,t){return h.a.createElement(g.a,{key:t,focused:0===t,ref:l[t],type:e.type,placeholder:e.placeholder,value:e.value,className:t>0&&"mt-4"})})),k&&h.a.createElement("div",{className:"error mt-2"},k)),h.a.createElement("div",{key:"buttons"},h.a.createElement(p.a,{primary:!0,width:100,onClick:b},"OK"),h.a.createElement(p.a,{width:100,onClick:function(){return f.default.menus.closeModal(d.a.Modals.Prompt)}},"CANCEL")))}))},409:function(e,t,a){var n=a(126),r=a(410);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(r,i);e.exports=r.locals||{}},410:function(e,t,a){(t=a(127)(!1)).push([e.i,"._1UykSJDyR4UTDPjn039-LH {\n    line-height: 18px;\n    font-size: 15px;\n}\n._3UMkU_qWXOD231TBqin1oC {\n    border-radius: 16px;\n    width: 42px;\n    height: 20px;\n    padding: 0 2px;\n}\n.UIljFlsy_8nT7shB2ELON {\n    border-radius: 50%;\n    width: 16px;\n    height: 16px;\n    margin: 0 1px;\n}\n._2mg06fP2DkZ0gxrTyyo9Nz {\n    padding-left: 56px;\n}",""]),t.locals={title:"_1UykSJDyR4UTDPjn039-LH",toggleOuter:"_3UMkU_qWXOD231TBqin1oC",toggleInner:"UIljFlsy_8nT7shB2ELON",description:"_2mg06fP2DkZ0gxrTyyo9Nz"},e.exports=t},411:function(e,t,a){(t=a(127)(!1)).push([e.i,"._2UgicGaVBDko5-eGd3GypU {\n    line-height: 18px;\n    font-size: 15px;\n}",""]),t.locals={title:"_2UgicGaVBDko5-eGd3GypU"},e.exports=t},412:function(e,t,a){var n=a(126),r=a(413);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};n(r,i);e.exports=r.locals||{}},413:function(e,t,a){(t=a(127)(!1)).push([e.i,"._2YnFeG17Gis_vIFc_Feqy7 {\n    line-height: 30px;\n    border: 1px solid;\n    overflow-x: auto;\n    margin-left: -8px;\n    margin-right: -8px\n}",""]),t.locals={table:"_2YnFeG17Gis_vIFc_Feqy7"},e.exports=t},414:function(e,t,a){"use strict";a.r(t);var n=a(38),r=a.n(n),i=a(66),o=a.n(i),l=a(4),s=a(3),c=a.n(s),u=a(1),d=a(20),m=a(397),h=a(21),f=a(400);t.default=Object(h.b)((function(e){var t=e.text,a=e.actionText,n=(o()(e,["text","actionText"]),function(){return l.default.menus.closeModal(u.a.Modals.Alert)});return Object(f.a)(r()({},u.a.KeyCode.Enter,n),[]),c.a.createElement(m.a,{id:"modalAlert",closeButton:!1,small:!0,backdropClose:!1,scrollable:!1,modalID:u.a.Modals.Alert},c.a.createElement("div",{key:"content",dangerouslySetInnerHTML:{__html:t}}),c.a.createElement("div",{key:"buttons"},c.a.createElement(d.a,{primary:!0,onClick:n},a||"OKAY")))}))},415:function(e,t,a){"use strict";a.r(t);var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(1),f=a(0),p=a(4),g=a(3),v=a.n(g),y=a(33),E=a(20),k=a(94),C=a(397),b=a(73);function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var D=null,w=1,S=2,M=3,N=null,P=1,I=2,T=3,A=4,R=5,O=6,L=7,F=8,_=9,G=10,B=["2m4b","gjgm","pmjw","5pm2","vvdg"],U=function(e){s()(a,e);var t=x(a);function a(){return r()(this,a),t.apply(this,arguments)}return o()(a,[{key:"init",value:function(){this._braintreeRequested=!1,this._braintreeLoaded=!1,this._clientTokenRequested=!1,this._clientToken=void 0,this._btClient=void 0,this._btIntegration=void 0,this.createObservables({isSubmitting:!1,isLoading:!0,billingFailureCode:D,signupFailureCode:N,signupErrorMessage:void 0}),this._ensureBraintreeLib(),this._ensureClientToken()}},{key:"onUnmount",value:function(){this._btIntegration&&(this._btIntegration.teardown(),this._btIntegration=void 0)}},{key:"_handlePaymentMethodUpdate",value:function(e){this.props.isUpdate?e&&e.nonce?this._processUpdateNonce(void 0,e.nonce):this._processUpdateNonce({error:!0},void 0):e&&e.nonce?this._processPaymentNonce(void 0,e.nonce):this._processPaymentNonce({error:!0},void 0)}},{key:"_notifyDependencyLoaded",value:function(){var e=this;this._braintreeLoaded&&this._clientToken&&(this._btClient=new braintree.api.Client({clientToken:this._clientToken}),braintree.setup(this._clientToken,"dropin",{container:"braintreeDropin",onPaymentMethodReceived:this._handlePaymentMethodUpdate,onError:function(e){f.default.reportError(e)},onReady:function(t){e.isLoading.set(!1),e._btIntegration=t}}))}},{key:"_notifyDependencyLoadError",value:function(e){this.billingFailureCode.set(e),f.default.reportError(new Error("Client hit error in billing: "+e)),p.default.billingManager.setLastSignupError(e),f.default.sendEvent("Billing","SignupError_"+e)}},{key:"_ensureBraintreeLib",value:function(){var e=this;this._braintreeRequested||(window.braintree?(this._braintreeLoaded=!0,this._notifyDependencyLoaded()):(this._braintreeRequested=!0,f.default.addScriptHack("https://js.braintreegateway.com/v2/braintree.js","braintreeScript",(function(){window.braintree?(e._braintreeLoaded=!0,e._notifyDependencyLoaded()):(e._braintreeRequested=!1,e._notifyDependencyLoadError(w))}),(function(){e._braintreeRequested=!1,e._notifyDependencyLoadError(S)}))))}},{key:"_ensureClientToken",value:function(){var e=this;this._clientTokenRequested||(this._clientTokenRequested=!0,b.a.getBillingToken().then((function(t){t.value?(e._clientToken=t.value.token,e._notifyDependencyLoaded()):e._notifyDependencyLoadError(M)})))}},{key:"_setPaymentResponse",value:function(e){switch(e.code){case h.a.PrivateAPIErrorCodes.UnauthorizedUser:this.signupFailureCode.set(A),this.signupErrorMessage.set(void 0);break;case h.a.PrivateAPIErrorCodes.InvalidParameter:this.signupFailureCode.set(R),this.signupErrorMessage.set(void 0);break;case h.a.PrivateAPIErrorCodes.MissingParameter:this.signupFailureCode.set(O),this.signupErrorMessage.set(void 0);break;case h.a.PrivateAPIErrorCodes.BraintreePaypalBlock:this.signupFailureCode.set(F),this.signupErrorMessage.set(e.data);break;case h.a.PrivateAPIErrorCodes.BraintreeInvalidCCN:this.signupFailureCode.set(_),this.signupErrorMessage.set(e.data);break;case h.a.PrivateAPIErrorCodes.BraintreeUnknown:this.signupFailureCode.set(L),this.signupErrorMessage.set(e.data);break;case h.a.PrivateAPIErrorCodes.AlreadyPremium:this.signupFailureCode.set(G),this.signupErrorMessage.set('Our database shows you as already being a Premium member. Please contact <a href="mailto:support@moo.do">support@moo.do</a>. Sorry for the trouble!');break;default:this.signupFailureCode.set(T),this.signupErrorMessage.set(void 0)}}},{key:"_processUpdateNonce",value:function(e,t){var a=this;f.default.sendEvent("Billing","PremiumUpdate"),!e&&t&&(this.isSubmitting.get()||(this.isSubmitting.set(!0),b.a.updatePlan({nonce:t}).then((function(e){a.isSubmitting.set(!1),e.error?(void 0!==e.errorCode?a._setPaymentResponse({code:e.errorCode}):a.signupErrorMessage.set(e.error),f.default.sendEvent("Billing","PremiumUpdateFAILURE")):(p.default.menus.isModalOpen(a.id)&&a.onClickClose(),p.default.menus.alert({text:"Your payment information has been updated.",actionText:"OKAY"}),f.default.sendEvent("Billing","PremiumUpdateSUCCESS"))}))))}},{key:"_processPaymentNonce",value:function(e,t){var a=this;if(f.default.sendEvent("Billing","PremiumSignup"),!e&&t){this.signupFailureCode.set(N),this.signupErrorMessage.set(void 0);var n=B[p.default.billingManager.getBillingPeriod()];try{f.default.PAssert(487,n,"Must have selected a valid plan to signup")}catch(r){f.default.reportError(r)}n?this.isSubmitting.get()||(this.isSubmitting.set(!0),b.a.purchasePlan({nonce:t,planID:n}).then((function(e){if(a.isSubmitting.set(!1),e.error)void 0!==e.errorCode?a._setPaymentResponse({code:e.errorCode}):a.signupErrorMessage.set(e.error),f.default.sendEvent("Billing","PremiumSignupFAILURE");else{p.default.menus.isModalOpen(a.id)&&a.onClickClose(),p.default.menus.alert({text:"Thank you for signing up for <b>Moo.do</b> Premium!",actionText:"OKAY"}),f.default.sendEvent("Billing","PremiumSignupSUCCESS");var t=f.default.parseInt(p.default.billingManager.getPlanPrice(B.indexOf(n)));f.default.reportAdConversion(h.a.ConversionID.Purchase,t)}}))):(this.signupFailureCode.set(I),this.signupErrorMessage.set(void 0),f.default.sendEvent("Billing","PremiumSignupFAILURE"))}else this.signupFailureCode.set(P),this.signupErrorMessage.set(void 0),f.default.sendEvent("Billing","PremiumSignupFAILURE")}},{key:"onClickSubmit",value:function(){this.refs.form.submit()}},{key:"onClickClose",value:function(){this.refs.modal.close()}},{key:"render",value:function(){var e=this.state,t=e.billingFailureCode||e.signupFailureCode?200:400,a=f.default.classNames("billingSubmit loading20 right",{loading:e.isSubmitting},{disabled:e.isLoading}),n=e.signupErrorMessage?e.signupErrorMessage:"There was an error processing your payment. We will follow up with you shortly.";return v.a.createElement(C.a,{id:"modalBilling",width:400,height:t,scrollable:!1,modalID:h.a.Modals.Billing,ref:"modal"},v.a.createElement("div",{key:"content"},!e.billingFailureCode&&!e.signupFailureCode&&v.a.createElement("form",{id:"billingForm",method:"post",action:"javascript:void(0);",ref:"form"},v.a.createElement("div",{id:"braintreeDropin"}),e.isLoading&&v.a.createElement(k.a,{center:!0},"Loading billing system..."),!e.billingFailureCode&&v.a.createElement("div",{className:a},v.a.createElement("input",{type:"submit",className:"new-modal-button mat-button-raised mat-button-blue",value:"SUBMIT"}))),e.signupFailureCode&&v.a.createElement("div",{id:"billingSignupError",dangerouslySetInnerHTML:{__html:n}}),e.billingFailureCode&&v.a.createElement("div",{id:"billingError"},"There was an error loading our payment system. Please contact support@moo.do with code "+e.billingFailureCode+" or try again in a few minutes.")),v.a.createElement("div",{key:"buttons",style:{textAlign:"right"}},e.billingFailureCode&&v.a.createElement(E.a,{primary:!0,onClick:this.onClickClose},"OK")))}}]),a}(y.a);t.default=U},416:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(66),o=a.n(i),l=a(7),s=a.n(l),c=a(8),u=a.n(c),d=a(17),m=a.n(d),h=a(18),f=a.n(h),p=a(9),g=a.n(p),v=a(3),y=a.n(v),E=a(33),k=a(4),C=a(1),b=a(20),x=a(397);function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=g()(e);if(t){var r=g()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return f()(this,a)}}var w=function(e){m()(a,e);var t=D(a);function a(){return s()(this,a),t.apply(this,arguments)}return u()(a,[{key:"init",value:function(){this.refModal=y.a.createRef()}},{key:"getHotkeys",value:function(){return[k.default.hotkeys.create(C.a.KeyCode.Escape,!0,C.a.Primary.Either,C.a.Shift.Either,this.onClickNo),k.default.hotkeys.create(C.a.KeyCode.N,!0,C.a.Primary.Either,C.a.Shift.Either,this.onClickNo),k.default.hotkeys.create(C.a.KeyCode.Enter,!0,C.a.Primary.Either,C.a.Shift.Either,this.onClickYes),k.default.hotkeys.create(C.a.KeyCode.Y,!0,C.a.Primary.Either,C.a.Shift.Either,this.onClickYes)]}},{key:"onClickYes",value:function(){this.refModal.current.close(!0)}},{key:"onClickNo",value:function(){this.refModal.current.close(!1)}},{key:"render",value:function(){var e=this.props,t=e.text,a=e.textYes,n=e.textNo,i=o()(e,["text","textYes","textNo"]);return y.a.createElement(x.a,r()({},i,{id:"modalConfirm",small:!0,backdropClose:!1,scrollable:!1,closeButton:!1,modalID:C.a.Modals.Confirm,ref:this.refModal}),y.a.createElement("div",{key:"content"},t),y.a.createElement("div",{key:"buttons"},y.a.createElement(b.a,{primary:!0,width:100,onClick:this.onClickYes},a||"YES"),y.a.createElement(b.a,{width:100,onClick:this.onClickNo},n||"NO")))}}]),a}(E.a);t.default=w},417:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(66),o=a.n(i),l=a(1),s=a(4),c=a(3),u=a.n(c),d=a(20),m=a(397),h=a(21);t.default=Object(h.b)((function(e){var t=e.text,a=e.options,n=o()(e,["text","options"]),i=Object(c.useRef)(),h=function(e){return s.default.menus.closeModal(l.a.Modals.Options,e)};return u.a.createElement(m.a,r()({},n,{id:"modalOptions",title:"Please Choose",small:!0,backdropClose:!1,scrollable:!1,modalID:l.a.Modals.Options,ref:i}),u.a.createElement("div",{key:"content"},t),u.a.createElement("div",{key:"buttons"},a.map((function(e,t){return u.a.createElement(d.a,{key:t,raised:!0,width:120,margin:"0 8px",onClick:function(){return h(e)}},e)})),u.a.createElement(d.a,{cancel:!0,raised:!0,width:100,margin:"0 8px",onClick:function(){return h()}},"Cancel")))}))},418:function(e,t,a){"use strict";a.r(t);var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(0),f=a(1),p=a(15),g=a(10),v=a(3),y=a(33),E=a(35),k=a(20),C=a(140),b=a(397),x=a(181),D=a(155);function w(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var S=function(e){s()(a,e);var t=w(a);function a(){return r()(this,a),t.apply(this,arguments)}return o()(a,[{key:"init",value:function(){this.createObservables({exportedContent:""}),this.exportArchived=!1,this.includeNotes=!0,this.includePrefixes=!0,this.dataType="json",this.document=p.a.getDocumentsArray()[0]}},{key:"getState",value:function(){return{documents:p.a.getDocumentsArray()}}},{key:"onMount",value:function(){this.exportData()}},{key:"exportData",value:function(){var e=this,t=this.document,a=this.exportArchived,n=this.includeNotes,r=this.includePrefixes;"html"===this.dataType?this.exportedContent.set(t.toHTML(a,n,r)):"text"===this.dataType?this.exportedContent.set(t.toPlaintext(a,n,r)):"opml"===this.dataType?this.exportedContent.set(t.toOPML(a,n,r)):"json"===this.dataType&&t.toJSON({exportArchived:a,includeNotes:n}).then((function(t){e.exportedContent.set(t)}))}},{key:"setDataType",value:function(e){this.dataType=e,this.exportData()}},{key:"onChangeArchiveItems",value:function(e){this.exportArchived=e,this.exportData()}},{key:"onChangeIncludePrefixes",value:function(e){this.includePrefixes=e,this.exportData()}},{key:"onChangeIncludeNotes",value:function(e){this.includeNotes=e,this.exportData()}},{key:"onChangeDocument",value:function(e){var t=this.state.documents.find((function(t){return t.id===e}));this.document=t,this.exportData()}},{key:"onTapOpen",value:function(){var e=open("url"),t=this.exportedContent.get();"opml"===this.dataType&&(t=h.default.escape(t)+"   "),e.document.write(t)}},{key:"onTapSelect",value:function(){var e=E.default.createSelectionRange();e.selectNodeContents(this.refs.exportedContent),E.default.setSelectionRange(e)}},{key:"onTapSaveExport",value:function(){var e="text"===this.dataType?"txt":this.dataType;try{h.default.saveFile(this.state.exportedContent,"moodo."+e)}catch(t){h.default.reportError(t)}}},{key:"onKeyDown",value:function(e){var t=g.a.getKeyCode(e);(!(g.a.mac&&e.metaKey||!g.a.mac&&e.ctrlKey)||t!==f.a.KeyCode.C&&t!==f.a.KeyCode.A&&t!==f.a.KeyCode.F)&&h.default.preventAndStop(e)}},{key:"render",value:function(){var e=this.state,t=e.documents,a=e.exportedContent,n=this.dataType,r=h.default.classNames("exportedContent",n),i="html"!==n?h.default.escape(a):a;return v.createElement(b.a,{id:"modalExport",width:860,height:900,sidebarWidth:170,modalID:f.a.Modals.ExportData},v.createElement("div",{key:"sidebar"},v.createElement(D.b,{inset:!0},v.createElement(D.a,{type:"header"},"SELECT DOCUMENT"),v.createElement(D.a,{type:"noselect"},v.createElement(x.a,{style:{height:32},ref:this.refSelectDocument,onChange:this.onChangeDocument},t.map((function(e){return v.createElement("option",{key:e.id,value:e.id},e.text.get())})))),v.createElement(D.a,{type:"header"},"DATA TYPE"),v.createElement(D.a,{onClick:this.setDataType.bind(this,"json")},"Moo.do Backup (JSON)"),v.createElement(D.a,{onClick:this.setDataType.bind(this,"html")},"HTML"),v.createElement(D.a,{onClick:this.setDataType.bind(this,"opml")},"OPML"),v.createElement(D.a,{onClick:this.setDataType.bind(this,"text")},"Plain Text"),v.createElement(D.a,{type:"header"},"OPTIONS"),v.createElement(D.a,{type:"noselect"},v.createElement(C.a,{checked:this.includePrefixes,onChange:this.onChangeIncludePrefixes},"Include Prefixes")),v.createElement(D.a,{type:"noselect"},v.createElement(C.a,{checked:this.includeNotes,onChange:this.onChangeIncludeNotes},"Include Notes")),v.createElement(D.a,{type:"noselect"},v.createElement(C.a,{checked:this.exportArchived,onChange:this.onChangeArchiveItems},"Archived Items")),v.createElement(D.a,{type:"header"},"EXPORT"),!g.a.app&&v.createElement(D.a,{type:"noselect",height:36},v.createElement(k.a,{marginLeft:-16,onClick:this.onTapOpen},"OPEN IN TAB")),v.createElement(D.a,{type:"noselect",height:36},v.createElement(k.a,{marginLeft:-16,onClick:this.onTapSelect},"SELECT")),v.createElement(D.a,{type:"noselect",height:36},v.createElement(k.a,{marginLeft:-16,onClick:this.onTapSaveExport},"SAVE")))),v.createElement("div",{key:"content"},v.createElement("div",{className:r,onKeyDown:this.onKeyDown,contentEditable:!0,dangerouslySetInnerHTML:{__html:i},ref:"exportedContent"})))}}]),a}(y.a);t.default=S},419:function(e,t,a){"use strict";a.r(t);var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(0),f=a(1),p=a(4),g=a(3),v=a.n(g),y=a(33),E=a(397),k=a(20),C=a(86),b=a(155),x=a(399);function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var w=function(e){s()(n,e);var t=D(n);function n(){return r()(this,n),t.apply(this,arguments)}return o()(n,[{key:"init",value:function(){var e=this,t=this.props.importer;a.e(3).then(a.bind(null,448)).then((function(t){var a=t.default;e.importer=new a,e.dimportLoaded.set(!0)})),"GTasks"===t&&(t="Google Tasks"),this.createObservables({isImporting:!1,preloadDisable:0,currentImporter:t||"Moo.do Backup",importMessage:"",dimportLoaded:!1}),this.refWorkflowy=v.a.createRef(),p.default.onIntroAction("Import")}},{key:"getImporterFromName",value:function(e){var t;switch(e){case"Wunderlist":t=this.importer.wunderlist;break;case"Workflowy":t=this.importer.workflowy;break;case"OPML":t=this.importer.opml;break;case"Moo.do Backup":t=this.importer.json;break;case"Google Tasks":t=this.importer.gtasks;break;case"Trello":t=this.importer.trello;break;case"Todoist":t=this.importer.todoist;break;default:try{h.default.PAssert(488,!1,"Must add valid importer: ",e)}catch(a){h.default.reportError(a)}}return t}},{key:"selectImporter",value:function(e){var t=this,a=this.getImporterFromName(e);this.currentImporter.set(e),this.importMessage.set(""),this.isImporting.set(!1),a&&a.preload&&!a.isLoaded&&(this.preloadDisable.set(this.preloadDisable.get()+1),this.importMessage.set("Loading Trello login..."),a.preload((function(){t.preloadDisable.set(t.preloadDisable.get()-1);var e=t.getImporterFromName(t.currentImporter.get());0===t.preloadDisable.get()&&e&&e.preload&&t.importMessage.set("")}),(function(e){t.preloadDisable.set(t.preloadDisable.get()-1),t.importMessage.set("Error loading Trello. Please try again.")})))}},{key:"onImportError",value:function(e,t){!1!==e?(e&&h.default.isString(e)||(t||(t=e),e="Moo.do encountered an error importing your data. The developers have been notified with details of the error."),h.default.reportError(t||new Error(e),e),this.importMessage.set(e)):this.importMessage.set(""),this.isImporting.set(!1)}},{key:"runImport",value:function(e,t,a){var n=this;if(!(this.isImporting.get()||this.preloadDisable.get()>0)){var r=function(){n.importMessage.set(""),p.default.menus.alert({text:"Your data has been imported successfully!",actionText:"OK",callback:function(){p.default.menus.closeModal(f.a.Modals.ImportData)}}),h.default.sendEvent("ImportSuccess",e)};if("Workflowy"===e){var i=this.refWorkflowy.current.getValue(),o=this.importer.opmlToDocument(i,"Workflowy Import");!0===o?r():this.importMessage.set(o)}else{var l=this.getImporterFromName(e);if(l){h.default.sendEvent("Menu","Import"+e),this.isImporting.set(!0),this.importMessage.set("Importing...");try{this.importer.runImport(l,t,a,(function(){n.isImporting.set(!1),r()}),this.onImportError)}catch(s){this.onImportError("There was an issue importing your data. Please try again later.",s)}}}}}},{key:"onTapSelect",value:function(e){this.selectImporter(e)}},{key:"whichArea",value:function(){switch(this.state.currentImporter){case"Wunderlist":return"disabled";case"Workflowy":return"WorkflowyArea";case"OPML":case"Moo.do Backup":return"UploadArea";case"Google Tasks":case"Trello":case"Todoist":return"OAuthArea";default:try{h.default.PAssert(489,!1,"Must add valid importer")}catch(e){h.default.reportError(e)}}return!1}},{key:"onClickSupport",value:function(){p.default.menus.openModal(f.a.Modals.ReportBug)}},{key:"onClickImport",value:function(){if(!this.isImporting.get()){var e=this.refs.email&&this.refs.email.getValue(),t=this.refs.password&&this.refs.password.getValue();this.runImport(this.state.currentImporter,e,t)}}},{key:"renderListItem",value:function(e){return v.a.createElement(b.a,{onClick:this.onTapSelect.bind(this,e)},e)}},{key:"renderContent",value:function(){var e,t=this.state,a=this.state.currentImporter,n=this.whichArea(),r=v.a.createElement(k.a,{primary:!0,enabled:0===t.preloadDisable&&!t.isImporting,onClick:this.onClickImport},"IMPORT");return"LoginArea"===n?e=v.a.createElement("div",null,v.a.createElement("div",{className:"importTitle"},"Import data from ",a),v.a.createElement(C.a,{floatingText:"Email",display:"block",ref:"email"}),v.a.createElement(C.a,{type:"password",floatingText:"Password",display:"block",ref:"password"}),v.a.createElement("br",null)):"UploadArea"===n?e=v.a.createElement("div",{id:"importUploadArea"},v.a.createElement("div",{className:"importTitle"},"Upload ",a," file"),v.a.createElement("div",null,"Select a","OPML"===a?"n":""," ",a," file to upload"),v.a.createElement("form",{name:"importFileUpload"},v.a.createElement("input",{id:"importFileUploadButton",type:"file",required:!0,name:"importFile"}))):"OAuthArea"===n?e=v.a.createElement("div",null,v.a.createElement("div",{className:"importTitle"},"Import data from ",a),v.a.createElement("div",null,"Click to login to your account")):"disabled"===n?(e=v.a.createElement("div",null,v.a.createElement("div",null,"Importing data from ",a," is not yet migrated to the new backend. Sorry about that! Please contact support.")),r=v.a.createElement(k.a,{style:{marginLeft:0},raised:!0,onClick:this.onClickSupport},"Contact support")):"WorkflowyArea"===n&&(e=v.a.createElement("div",null,v.a.createElement("div",{className:"importTitle",style:{marginBottom:24}},"Import data from Workflowy"),v.a.createElement("div",null,"In Workflowy, click the gear icon in the top right and select Export All. Select OPML and copy it, and paste it in the box below."),v.a.createElement(x.a,{height:300,ref:this.refWorkflowy}))),v.a.createElement("div",{className:"importInside"},e,r,v.a.createElement("div",{className:"importMessage"},t.importMessage))}},{key:"render",value:function(){var e,t="Loading...";return this.state.dimportLoaded&&(e=v.a.createElement(b.b,{inset:!0},v.a.createElement(b.a,{type:"header"},"IMPORT FROM DATA"),this.renderListItem("Moo.do Backup"),this.renderListItem("OPML"),v.a.createElement(b.a,{type:"header"},"IMPORT FROM APP"),this.renderListItem("Wunderlist"),this.renderListItem("Google Tasks"),this.renderListItem("Workflowy"),this.renderListItem("Trello"),this.renderListItem("Todoist")),t=this.renderContent()),v.a.createElement(E.a,{id:"modalImport",width:700,height:540,sidebarWidth:160,modalID:f.a.Modals.ImportData},v.a.createElement("div",{key:"sidebar"},e),v.a.createElement("div",{key:"content"},t))}}]),n}(y.a);t.default=w},420:function(e,t,a){"use strict";a.r(t);var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(0),f=a(1),p=a(4),g=a(10),v=a(3),y=a.n(v),E=a(33),k=a(154),C=a(397),b=a(140),x=a(181),D=a(39),w=a(98),S=a(15),M=a(59),N=a(155);function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var I=function(e){s()(a,e);var t=P(a);function a(){return r()(this,a),t.apply(this,arguments)}return o()(a,[{key:"init",value:function(){var e=S.a.getDocumentsArray(!0);this.createObservables({documents:e,selectedDoc:this.props.doc||e[0],selectedTime:void 0,showRaw:!1,showCompleted:!1,backupData:void 0,previewText:""})}},{key:"getState",value:function(){var e=S.a.getDocumentsArray(!0),t={};return e.forEach((function(e){t[e.id]=e.backups})),t}},{key:"onKeyDown",value:function(e){g.a.getKeyCode(e);(g.a.mac&&e.metaKey||!g.a.mac&&e.ctrlKey)&&f.a.KeyCode.A}},{key:"onChangeDocument",value:function(e){var t=this.state.documents.find((function(t){return t.id===e}));this.selectedDoc.set(t)}},{key:"onClickBackup",value:function(e){var t=this,a=this.state.selectedDoc;e!==this.selectedTime.get()&&(this.previewText.set("Loading..."),this.backupData.set(void 0),this.selectedTime.set(e),k.a.downloadBackup(a,e).then((function(n){if(t.selectedDoc.get()===a&&t.selectedTime.get()===e&&n){var r=function(e){var a=w.a.transformItems(e),r=n.doc;t.backupData.set({raw:n,rootItem:a[r.root]})},i=p.default.crypto.getKeyBySentinel(n.sentinel),o=function(){Promise.all(n.items.map((function(e){return p.default.crypto.decryptText(i,e.t,e.id).then((function(t){return e.t=t,e}))}))).then(r)};i?o():p.default.menus.openModal(f.a.Modals.EnterCode,{isPassword:!0,text:"This document was backed up with an encryption password. Please enter the password to unlock this backup.",onSelect:function(e){return new Promise((function(t,r){var l="backuptemp"+a.id;e&&p.default.crypto.addKey({name:l,password:e,sentinelSalt:D.a.getEncryptionUid()}).then((function(e){n.sentinel===e.sentinel?(t(),i=e.key,o()):(r("Incorrect password. Please try again."),p.default.crypto.removeKey(l))}))}))}})}})))}},{key:"onChangeShowRaw",value:function(e){this.showRaw.set(e)}},{key:"onChangeShowCompleted",value:function(e){this.showCompleted.set(e)}},{key:"renderItems",value:function(e,t){var a=this;if(this.state.showCompleted||!(e.flags&f.a.VMLIFlag.Complete)){var n=e.text;if(n.includes(f.a.CharDate)){var r=M.a.fromData(e.date);r&&(n=n.replace(f.a.CharDate,"!"+r.toText()))}n=t?"":"<li>".concat(h.default.escape(n));var i=e.noteItem,o=e.items;return(i||o)&&(n+="<ul>",i&&(n+='<li class="note c-foreground-faded">'.concat(h.default.escape(i.text),"</li>")),o&&o.forEach((function(e){return n+=a.renderItems(e,!1)})),n+="</ul>"),t||(n+="</li>"),n}return""}},{key:"renderBackup",value:function(){var e=this.state.backupData;if(this.state.showRaw){var t=h.default.cloneDeep(e.raw);try{t.items.forEach((function(e){return e.t=h.default.escape(e.t)}))}catch(a){}return JSON.stringify(t,null,2)}return"<ul>".concat(this.renderItems(e.rootItem,!0),"</ul>")}},{key:"renderBackups",value:function(){var e,t=this,a=this.state.selectedDoc,n=this.state[a.id];return n&&(e=Object.keys(n).sort((function(e,t){return+t-+e}))),y.a.createElement(N.b,{noInitialSelected:!0},e&&e.map((function(e){var a=+e,n=new Date(a);return y.a.createElement(N.a,{key:a,onClick:t.onClickBackup.bind(t,a)},n.toString("MMMM d, hh:mm tt"))})),!n&&y.a.createElement(N.a,{type:"noselect"},"No backups..."))}},{key:"render",value:function(){var e=this.state,t=h.default.classNames("flexbox flexvert"),a=e.backupData?this.renderBackup():"<ul><ul><li>".concat(e.previewText,"</li></ul></ul>");return y.a.createElement(C.a,{id:"modalBackups",width:1e3,height:900,sidebarWidth:200,modalID:f.a.Modals.Backups},y.a.createElement("div",{key:"sidebar"},y.a.createElement(x.a,{style:{margin:"0 16px 8px 16px",height:32},defaultValue:this.props.doc?this.props.doc.id:void 0,ref:this.refSelectDocument,onChange:this.onChangeDocument},e.documents.map((function(e){return y.a.createElement("option",{key:e.id,value:e.id},e.text.get())}))),e.selectedDoc&&this.renderBackups()),y.a.createElement("div",{key:"content",className:t},y.a.createElement("div",{className:"exportHeader"},y.a.createElement(b.a,{checked:e.showRaw,onChange:this.onChangeShowRaw},"Show raw"),y.a.createElement(b.a,{checked:e.showCompleted,onChange:this.onChangeShowCompleted},"Show completed")),y.a.createElement("div",{className:"exportedContent f1 scrollable c-border",onKeyDown:this.onKeyDown,dangerouslySetInnerHTML:{__html:a},ref:"exportedContent"})))}}]),a}(E.a);t.default=I},421:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(7),o=a.n(i),l=a(8),s=a.n(l),c=a(17),u=a.n(c),d=a(18),m=a.n(d),h=a(9),f=a.n(h),p=a(1),g=a(4),v=a(3),y=a.n(v),E=a(33),k=a(20),C=a(399),b=a(397);function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=f()(e);if(t){var r=f()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return m()(this,a)}}var D=function(e){u()(a,e);var t=x(a);function a(){return o()(this,a),t.apply(this,arguments)}return s()(a,[{key:"sendReport",value:function(e){var t=this.props;g.default.EmailPreview.reportMessage(t.accountID,t.threadID,t.msgID,this.refText.current.getValue(),e),this.refModal.current.close()}},{key:"onClickSend",value:function(){this.sendReport(!0)}},{key:"onClickCancel",value:function(){this.sendReport(!1)}},{key:"render",value:function(){return y.a.createElement(b.a,r()({},this.props,{id:"modalReportProblem",scrollable:!1,modalID:p.a.Modals.ReportProblem,ref:this.refModal}),y.a.createElement("div",{key:"content"},y.a.createElement("div",{className:"fancyModalText"},"Please describe the display problem."),y.a.createElement(C.a,{ref:this.refText,focused:!0}),y.a.createElement("div",{className:"fancyModalText"},"This will send the content of your email to the developers to fix display errors.")),y.a.createElement("div",{key:"buttons",style:{textAlign:"right"}},y.a.createElement(k.a,{width:100,onClick:this.onClickCancel},"CANCEL"),y.a.createElement(k.a,{primary:!0,width:100,onClick:this.onClickSend},"SEND")))}}]),a}(E.a);t.default=D},422:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(6),o=a.n(i),l=a(13),s=a.n(l),c=a(1),u=a(3),d=a.n(u),m=a(4),h=a(20),f=a(397),p=a(399),g=a(21);t.default=Object(g.b)((function(e){var t=Object(u.useRef)(),a=Object(u.useRef)();return d.a.createElement(f.a,r()({},e,{id:"modalDeleteAccount",scrollable:!1,width:600,modalID:c.a.Modals.DeleteAccount,ref:a}),d.a.createElement("div",{key:"content"},d.a.createElement("div",{className:"fancyModalText"},"It would be very helpful if you could describe how Moo.do could be more useful to you. Your feedback will help us improve Moo.do for you and others. Thanks!"),d.a.createElement(p.a,{ref:t,focused:!0})),d.a.createElement("div",{key:"buttons",style:{textAlign:"right"}},d.a.createElement(h.a,{width:100,onClick:function(){a.current.close(!1)}},"CANCEL"),d.a.createElement(h.a,{primary:!0,width:100,onClick:function(e,n){return s()(o.a.mark((function e(){var r;return o.a.wrap((function(e){for(var i=0;;){if(i++>5e3&&__infLoop&&__infLoop(i))throw new RangeError;switch(e.prev=e.next){case 0:if("Moo.do Deleted Account",!(r=t.current.getValue())){e.next=5;break}return e.next=5,m.default.sendFeedback("Moo.do Deleted Account",r);case 5:n(),a.current.close(!0);case 7:case"end":return e.stop()}}}),e)})))(),!0}},"DELETE")))}))},423:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(7),o=a.n(i),l=a(8),s=a.n(l),c=a(17),u=a.n(c),d=a(18),m=a.n(d),h=a(9),f=a.n(h),p=a(0),g=a(1),v=a(4),y=a(3),E=a.n(y),k=a(33),C=a(20),b=a(398),x=a(397);function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=f()(e);if(t){var r=f()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return m()(this,a)}}var w=function(e){u()(a,e);var t=D(a);function a(){return o()(this,a),t.apply(this,arguments)}return s()(a,[{key:"onTransactionClick",value:function(e){var t=p.default.clone(e),a=v.default.billingManager.userProperties;t.company=a.invoiceCompany,t.address=a.invoiceAddress;var n=window.btoa(JSON.stringify(t));p.default.openUrl(window.location.protocol+"//"+window.location.host+"/invoice#d="+n)}},{key:"render",value:function(){var e=this;return E.a.createElement(x.a,r()({},this.props,{id:"modalInvoices",scrollable:!1,modalID:g.a.Modals.Invoices,ref:"modal"}),E.a.createElement("div",{key:"content"},this.props.transactions.length>0&&E.a.createElement(b.a,{className:"transactionsTable"},E.a.createElement("div",{key:"header"},E.a.createElement("div",null,"Transaction Date"),E.a.createElement("div",null,"Amount"),E.a.createElement("div",null)),this.props.transactions.map((function(t){var a=new Date(t.date).toString(v.default.International.getFormat(g.a.DFormat.LongStrDate));return E.a.createElement("div",{key:t.id},E.a.createElement("div",null,a),E.a.createElement("div",null,t.amount),E.a.createElement(C.a,{primary:!0,onClick:e.onTransactionClick.bind(e,t),height:"auto"},"VIEW"))}))),0===this.props.transactions.length&&E.a.createElement("div",null,"There are not transactions available for this account.")))}}]),a}(k.a);t.default=w},424:function(e,t,a){"use strict";a.r(t);var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(3),f=a.n(h),p=a(1),g=a(0),v=a(4),y=a(39),E=a(33),k=a(86),C=a(20),b=a(397),x=a(398),D=a(181),w=a(102),S=a(76),M=a(154);function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var P=function(e){s()(a,e);var t=N(a);function a(){return r()(this,a),t.apply(this,arguments)}return o()(a,[{key:"init",value:function(){this.createObservables({page:0,error:!1,invites:[],defaultAcl:p.a.DocumentAccessRoles.Write}),v.default.onIntroAction("ShareDoc")}},{key:"getState",value:function(){var e=v.default.settings.encryptionKeys,t=this.props.doc;return{acl:t.acl,isShared:t.isShared(),encryptionKeys:e,hasDocPassword:e.get()&&!!e.get()[t.id]}}},{key:"onClickShare",value:function(e,t){var a=this,n=this.refs.invite,r=n.getTokens().map((function(e){return e.email}));if(this.error.set(""),r&&r.length>0)return this.props.doc.shareWithUser(r,this.state.defaultAcl).then((function(e){if(t(),e.error)a.error.set(e.error);else if(e.value){var n=e.value;!0!==n&&g.default.isArray(n)&&n.forEach((function(e){var t=e.email;e.error,e.shared;e.invited&&!a.invites.includes(t)&&a.invites.push(t)}))}})),n.clearValue(),n.clearTokens(),!0}},{key:"onChangeSelectRole",value:function(e,t){var a=+t;this.props.doc.shareWithUser([e.email],a)}},{key:"onChangeDefaultRole",value:function(e){this.defaultAcl.set(+e.target.value)}},{key:"onClickRemovePermission",value:function(e,t,a){var n=this;return this.props.doc.shareWithUser([e.email],null).then((function(e){a(),e.error&&n.error.set(e.error)})),!0}},{key:"onClickCancel",value:function(){v.default.menus.closeModal(p.a.Modals.ShareDoc)}},{key:"onClickSkip",value:function(e,t){var a=this;if(v.default.settings.hasUserPassword()){var n=this.props.doc;return S.a.updateDocumentEncryption(n,v.default.crypto.getGlobalKeyInfo()).then((function(){a.page.set(1),t()})),!0}this.page.set(1)}},{key:"onClickEncrypt",value:function(e,t){var a=this.props.doc,n=this.refs.pass1.getValue(),r=this.refs.pass2.getValue(),i=a.id;if(n===r)return M.a.backupDocumentAll(a).then((function(){v.default.crypto.addKey({name:i,password:n,sentinelSalt:a.id}).then((function(e){S.a.updateDocumentEncryption(a,e).then((function(){t()}))}))})),!0;this.error.set("Passwords do not match")}},{key:"renderSelect",value:function(e,t){return f.a.createElement(D.a,{value:e,onChange:t,style:{height:36,marginRight:8}},f.a.createElement("option",{value:p.a.DocumentAccessRoles.Admin},"Admin"),f.a.createElement("option",{value:p.a.DocumentAccessRoles.Write},"Write"))}},{key:"renderPageEncryption",value:function(){var e={marginTop:8,width:240};return f.a.createElement("div",null,f.a.createElement("div",{className:"font-big4 bold"},"Make this document (".concat(this.props.doc.text.get(),") extra secure?")),f.a.createElement("div",{className:"modal-subtitle font-small1 c-foreground-light",style:{marginTop:16}},"This document will be encrypted using this password for an extra level of security. You will need to give this password to anyone you share the document with. For your security, Moo.do cannot recover your password, so keep your password safe!"),f.a.createElement("div",{className:"flexbox flex-center"},f.a.createElement("div",{style:{marginTop:16}},f.a.createElement(k.a,{type:"password",placeholder:"Password",ref:"pass1",style:e}),f.a.createElement(k.a,{type:"password",placeholder:"Confirm Password",ref:"pass2",style:e}))),f.a.createElement("div",{className:"flexbox flex-center"},f.a.createElement("div",{style:{marginTop:20}},f.a.createElement(C.a,{raised:!0,onClick:this.onClickSkip},"SKIP"),f.a.createElement(C.a,{primary:!0,raised:!0,style:{marginLeft:24},onClick:this.onClickEncrypt},"ENCRYPT"))))}},{key:"renderPageShare",value:function(){var e=this,t=this.props.doc,a=this.state,n=a.acl,r=a.error,i=a.invites,o=Object.keys(n).filter((function(e){return e!==y.a.getEncryptionUid()})).map((function(e){return{uid:e,name:n[e].t,email:n[e].e,role:n[e].r}}));return f.a.createElement(w.a,{style:{height:"100%"}},f.a.createElement(x.a,null,f.a.createElement("div",{className:"fancyTableHeader font-big4 bold",style:{marginBottom:8}},"Share ",t.text.get()),o.map((function(a){var n=a.name?"".concat(a.name," <").concat(a.email,">"):a.email;return f.a.createElement("div",{key:a.uid,className:"flexbox items-center"},f.a.createElement("div",{className:"f1"},n),e.renderSelect(a.role,e.onChangeSelectRole.bind(e,a)),t.isAdmin()&&f.a.createElement(C.a,{icon:"icon-close",width:40,height:40,onClick:e.onClickRemovePermission.bind(e,a)}))})),i.map((function(e){return f.a.createElement("div",{key:e,className:"flexbox"},f.a.createElement("div",{className:"f1"},e),f.a.createElement("div",null,"Invited"))}))),t.isAdmin()&&f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"flexbox items-center",style:{marginTop:24}},f.a.createElement(k.a,{id:"inputShareInvite",className:"f1",placeholder:"Enter an mail address",autocompleteMode:"email",ref:"invite",style:{marginRight:8}}),this.renderSelect(this.state.defaultAcl,this.onChangeDefaultRole)),f.a.createElement(C.a,{primary:!0,raised:!0,onClick:this.onClickShare,style:{marginTop:16}},"INVITE")),r&&f.a.createElement("div",{className:"error"},r),!t.isAdmin()&&f.a.createElement("div",{className:"modal-group"},f.a.createElement("div",{className:"shareNotOwned gd"},"Only the creator of this file can share it with others. Please contact the creator to share it with others."),f.a.createElement(C.a,{id:"shareOkay",raised:!0,onClick:this.onClickCancel},"OKAY")))}},{key:"render",value:function(){var e=this.props,t=this.state;e.doc;return f.a.createElement(b.a,{id:"shareDoc",modalID:p.a.Modals.ShareDoc,ref:"modal",width:500,height:320},f.a.createElement("div",{key:"content"},t.hasDocPassword||t.isShared||1===t.page?this.renderPageShare():this.renderPageEncryption()))}}]),a}(E.a);t.default=P},425:function(e,t,a){"use strict";a.r(t);var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(3),f=a.n(h),p=a(1),g=a(0),v=a(4),y=a(33),E=a(20),k=a(399),C=a(397);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var x=function(e){s()(a,e);var t=b(a);function a(){return r()(this,a),t.apply(this,arguments)}return o()(a,[{key:"onClickUV",value:function(e){g.default.openUrl("https://feedback.moo.do/",e),g.default.sendEvent("Menu","FeedbackUserVoice")}},{key:"onClickTwitter",value:function(e){g.default.openUrl("https://www.twitter.com/MooDoApp",e),g.default.sendEvent("Menu","FeedbackTwitter")}},{key:"onClickFacebook",value:function(e){g.default.openUrl("https://www.facebook.com/MooDoApp",e),g.default.sendEvent("Menu","FeedbackFacebook")}},{key:"onClickCancel",value:function(e){v.default.menus.closeModal(p.a.Modals.ReportBug)}},{key:"onClickSend",value:function(e){var t=this.refs.description.getValue();if(t&&t.length>2){v.default.sendFeedback("Moo.do Feedback",t),v.default.menus.closeModal(p.a.Modals.ReportBug),v.default.toasts.pushMessage({text:"Thanks for taking the time to send us feedback!"}),g.default.sendEvent("Menu","SendFeedback")}}},{key:"render",value:function(){return f.a.createElement(C.a,{id:"reportBug",modalID:p.a.Modals.ReportBug,ref:"modal",width:450,height:500},f.a.createElement("div",{key:"content"},f.a.createElement("div",{className:"c-foreground-light"},"If you're requesting a feature, it's often easier to vote it up (or add it) on our UserVoice page."),f.a.createElement("div",{className:"center"},f.a.createElement(E.a,{className:"mc",primary:!0,onClick:this.onClickUV},"Open UserVoice")),f.a.createElement("br",null),f.a.createElement("div",{className:"c-foreground-light"},"Or talk to us on your favorite social network."),f.a.createElement("div",{className:"feedbackIcons marginCenter flexbox flex-center",style:{width:150}},f.a.createElement(E.a,{width:50,height:50,icon:"icon-twitter",tooltip:"@MooDoApp",onClick:this.onClickTwitter}),f.a.createElement(E.a,{width:50,height:50,marginLeft:16,icon:"icon-facebook",tooltip:"MooDoApp",onClick:this.onClickFacebook})),f.a.createElement("div",{className:"mat-subheader c-foreground-light"},"Or send us a message directly."),f.a.createElement(k.a,{focused:!0,id:"bugDescription",height:200,ref:"description",margin:0})),f.a.createElement("div",{key:"buttons"},f.a.createElement(E.a,{raised:!0,onClick:this.onClickCancel},"CANCEL"),f.a.createElement(E.a,{raised:!0,primary:!0,marginLeft:16,onClick:this.onClickSend},"SEND")))}}]),a}(y.a);t.default=x},426:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(7),o=a.n(i),l=a(8),s=a.n(l),c=a(17),u=a.n(c),d=a(18),m=a.n(d),h=a(9),f=a.n(h),p=a(1),g=a(4),v=a(3),y=a.n(v),E=a(33),k=a(20),C=a(86),b=a(397);function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=f()(e);if(t){var r=f()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return m()(this,a)}}var D=function(e){u()(a,e);var t=x(a);function a(){return o()(this,a),t.apply(this,arguments)}return s()(a,[{key:"init",value:function(){this.createObservables({errorText:""})}},{key:"onMount",value:function(){this.refs.code.focus()}},{key:"onClickConfirm",value:function(){var e=this,t=this.refs.code.getValue();this.errorText.set(""),this.props.onSelect(t).then((function(){g.default.menus.closeModal(p.a.Modals.EnterCode)})).catch((function(t){e.errorText.set(t)}))}},{key:"onClickCancel",value:function(){!1!==this.props.noCancel&&g.default.menus.closeModal(p.a.Modals.EnterCode)}},{key:"render",value:function(){var e=this.props,t=e.text,a=e.noCancel,n=e.isPassword;return y.a.createElement(b.a,r()({},this.props,{id:"modalEnterCode",closeButton:!1,width:360,scrollable:!1,modalID:p.a.Modals.EnterCode,backdropClose:!1,ref:"modal"}),y.a.createElement("div",{key:"content"},y.a.createElement("div",{className:"mb16 c-foreground"},t),y.a.createElement(C.a,{ref:"code",type:n&&"password",onEnter:this.onClickConfirm}),y.a.createElement("div",{className:"red",style:{marginTop:8}},this.state.errorText),y.a.createElement("div",{style:{marginTop:24,textAlign:"right"}},!a&&y.a.createElement(k.a,{width:100,onClick:this.onClickCancel},"CANCEL"),y.a.createElement(k.a,{primary:!0,width:100,onClick:this.onClickConfirm},"CONFIRM"))))}}]),a}(E.a);t.default=D},427:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(7),o=a.n(i),l=a(8),s=a.n(l),c=a(17),u=a.n(c),d=a(18),m=a.n(d),h=a(9),f=a.n(h),p=a(0),g=a(1),v=a(4),y=a(31),E=a(3),k=a.n(E),C=a(33),b=a(397),x=a(20),D=a(140),w=a(102);function S(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=f()(e);if(t){var r=f()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return m()(this,a)}}var M=function(e){u()(a,e);var t=S(a);function a(){return o()(this,a),t.apply(this,arguments)}return s()(a,[{key:"init",value:function(){this.refObjects={}}},{key:"getState",value:function(){var e=this.props.importer;return{waitingText:e.waitingText,documents:e.documentsObs,showTryAgain:e.showTryAgain}}},{key:"close",value:function(){y.a.createDefaultState(),v.default.menus.closeModal(g.a.Modals.ImportMoodo)}},{key:"sortCmpDocs",value:function(e,t){return t.date.getTime()-e.date.getTime()}},{key:"onClickTryAgain",value:function(){this.props.tryAgain()}},{key:"onClickCancel",value:function(){this.close()}},{key:"onClickImport",value:function(e,t){var a=this,n=Object.keys(this.refs).filter((function(e){return e.startsWith("checkbox_")&&a.refObjects[e].current.getValue()})).map((function(e){return a.refObjects[e].current.getExtra()}));return this.props.importer.importWithDocuments(n),this.close(),!0}},{key:"createRef",value:function(e){var t=Object(E.createRef)();return this.refObjects[e]=t,t}},{key:"render",value:function(){var e=this,t=this.props.withDocuments,a=this.state,n=a.waitingText,i=a.documents,o=a.showTryAgain,l=!n&&p.default.objectValues(i);return l&&l.sort(this.sortCmpDocs),k.a.createElement(b.a,r()({},this.props,{id:"modalImport",width:400,height:t?600:300,modalID:g.a.Modals.ImportMoodo,ref:"modal"}),k.a.createElement("div",{key:"content"},k.a.createElement("div",{className:"flexbox flexvert",style:{height:"100%"}},k.a.createElement("div",{className:"setupTitle"},"Import from Moo.do"),k.a.createElement(w.a,{className:"importMoodoWrapper f1"},n&&k.a.createElement(k.a.Fragment,null,k.a.createElement("div",{className:"c-foreground-light",dangerouslySetInnerHTML:{__html:n}}),o&&k.a.createElement("div",{className:"center"},k.a.createElement(x.a,{marginTop:24,raised:!0,onClick:this.onClickTryAgain},"Try again"))),!n&&l.map((function(t){var a=t.id;return k.a.createElement(D.a,{key:a,extra:a,ref:e.createRef(a),style:{marginBottom:24}},k.a.createElement("div",{className:"mooDocText bold"},t.text),k.a.createElement("div",{className:"mooDocDate c-foreground-faded"},t.date.toString(v.default.International.getFormat(g.a.DFormat.MonthDayYearLong))))}))),t&&k.a.createElement("div",{style:{marginTop:32,textAlign:"right"}},k.a.createElement(x.a,{raised:!0,onClick:this.onClickCancel},"CANCEL"),k.a.createElement(x.a,{raised:!0,primary:!0,marginLeft:16,enabled:!n,onClick:this.onClickImport},"IMPORT")))))}}]),a}(C.a);t.default=M},428:function(e,t,a){"use strict";a.r(t);var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(0),f=a(4),p=a(3),g=a.n(p),v=a(33),y=a(1),E=a(20),k=a(397);function C(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var b=function(e){s()(a,e);var t=C(a);function a(){return r()(this,a),t.apply(this,arguments)}return o()(a,[{key:"onClickCancel",value:function(){this.props.onCancel(),f.default.menus.closeModal(y.a.Modals.ConfirmEncrypt)}},{key:"onClickDownload",value:function(){h.default.saveFile(this.props.password,"moodo encryption password.txt")}},{key:"onClickYes",value:function(){this.props.onYes(),f.default.menus.closeModal(y.a.Modals.ConfirmEncrypt)}},{key:"render",value:function(){return g.a.createElement(k.a,{id:"modalConfirmEncrypt",closeButton:!1,small:!0,backdropClose:!1,scrollable:!1,modalID:y.a.Modals.ConfirmEncrypt},g.a.createElement("div",{key:"content"},g.a.createElement("p",null,"It is very important that you remember this password."),g.a.createElement("p",{style:{color:"red",fontWeight:"bold"}},"It cannot be reset."),g.a.createElement("p",null,"Are you sure you want to set an encryption password?")),g.a.createElement("div",{key:"buttons"},g.a.createElement(E.a,{raised:!0,cancel:!0,onClick:this.onClickCancel},"Cancel"),g.a.createElement(E.a,{raised:!0,marginLeft:16,onClick:this.onClickDownload},"Download Password"),g.a.createElement(E.a,{raised:!0,primary:!0,marginLeft:16,onClick:this.onClickYes},"Yes")))}}]),a}(v.a);t.default=b},429:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(66),o=a.n(i),l=a(1),s=a(10),c=a(3),u=a.n(c),d=a(397),m=a(21),h=a(403),f=a(208);t.default=Object(m.b)((function(e){var t=e.pane,a=e.item,n=o()(e,["pane","item"]),i=Object(c.useRef)(),m=Object(c.useMemo)((function(){return Math.max(0,t.indexOfItem(a)-4)}),[]);t.setRect(Object.assign({},t.rect.get(),{width:Math.min(Math.round(s.a.windowWidth()*l.a.ModalMaxWidthPerc*.01),800),height:Math.min(Math.round(s.a.windowHeight()*l.a.ModalMaxHeightPerc*.01),900)}));var p=function(){var e=i.current.getElement().getBoundingClientRect();t.setRect(Object.assign({},t.rect.get(),{width:Math.round(e.width),height:Math.round(e.height)}))};return Object(h.a)(s.a.windowSize,p),Object(c.useEffect)((function(){p(),a&&t.type===l.a.PaneMode.Task&&a.highlight()}),[]),u.a.createElement(d.a,r()({},n,{id:"modalPane",width:800,height:900,scrollable:!1,modalID:l.a.Modals.ModalPane,ref:i}),u.a.createElement("div",{key:"content"},u.a.createElement(f.a,{pane:t,isPopup:!0,initialScrollIndex:m})))}))},430:function(e,t,a){"use strict";a.r(t);var n=a(19),r=a.n(n),i=a(0),o=a(1),l=a(4),s=a(10),c=a(21),u=a(3),d=a.n(u),m=a(103),h=a(20),f=a(86);t.default=Object(c.b)((function(){var e=Object(u.useState)(!1),t=r()(e,2),a=t[0],n=t[1],c="https://[*.]accounts.google.com:443";return d.a.createElement("div",{className:"fixed bottom-0 left-0 right-0 flex justify-center pb-4"},d.a.createElement(m.a,{title:"Authentication Error",close:function(){l.default.menus.closeModal(o.a.Modals.ErrorCookies)},width:500,className:"flex flex-col"},d.a.createElement("div",{className:"p-4 text-15 leading-snug"},d.a.createElement("div",{className:"pb-2"},"Moo.do is unable to authenticate wth Google because third party cookies may be disabled in your browser."),d.a.createElement("div",{className:"py-2"},"Please enable third party cookies or add an exception for the following URL and try again:"),d.a.createElement("div",{className:"py-2 flex items-center"},d.a.createElement(f.a,{value:c,readonly:!0,padding:{left:16,right:16}}),d.a.createElement(h.a,{raised:!0,height:30,padding:8,marginLeft:24,onClick:function(){navigator.clipboard.writeText(c),n(!0)}},a?"Copied":"COPY")),d.a.createElement("div",{className:"py-2"},"See this page for how to enable cookies: ",d.a.createElement("a",{href:"https://www.whatismybrowser.com/guides/how-to-enable-cookies/",target:"_blank"},"https://www.whatismybrowser.com/guides/how-to-enable-cookies/")),d.a.createElement("div",{className:"py-2"},"If you prefer not to enable third party cookies for Google, you can download the app."),d.a.createElement("div",{className:"flex justify-center py-2"},d.a.createElement(h.a,{raised:!0,onClick:function(){i.default.openUrl(s.a.getAppDownloadURL())}},"DOWNLOAD")))))}))},431:function(e,t,a){"use strict";a.r(t);var n=a(3),r=a.n(n),i=a(5),o=a(70),l=a(43),s=a(21);t.default=Object(s.b)((function(e){var t=e.item,a=e.pane,n=e.element,s=e.scrollToItem;return r.a.createElement(o.a,{key:"contextMenuOverviewOptions",id:"contextMenuOverviewOptions",element:n},r.a.createElement(l.a,{icon:"icon-zoom-in",onClick:function(){a.canZoomToItem(t)&&(i.a.setFocusedPane(a),a.zoomIn(t))}},"Zoom In"),r.a.createElement(l.a,{icon:"icon-unfold_less",onClick:function(){return s()}},"Scroll to item"),r.a.createElement(l.a,{icon:"icon-add",onClick:function(){a.zoomIn(t),a.addProject()}},"Add subproject"))}))},432:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a(3),i=a.n(r),o=a(70),l=a(43),s=a(95),c=a(21);t.default=Object(c.b)((function(e){var t=e.element,a=e.onSelected,r=function(e){a(e)};return i.a.createElement(o.a,{key:"contextMenuGmailSort",id:"contextMenuGmailSort",element:t},i.a.createElement(s.a,null,"Sort by"),i.a.createElement(l.a,{icon:"icon-access_time",onClick:function(){return r(n.a.GmailViewMode.Date)}},n.a.GmailViewMode.Date),i.a.createElement(l.a,{icon:"icon-exclamation",onClick:function(){return r(n.a.GmailViewMode.Priority)}},n.a.GmailViewMode.Priority))}))},433:function(e,t,a){"use strict";a.r(t);var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(4),f=a(3),p=a.n(f),g=a(33),v=a(20),y=a(140),E=a(70),k=a(95),C=a(43);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var x=function(e){s()(a,e);var t=b(a);function a(){return r()(this,a),t.apply(this,arguments)}return o()(a,[{key:"init",value:function(){this.createObservables({anyCalendarsSync:this.computeAnyCalendarsSync()})}},{key:"getState",value:function(){var e=this.props.pane;return{displayCalendars:e.displayCalendars,displayLocalItems:e.displayLocalItems}}},{key:"getSyncCalendars",value:function(){return h.default.pluginManager.getPluginGCalendar().getImportCalendarList()}},{key:"computeAnyCalendarsSync",value:function(){for(var e=0,t=this.props.pane.displayCalendars.get(),a=this.getSyncCalendars(),n=0,r=0;r<a.length;r++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;!1!==t[a[r].id]&&n++}return n>0}},{key:"onChangeDisplayCalendar",value:function(e,t){var a=this.props.pane;a.setDisplayCalendar(e,t),a.saveState(),this.anyCalendarsSync.set(this.computeAnyCalendarsSync())}},{key:"onChangeDisplayLocal",value:function(e){this.props.pane.setDisplayLocal(e)}},{key:"onChangeAllCalendars",value:function(e){var t=0,a=this.props.pane,n=this.getSyncCalendars(),r=this.state.displayCalendars;h.default.PaneUpdateBatcher.beginUpdateItems();for(var i=0;i<n.length;i++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=n[i];r[o.id]!==e&&a.setDisplayCalendar(o,e)}a.saveState(),h.default.PaneUpdateBatcher.commitUpdateItems()}},{key:"onClickAdd",value:function(){h.default.menus.closeContextMenu(),h.default.menus.openSettings("Calendar")}},{key:"onClickSettings",value:function(){h.default.menus.closeContextMenu(),h.default.menus.openSettings("Plugins")}},{key:"render",value:function(){var e=this,t=this.state,a=this.props,n=h.default.pluginManager.getPluginGCalendar(),r=n.isEnabled(),i=this.getSyncCalendars(),o=t.displayCalendars;return p.a.createElement(E.a,{key:"contextMenuSelectCalendars",id:"contextMenuSelectCalendars",element:a.element},p.a.createElement(C.a,null,p.a.createElement(y.a,{checked:t.displayLocalItems,onChange:this.onChangeDisplayLocal},"Display local events")),r&&p.a.createElement(p.a.Fragment,null,p.a.createElement(k.a,null,p.a.createElement(y.a,{checked:t.anyCalendarsSync,onChange:this.onChangeAllCalendars,size:14},"Google Calendars")),i&&i.map((function(t){var a=n.getCalendarBackgroundColor(t.id);return p.a.createElement(C.a,{key:t.id},p.a.createElement(y.a,{checked:!1!==o[t.id],checkedColor:a,onChange:e.onChangeDisplayCalendar.bind(e,t)},t.summary||t.id))})),(!i||0===i.length)&&p.a.createElement("div",{className:"center",style:{marginTop:8}},p.a.createElement(v.a,{raised:!0,primary:!0,onClick:this.onClickAdd},"ADD CALENDARS"))),!r&&p.a.createElement("div",{className:"center",style:{marginTop:24}},p.a.createElement(v.a,{raised:!0,primary:!0,onClick:this.onClickSettings},"ENABLE CALENDARS")))}}]),a}(g.a);t.default=x},434:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(7),o=a.n(i),l=a(8),s=a.n(l),c=a(17),u=a.n(c),d=a(18),m=a.n(d),h=a(9),f=a.n(h),p=a(1),g=a(4),v=a(3),y=a.n(v),E=a(33),k=a(86),C=a(70),b=a(20);function x(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=f()(e);if(t){var r=f()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return m()(this,a)}}var D=function(e){u()(a,e);var t=x(a);function a(){return o()(this,a),t.apply(this,arguments)}return s()(a,[{key:"init",value:function(){var e=this.props,t=e.text,a=e.href;if(a)this.text=t,this.href=a;else{var n=p.a.Regexp.MDLink,r=new RegExp(/\S{2,}\.[^0-9.\s]{2,}\S*$/);n.lastIndex=0;var i=n.exec(t);i?(this.text=i[2],this.href=i[3]):null===r.exec(t)?this.text=t:this.href=t}this.refText=y.a.createRef(),this.refLink=y.a.createRef()}},{key:"getHotkeys",value:function(){return[g.default.hotkeys.create(p.a.KeyCode.Enter,!0,p.a.Primary.Either,p.a.Shift.Either,this.onClick),g.default.hotkeys.create(p.a.KeyCode.Escape,!0,p.a.Primary.Either,p.a.Shift.Either,this.close)]}},{key:"onMount",value:function(){var e;(e=this.href||!this.text?this.refText.current:this.refLink.current).focus(),e.selectAll()}},{key:"close",value:function(){g.default.menus.closeContextMenu("ReactContextMenuInsertLink")}},{key:"onClickRemove",value:function(){var e=this.refText.current.getValue();this.props.onInsertLink({text:e,href:void 0,isUpdate:!0})}},{key:"onClick",value:function(){var e=this.refText.current.getValue(),t=this.refLink.current.getValue();(e||t)&&g.default.menus.isContextMenuOpen("ReactContextMenuInsertLink")&&(this.close(),this.props.onInsertLink({text:e,href:t,isUpdate:!!this.props.href}))}},{key:"render",value:function(){return y.a.createElement(C.a,r()({},this.props,{key:"contextMenuInsertLink",id:"contextMenuInsertLink"}),y.a.createElement("div",{className:"flexbox"},y.a.createElement("span",null,"Text"),y.a.createElement(k.a,{className:"f1",ref:this.refText,height:28,width:300,maxWidth:300,value:this.text||this.href,onEnter:this.onClick,onEscape:this.close})),y.a.createElement("div",{className:"flexbox"},y.a.createElement("span",null,"URL"),y.a.createElement(k.a,{className:"f1",ref:this.refLink,height:28,width:300,maxWidth:300,value:this.href,onEnter:this.onClick,onEscape:this.close})),y.a.createElement("div",{className:"flexbox",style:{marginTop:16}},this.href&&y.a.createElement(b.a,{cancel:!0,height:32,onClick:this.onClickRemove},"REMOVE"),y.a.createElement("div",{className:"f1"}),y.a.createElement(b.a,{primary:!0,height:32,onClick:this.onClick},this.props.href?"EDIT":"INSERT")))}}]),a}(E.a);t.default=D},435:function(e,t,a){"use strict";a.r(t);var n=a(3),r=a.n(n),i=a(405),o=a(70),l=a(21);t.default=Object(l.b)((function(e){var t=e.contact,a=e.element;return r.a.createElement(o.a,{key:"contextMenuContactDetails",id:"contextMenuContactDetails",element:a},r.a.createElement(i.a,{contact:t}))}))},436:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(19),o=a.n(i),l=a(66),s=a.n(l),c=a(0),u=a(1),d=a(4),m=a(3),h=a.n(m),f=a(10),p=a(406),g=a(70),v=a(21),y=a(24),E=a(403);t.default=Object(v.b)((function(e){var t=e.pane,a=e.note,n=e.item,i=e.selectionStart,l=e.selectionEnd,v=s()(e,["pane","note","item","selectionStart","selectionEnd"]),k=Object(m.useRef)(),C=Object(y.a)(t.rect),b=o()(C,1)[0],x=Object(m.useState)(!1),D=o()(x,2),w=D[0],S=D[1],M=Math.max(b.width-20,400);Object(E.a)(f.a.windowSize,(function(){setTimeout((function(){var e;return null===(e=k.current)||void 0===e?void 0:e.updateState()}),300)}));var N=Object(m.useCallback)((function(e){f.a.getKeyCode(e)!==u.a.KeyCode.Enter||!e.shiftKey||e.altKey||e.ctrlKey||e.metaKey||(d.default.menus.closeContextMenu(),c.default.preventAndStop(e))}),[]),P=Object(m.useCallback)((function(){d.default.menus.closeContextMenu()}),[]),I=Object(m.useCallback)((function(e){S(e),e||requestAnimationFrame((function(){return k.current.updateState()}))}),[]);return h.a.createElement(g.a,r()({},v,{key:a.id+"_Note",id:"contextMenuNote",width:600,height:300,maxWidth:M,ref:k,canMaximize:!0,isMaximized:w,border:!0}),h.a.createElement(p.a,{item:n,focused:!0,onKeyPress:N,selectionStart:i,selectionEnd:l,richText:!0,onMaximize:I,isMaximized:w,onClickClose:P,shouldSave:!0}))}))},437:function(e,t,a){"use strict";a.r(t);var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(1),f=a(3),p=a.n(f),g=a(33),v=a(4),y=a(70);function E(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var k=function(e){s()(a,e);var t=E(a);function a(){return r()(this,a),t.apply(this,arguments)}return o()(a,[{key:"_generateParticipantTextExpanded",value:function(e){return e.text?p.a.createElement("span",null,p.a.createElement("b",null,e.text)," <"+e.email+">"):e.email}},{key:"renderLabels",value:function(){for(var e=0,t=v.default.pluginManager.getPluginGmail(),a=this.props.accountID,n=this.props.message.labelIds,r=[],i=0;i<n.length;i++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var o=t._getLabelByID(a,n[i]);r.push(p.a.createElement("div",{key:i},o.getName()))}return this.renderLine("labels",r)}},{key:"renderParticipants",value:function(e){var t=this.props.message[e].map(function(e,t){return p.a.createElement("div",{key:t},this._generateParticipantTextExpanded(e))}.bind(this));return this.renderLine(e,t)}},{key:"renderLine",value:function(e,t){return p.a.createElement("div",{className:"emailDetailsLine flexbox"},p.a.createElement("div",null,e+":"),p.a.createElement("span",{className:"f1"},t))}},{key:"render",value:function(){var e=this.props.message,t=e.date,a=t.toString(v.default.International.getFormat(h.a.DFormat.DayMonthDateYear))+" at "+t.toString(v.default.International.getFormat(h.a.DFormat.ShortTime));return p.a.createElement(y.a,{key:"contextMenuEmailDetails",id:"contextMenuEmailDetails",element:this.props.element},this.renderLine("from",this._generateParticipantTextExpanded(e.from)),e.to&&this.renderParticipants("to"),e.cc&&this.renderParticipants("cc"),e.bcc&&this.renderParticipants("bcc"),this.renderLine("date",a),this.renderLine("subject",e.subject),e.labelIds&&this.renderLabels())}}]),a}(g.a);t.default=k},438:function(e,t,a){"use strict";a.r(t);var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(1),f=a(0),p=a(10),g=a(3),v=a.n(g),y=a(5),E=a(4),k=a(49),C=a(20),b=a(70),x=a(95),D=a(43),w=a(25),S=a(33),M=a(69),N=a(35);function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var I=function(e){s()(a,e);var t=P(a);function a(){return r()(this,a),t.apply(this,arguments)}return o()(a,[{key:"init",value:function(){var e=this,t=this.props,a=!1;this.mod=p.a.secModKey,this.priMod=p.a.priModKey,this.items=[],this.paneObjects=[],t.pane.applyToSelection((function(n,r,i,o){t.item===n&&(a=!0),e.item||(e.item=n,e.paneObject=o),e.hasSelection=!0,e.items.push(n),e.paneObjects.push(o)})),a||(this.item=void 0,this.hasSelection=!1),this.item||(this.item=t.item,this.paneObject=t.paneObject,this.items=[this.item],this.paneObjects=[this.paneObject],this.hasSelection=!1);try{f.default.PAssert(1013,this.item,"Must have a valid item")}catch(n){f.default.reportError(n)}}},{key:"onClickComplete",value:function(){this.hasSelection?f.default.focusedPane.applyFnToSelection("setComplete",{toggle:"isComplete",value2:h.a.ChangeType.Local}):this.item.setComplete(!this.item.isComplete(),h.a.ChangeType.Local)}},{key:"onClickStar",value:function(){this.hasSelection?f.default.focusedPane.applyFnToSelection("setStarred",{toggle:"isStarred",value2:h.a.ChangeType.Local}):this.item.setStarred(!this.item.isStarred(),h.a.ChangeType.Local)}},{key:"onClickPriority",value:function(e){this.hasSelection?this.props.pane.applyPriorityToSelection(e):this.item.setPriority(e,h.a.ChangeType.Local),E.default.menus.closeContextMenu()}},{key:"onClickIndent",value:function(e){y.a.fireKeyEvent(void 0,{normCode:h.a.KeyCode.Tab,shiftKey:e})}},{key:"onClickMove",value:function(){this.props.pane.autocompleteMove()}},{key:"onClickCreateTask",value:function(){this.props.pane.autocompleteCreateTask()}},{key:"onClickNote",value:function(){this.props.pane.openNoteContextMenuByPaneObject(this.props.paneObject)}},{key:"onClickCollapse",value:function(){this.item.toggleCollapsed(this.props.pane)}},{key:"onClickZoom",value:function(){var e=this.props.pane;e.canZoomToItem(this.item)&&(y.a.setFocusedPane(e),e.zoomIn(this.item))}},{key:"onClickZoomNewPane",value:function(){var e=this.props.pane;if(e.canZoomToItem(this.item)){var t=E.default.PaneManager.getPaneIndex(e)+1,a=e.getSaveInfo();a.item=this.item,a.document=e.getDocument(),delete a.id;var n=M.a.createPane(h.a.PaneMode.Task,a);return E.default.PaneManager.addPaneAtIndex(n,t),y.a.setFocusedPane(n),n.onAdded(),!1}}},{key:"onClickGoto",value:function(){E.default.PaneManager.scrollToAndHighlightItem(this.item,this.props.pane)}},{key:"onClickArchive",value:function(){var e=this.props.pane;e.isWriteable&&(this.hasSelection?e.archiveSelected(!0):this.props.item.archiveSelf(h.a.ChangeType.Local))}},{key:"onClickUnarchive",value:function(){this.item.unArchive(h.a.ChangeType.Local)}},{key:"onClickUndelete",value:function(){this.item.unDelete(h.a.ChangeType.Local)}},{key:"onClickDelete",value:function(){var e=this.item,t=this.props.pane;if(e.isNote())e.parent().setNote(void 0,h.a.ChangeType.Local),E.default.menus.closeContextMenu(),y.a.reset();else if(t.isWriteable)if(t.isViewDates()&&!e.hasAttachmentType(h.a.PluginType.Calendar)&&e.hasChildren()){E.default.menus.options("The item you are deleting has children.",["Remove Date","Delete All"],(function(t){if("Remove Date"===t){e.setMooDate(void 0,h.a.ChangeType.Local,!0);var a=e.getParsedText().replace(h.a.CharDate,"");e.setText(a,h.a.ChangeType.Local)}else"Delete All"===t&&e.deleteSelf(h.a.ChangeType.Local)}))}else this.hasSelection?(k.a.saveDeleteSelection(),t.deleteSelected()):(e.hasAttachmentType(h.a.PluginType.Calendar)&&this.deleteCalendar(),e.deleteSelf(h.a.ChangeType.Local))}},{key:"onClickAddCalendar",value:function(){var e=E.default.pluginManager.getPluginGCalendar(),t=this.item;e&&(e.createEventForItem(t),t.itemChanged.notify())}},{key:"onClickDeleteCalendar",value:function(){var e=0;this.deleteCalendar();for(var t=0;t<this.items.length;t++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var a=this.items[t];a.getDocumentOwner()||a.deleteSelf(h.a.ChangeType.Local)}}},{key:"deleteCalendar",value:function(){for(var e=0,t=this.props.pane,a=0,n=function(e,n){a--,n?0===a&&t.updateItems():E.default.toasts.pushMessage({text:"There was an error removing the event from your Google Calendar.",action:h.a.MessageAction.Okay})},r=0;r<this.items.length;r++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var i=this.items[r];if(i.hasAttachmentType(h.a.PluginType.Calendar)){var o=i.getAttachmentByPlugin(h.a.PluginID.GCalendar);try{f.default.PAssert(1014,o,"Must be able to get a valid attachment")}catch(s){f.default.reportError(s)}try{f.default.PAssert(1015,this.item,"Must have a valid item")}catch(s){f.default.reportError(s)}var l=o.getPlugin();l.hasWritePermissionForAttach(o)?(a++,y.a.reset(),l.deleteCalendarEventForItem(i,o,f.default.newEmptyFn(),f.default.newEmptyFn(),n)):E.default.toasts.pushMessage(h.a.MessageID.ReadOnlyCalendar)}}}},{key:"onClickReply",value:function(){this.hasSelection?this.props.pane.replySelected():this.props.pane.openEmailByItem(this.item,h.a.EmailResponseMode.Reply)}},{key:"onClickReplyAll",value:function(){this.hasSelection?this.props.pane.replyAllSelected():this.props.pane.openEmailByItem(this.item,h.a.EmailResponseMode.ReplyAll)}},{key:"onClickForward",value:function(){this.hasSelection?this.props.pane.forwardSelected():this.props.pane.openEmailByItem(this.item,h.a.EmailResponseMode.Forward)}},{key:"onClickRead",value:function(){var e=this.item,t=e.getAttachmentByType(h.a.PluginType.Email),a=t.getPlugin(),n=a.isItemUnread(e);this.hasSelection?this.props.pane.markReadSelected(n):n?a.performAction(h.a.PluginAction.Gmail.MarkRead,!1,t):a.performAction(h.a.PluginAction.Gmail.MarkUnread,!1,t)}},{key:"onClickStarGmail",value:function(){if(this.hasSelection)this.props.pane.toggleStarSelected();else{var e=this.item.getAttachmentByType(h.a.PluginType.Email),t=e.getPlugin();t.isItemStarred(this.item)?t.performAction(h.a.PluginAction.Gmail.Unstar,!1,e):t.performAction(h.a.PluginAction.Gmail.Star,!1,e)}}},{key:"onClickLabel",value:function(){this.props.pane.autocompleteLabel()}},{key:"onClickSchedule",value:function(){this.props.pane.autocompleteSchedule({item:this.item,element:this.props.element})}},{key:"onClickArchiveGmail",value:function(){var e=this.item,t=e.getAttachmentByType(h.a.PluginType.Email),a=t.getPlugin(),n=a.isItemArchived(e);"PaneGmail"===this.props.pane.type&&this.hasSelection?this.props.pane.archiveSelected(!n):n?a.performAction(h.a.PluginAction.Gmail.Unarchive,!1,t):a.performAction(h.a.PluginAction.Gmail.Archive,!1,t)}},{key:"onClickDeleteGmail",value:function(){var e=this.item,t=this.props.pane,a=e.getAttachmentByType(h.a.PluginType.Email).getPlugin(),n=a.isItemFullTrashed(e);t.type===h.a.PaneMode.Gmail?this.hasSelection?t.deleteSelected(a.isGmailItem,!n):a.isGmailItem(e)&&(this.onClickDeleteCalendar(),e.deleteSelf(h.a.ChangeType.Local)):n?a.undeleteItem(e):a.deleteItem(e)}},{key:"onClickPrefix",value:function(e){y.a.applyPrefixToSelection(e,!this.hasSelection&&this.item),E.default.menus.closeContextMenu()}},{key:"onClickShowMDImageText",value:function(e){this.props.pane.search.clearStickyMatches();var t=this.item.getRawText(),a=e.substr(1);t=t.replace(e,a),this.item.setText(t,h.a.ChangeType.Local)}},{key:"onClickShowDriveImageText",value:function(e){this.props.pane.search.clearStickyMatches();var t=this.item,a=t.getAttachmentByPlugin(h.a.PluginID.Drive);a.getPlugin().setShowInline(t,a,e)}},{key:"onClickMakeLinkImage",value:function(e){var t=0;this.props.pane.search.clearStickyMatches();var a,n,r=this.item.getRawText();for(h.a.Regexp.MDLink.lastIndex=0;null!==(a=h.a.Regexp.MDLink.exec(r));){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;a[3]===e&&(e=a[0],n="!["+a[2]+"]("+a[3]+(a[4]?a[4]:"")+")")}n||(n=e.startsWith("[")?"!"+e:"!["+e+"]("+e+")"),r=r.replace(e,n),this.item.setText(r,h.a.ChangeType.Local)}},{key:"onViewInDrive",value:function(){var e=this.item,t=e.getAttachmentByPlugin(h.a.PluginID.Drive);t.getPlugin().openAttach(t,e,this.props.pane)}},{key:"onClickFixSync",value:function(){f.default.focusedPane.applyToSelection((function(e){var t=e.getDocumentOwner();t.getBacking().saveItem(t,e,e.getFullSaveData(),h.a.ChangeType.Local,h.a.SaveFlag.All)}))}},{key:"renderMenuItemMDImage",value:function(e){var t=e.getAttribute("data-original-text");if(t)return v.a.createElement(v.a.Fragment,null,v.a.createElement(D.a,{onClick:this.onClickShowMDImageText.bind(this,t)},"Show as text"),v.a.createElement("hr",null))}},{key:"renderMenuLink",value:function(e){var t=this,a=this.props,n=a.item,r=a.element,i=a.paneObject,o=e.textContent,l=e.getAttribute("data-href"),s=f.default.isUrlImage(l);return v.a.createElement(v.a.Fragment,null,s&&v.a.createElement(D.a,{onClick:function(){t.onClickMakeLinkImage(l)}},"Show Image"),v.a.createElement(D.a,{onClick:function(){E.default.menus.openContextMenu({componentName:"ReactContextMenuInsertLink",element:r,onInsertLink:n.onInsertLink,text:o,href:l})}},"Edit link"),v.a.createElement(D.a,{onClick:function(){var t=N.default.getChildNodeOffset(e,!0);y.a.selectIndex(i.index,t),n.onInsertLink({text:o,href:void 0,isUpdate:!0})}},"Remove link"),v.a.createElement("hr",null))}},{key:"renderMenuLinkImage",value:function(e){var t=e.getAttribute("data-original-text")||e.getAttribute("data-href")||e.textContent;return v.a.createElement(v.a.Fragment,null,v.a.createElement(D.a,{onClick:this.onClickMakeLinkImage.bind(this,t)},"Show as image"),v.a.createElement("hr",null))}},{key:"renderMenuDate",value:function(){return v.a.createElement("span",null,v.a.createElement(D.a,{icon:"icon-calendar",hotkey:{name:"AddToCalendar"},onClick:this.onClickAddCalendar},"Add to Google Calendar"))}},{key:"renderMenuNote",value:function(){return v.a.createElement("span",null,v.a.createElement(D.a,{icon:"icon-edit",hotkey:{name:"EditNote"},onClick:this.onClickNote},"Edit"),v.a.createElement(D.a,{icon:"icon-delete",onClick:this.onClickDelete,clickCloses:!1},"Delete"))}},{key:"renderMenuDefault",value:function(){var e,t,a=this.props.pane,n=this.item,r=this.priMod,i=a.isViewCalendar(),o=!i,l=a.supportIndent&&!n.isNote()&&0!==n.getIndex()&&!a.isViewFlatList(),s=a.supportIndent&&!n.isNote()&&n.parent()!==f.default.focusedItem&&!a.isViewFlatList(),c=E.default.pluginManager.getPluginGCalendar();if(c&&n.getDate())if(n.hasAttachmentType(h.a.PluginType.Calendar)){var u=n.getAttachmentByType(h.a.PluginType.Calendar);e=v.a.createElement(D.a,{icon:"icon-delete",disabled:!c.hasWritePermissionForAttach(u),onClick:this.onClickDeleteCalendar},"Remove from Google Calendar")}else e=v.a.createElement(D.a,{icon:"icon-calendar",hotkey:o&&{name:"AddToCalendar"},onClick:this.onClickAddCalendar},"Add to Google Calendar");if(n.hasAttachmentType(h.a.PluginType.Email)){var d=n.getAttachmentByType(h.a.PluginType.Email),m=d.getPlugin();if(!d.getPlugin().shouldUseNewPlugin(d)){var p=m.isItemArchived(n),g=m.isItemFullTrashed(n);t=v.a.createElement(v.a.Fragment,null,v.a.createElement("hr",null),v.a.createElement(D.a,{disabled:g,icon:"icon-task",onClick:this.onClickArchiveGmail},"".concat(p?"Unarchive":"Archive"," email")),v.a.createElement(D.a,{icon:"icon-delete",onClick:this.onClickDeleteGmail},"".concat(g?"Undelete":"Delete"," email")))}}return v.a.createElement(v.a.Fragment,null,v.a.createElement(D.a,{icon:"icon-check",hotkey:o&&{name:"Complete"},onClick:this.onClickComplete},n.isComplete()?"Uncomplete":"Complete"),v.a.createElement(D.a,{icon:"icon-zoom-in",hotkey:o&&{name:"ZoomIn"},onClick:this.onClickZoom},"Zoom In"),v.a.createElement(D.a,{icon:"icon-star",hotkey:o&&{name:"Star"},onClick:this.onClickStar},n.isStarred()?"Unstar":"Star"),v.a.createElement(x.a,{hotkey:o&&r+" + #",border:!1},"Priority"),v.a.createElement("div",{className:"horizontalMenu"},v.a.createElement(C.a,{className:"c-border-heavy",id:"itemPriorityHigh",width:24,height:24,tooltipHotkey:o&&{name:"Priority1"},onClick:this.onClickPriority.bind(this,h.a.VMLIFlag.P0)}),v.a.createElement(C.a,{className:"c-border-heavy",id:"itemPriorityMed",width:24,height:24,tooltipHotkey:o&&{name:"Priority2"},onClick:this.onClickPriority.bind(this,h.a.VMLIFlag.P1)}),v.a.createElement(C.a,{className:"c-border-heavy",id:"itemPriorityLow",width:24,height:24,tooltipHotkey:o&&{name:"Priority3"},onClick:this.onClickPriority.bind(this,h.a.VMLIFlag.P2)}),v.a.createElement(C.a,{className:"c-border-heavy",id:"itemPriorityNone",width:24,height:24,tooltipHotkey:o&&{name:"PriorityNone"},onClick:this.onClickPriority.bind(this,h.a.VMLIFlag.None)})),v.a.createElement(x.a,{border:!1},"Item Type"),v.a.createElement("div",{className:"horizontalMenu"},v.a.createElement(C.a,{className:"c-border-heavy",iconSize:14,width:24,height:24,tooltip:"None",onClick:this.onClickPrefix.bind(this,null)}),v.a.createElement(C.a,{className:"c-border-heavy",icon:"icon-project",iconSize:18,width:24,height:24,tooltip:"Project",onClick:this.onClickPrefix.bind(this,h.a.Prefix.Header)}),v.a.createElement(C.a,{className:"c-border-heavy",icon:"icon-check",iconSize:15,width:24,height:24,tooltip:"Task",onClick:this.onClickPrefix.bind(this,h.a.Prefix.Task)}),v.a.createElement(C.a,{className:"c-border-heavy",icon:"icon-bullet",iconSize:22,width:24,height:24,tooltip:"Bullet",onClick:this.onClickPrefix.bind(this,h.a.Prefix.Bullet)}),v.a.createElement(C.a,{className:"c-border-heavy",icon:"icon-numlist",iconSize:13,width:24,height:24,tooltip:"Numbered List",onClick:this.onClickPrefix.bind(this,h.a.Prefix.NumList)})),e&&v.a.createElement(v.a.Fragment,null,v.a.createElement("hr",null),e),v.a.createElement("hr",null),l&&v.a.createElement(D.a,{icon:"icon-format_indent_increase",hotkey:{name:"Indent"},onClick:this.onClickIndent.bind(this,!1)},"Indent"),s&&v.a.createElement(D.a,{icon:"icon-format_indent_decrease",hotkey:{name:"Unindent"},onClick:this.onClickIndent.bind(this,!0)},"Unindent"),!i&&v.a.createElement(D.a,{icon:"icon-align-left",hotkey:{name:"MoveAutocomplete"},onClick:this.onClickMove},"Move"),v.a.createElement("hr",null),!i&&v.a.createElement(D.a,{icon:"icon-sticky-note-o",hotkey:{name:"EditNote"},onClick:this.onClickNote},"Add Note"),v.a.createElement(D.a,{icon:"icon-zoom-in-plus",onClick:this.onClickZoomNewPane},"Open in New Pane"),v.a.createElement(D.a,{icon:"icon-keyboard-tab",hotkey:{name:"Goto"},onClick:this.onClickGoto},"Go to in all panes"),t,v.a.createElement("hr",null),n.getDocumentOwner()&&v.a.createElement(D.a,{icon:"icon-task",onClick:this.onClickArchive},"Archive Item"),v.a.createElement(D.a,{icon:"icon-delete",hotkey:{name:"DeleteItem"},onClick:this.onClickDelete},"Delete"),this.props.showExtra&&v.a.createElement(v.a.Fragment,null,v.a.createElement("hr",null),v.a.createElement(D.a,{icon:"icon-link",onClick:this.onClickFixSync},"Fix Sync")),v.a.createElement(D.a,{className:"mt-2 mb-1 text-xs",hoverEffects:!1,faded:!0,customLayout:!0,style:{lineHeight:1.35}},v.a.createElement("div",{className:"flex"},v.a.createElement("b",{className:"f1"},"Created"),v.a.createElement("div",null,w.a.toHumanText(n.dateCreated))),v.a.createElement("div",{className:"flex"},v.a.createElement("b",{className:"f1"},"Modified"),v.a.createElement("div",null,w.a.toHumanText(n.dateModified))),n.isComplete()&&v.a.createElement("div",{className:"flex"},v.a.createElement("b",{className:"f1"},"Completed"),v.a.createElement("div",null,w.a.toHumanText(n.dateCompleted)))))}},{key:"renderMenuArchived",value:function(){return v.a.createElement(v.a.Fragment,null,v.a.createElement(D.a,{icon:"icon-task",onClick:this.onClickUnarchive},"Unarchive"),v.a.createElement(D.a,{icon:"icon-delete",onClick:this.onClickDelete},"Delete"))}},{key:"renderMenuDeleted",value:function(){return v.a.createElement(v.a.Fragment,null,v.a.createElement(D.a,{icon:"icon-task",onClick:this.onClickUndelete},"Undelete"))}},{key:"renderMenuDrive",value:function(){var e=this.props.pane,t=this.item,a=t.isCollapsed(e,!1),n=e.supportCollapsing&&(t.isHeader()||t.hasChildren()),r=t.isHeader()||t.hasChildren(),i=t.getAttachmentByPlugin(h.a.PluginID.Drive),o=i.getPlugin().isImage(i),l=i.getField("showInline");return v.a.createElement(v.a.Fragment,null,!e.plugin&&o&&v.a.createElement(D.a,{onClick:this.onClickShowDriveImageText.bind(this,!l)},"Show as "+(l?"text":"image")),e.plugin&&v.a.createElement(D.a,{disabled:!n,icon:a?"icon-add":"icon-minus",hotkey:{name:"Collapse"},onClick:this.onClickCollapse},a?"Expand":"Collapse"),e.plugin&&v.a.createElement(D.a,{disabled:!r,icon:"icon-zoom-in",hotkey:{name:"ZoomIn"},onClick:this.onClickZoom},"Zoom In"),v.a.createElement(D.a,{onClick:this.onViewInDrive},"View in Drive"),!e.plugin&&v.a.createElement("hr",null))}},{key:"renderMenuGCalendar",value:function(e){return e.getPlugin().hasWritePermissionForAttach(e)?v.a.createElement(D.a,{icon:"icon-delete",onClick:this.onClickDeleteCalendar},"Remove from Google Calendar"):v.a.createElement(D.a,{icon:"icon-warning"},"Read-Only Event")}},{key:"renderMenuGmail",value:function(e){var t=this.item,a=this.mod,n="PaneGmail"===this.props.pane.type,r=e.getPlugin(),i=r.isItemUnread(t),o=r.isItemStarred(t),l=r.isItemArchived(t),s=r.isItemFullTrashed(t),c=v.a.createElement(v.a.Fragment,null,v.a.createElement(D.a,{icon:"icon-reply",hotkey:n&&{name:"Reply",group:"Email"},onClick:this.onClickReply},"Reply"),v.a.createElement(D.a,{icon:"icon-reply-all",hotkey:n&&{name:"ReplyAll",group:"Email"},onClick:this.onClickReplyAll},"Reply All"),v.a.createElement(D.a,{icon:"icon-forward",hotkey:n&&{name:"Forward",group:"Email"},onClick:this.onClickForward},"Forward"),v.a.createElement("hr",null));return v.a.createElement(v.a.Fragment,null,c,n&&v.a.createElement(v.a.Fragment,null,v.a.createElement(D.a,{icon:i?"icon-drafts":"icon-unread",iconSize:14,hotkey:i?"":{name:"MarkUnread",group:"Email"},onClick:this.onClickRead},i?"Mark as read":"Mark as unread"),v.a.createElement(D.a,{icon:"icon-star",hotkey:{name:"Star",group:n?"Email":"Pane"},onClick:this.onClickStarGmail},o?"Unstar":"Star"),v.a.createElement("hr",null),v.a.createElement(D.a,{className:"mat-subheader",hotkey:a+" + #"},"Priority"),v.a.createElement("div",{id:"contextMenuPriority",className:"horizontalMenu"},v.a.createElement(C.a,{className:"c-border-heavy",id:"itemPriorityNone",onClick:this.onClickPriority.bind(this,h.a.VMLIFlag.None)}),v.a.createElement(C.a,{className:"c-border-heavy",id:"itemPriorityLow",onClick:this.onClickPriority.bind(this,h.a.VMLIFlag.P2)}),v.a.createElement(C.a,{className:"c-border-heavy",id:"itemPriorityMed",onClick:this.onClickPriority.bind(this,h.a.VMLIFlag.P1)}),v.a.createElement(C.a,{className:"c-border-heavy",id:"itemPriorityHigh",onClick:this.onClickPriority.bind(this,h.a.VMLIFlag.P0)})),v.a.createElement("hr",null),v.a.createElement(D.a,{icon:"icon-tag",hotkey:{name:"Label",group:"Email"},onClick:this.onClickLabel},"Label"),v.a.createElement(D.a,{icon:"icon-check",hotkey:{name:"Task",group:"Email"},onClick:this.onClickCreateTask},"Create Task"),v.a.createElement(D.a,{icon:"icon-align-left",hotkey:{name:"Move",group:"Email"},onClick:this.onClickMove},"Add to Outline"),v.a.createElement(D.a,{icon:"icon-calendar",hotkey:{name:"Schedule",group:"Email"},onClick:this.onClickSchedule},"Add To Calendar"),v.a.createElement("hr",null),v.a.createElement(D.a,{disabled:s,icon:"icon-task",hotkey:{name:"Archive",group:"Email"},onClick:this.onClickArchiveGmail},l?"Unarchive":"Archive"),v.a.createElement(D.a,{icon:"icon-delete",hotkey:{name:"Delete",group:"Email"},onClick:this.onClickDeleteGmail},s?"Undelete":"Delete")))}},{key:"render",value:function(){var e,t,a=this.props,n=a.pane,r=this.item,i=a.element,o=f.default.getPluginForElement(i);this.items.length;if(o){var l=f.default.hasClass(o,"plugin_drive")&&h.a.PluginID.Drive||f.default.hasClass(o,"plugin_gmail")&&h.a.PluginID.Gmail||f.default.hasClass(o,"syncedToCalendar")&&h.a.PluginID.GCalendar||"";if(l&&r.hasPluginAttachment(l)){var s=r.getAttachmentByPlugin(l);if(!s.getPlugin().shouldUseNewPlugin(s)){switch(l){case h.a.PluginID.Drive:t=this.renderMenuDrive();break;case h.a.PluginID.GCalendar:t=this.renderMenuGCalendar(r.getAttachmentByPlugin(l));break;case h.a.PluginID.Gmail:t=this.renderMenuGmail(r.getAttachmentByPlugin(l))}n.plugin||(e=t,t=void 0)}}}else if(f.default.hasClass(i,"link"))e=this.renderMenuLink(i);else if(f.default.hasClass(i,"linkImage"))e=this.renderMenuLinkImage(i);else if(f.default.hasClass(i,"mdImage"))e=this.renderMenuItemMDImage(i);else if(f.default.hasClass(i,"driveImage"))e=this.renderMenuDrive();else if(f.default.hasClass(i,"date")){E.default.pluginManager.getPluginGCalendar()&&(t=r.hasAttachmentType(h.a.PluginType.Calendar)?this.renderMenuGCalendar(r.getAttachmentByPlugin(h.a.PluginID.GCalendar)):this.renderMenuDate())}else r.isNote()&&(t=this.renderMenuNote());if(!t){var c=n.getContextMenuMode();switch(c){case"Normal":t=this.renderMenuDefault();break;case"Archived":t=this.renderMenuArchived();break;case"Deleted":t=this.renderMenuDeleted();break;case"Gmail":t=this.renderMenuGmail(r.getAttachmentByPlugin(h.a.PluginID.Gmail));break;case"Drive":t=this.renderMenuDrive();break;default:try{f.default.PAssert(1016,!1,"Unknown context menu mdoe: "+c)}catch(u){f.default.reportError(u)}}}return v.a.createElement(b.a,{id:"contextMenuItem",element:a.element,supportArrows:!0,pos:a.pos,noBackdrop:a.noBackdrop},e,t)}}]),a}(S.a);t.default=I},439:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(7),o=a.n(i),l=a(8),s=a.n(l),c=a(17),u=a.n(c),d=a(18),m=a.n(d),h=a(9),f=a.n(h),p=a(0),g=a(1),v=a(10),y=a(4),E=a(15),k=a(3),C=a.n(k),b=a(33),x=a(154),D=a(70),w=a(43),S=a(20),M=a(25),N=a(29);function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=f()(e);if(t){var r=f()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return m()(this,a)}}var I=function(e){u()(a,e);var t=P(a);function a(){return o()(this,a),t.apply(this,arguments)}return s()(a,[{key:"init",value:function(){this.createObservables({syncTimes:{},isBackingUp:!1,updateMessage:void 0});var e=y.default.pluginManager.getPlugin(g.a.PluginID.Gmail);e.isEnabled()&&this.syncTimes.set(e.getAllLastSyncTimes()),this.listenTo(N.a.onAccountsUpdated)}},{key:"getState",value:function(){var e=E.a.onlineStatus.get(),t={onlineStatus:E.a.onlineStatus,lastSync:y.default.settings.lastSync,lastSyncText:this.getLastSyncText(),lastBackupText:this.getLastBackupText(),isOnline:"Offline"!==e,isConnected:"Online"===e,supportsOffline:"serviceWorker"in navigator,nearQuota:v.a.isNearStorageQuota,hasUnsavedData:!1,cacheRatioWarning:parseFloat(y.default.pluginManager.getCacheSizeRatio())<.6,backupFrequency:y.default.settings.backupFrequency,isBackupEnabled:y.default.settings.isBackupEnabled(),hasUpdate:y.default.AppCache.hasUpdate};return t.hasWarning=t.nearQuota||t.hasUnsavedData||t.cacheRatioWarning||!t.supportsOffline,t}},{key:"getLastSyncText",value:function(){var e=y.default.settings.lastSync.get();return e>0?new Date(e).toString(y.default.International.getFormat(g.a.DFormat.LongDayTime)):"Not synced"}},{key:"getLastBackupText",value:function(){var e,t=x.a.getLastBackup();if(this.isBackingUp.get())e="Backing up...";else if(t>0){var a=new Date(t);e=M.a.toHumanText(a)}else e="Not backed up";return e}},{key:"_handleQuotaOverClick",value:function(){y.default.toasts.pushMessage({text:"Your computer's offline storage quota has been exceeded. Please try freeing space on your device. Offline access will not work.",action:g.a.MessageAction.Okay})}},{key:"_handleQuotaNearClick",value:function(){y.default.toasts.pushMessage({text:"Your computer's offline storage quota is almost exceeded. Please try freeing space on your device, running out will cause offline access to not work.",action:g.a.MessageAction.Okay})}},{key:"_handleUnsavedClick",value:function(){y.default.toasts.pushMessage({text:"Your local changes have been unable to be persisted to disk and have not been saved remotely. You must reconnect to the internet to save them. Free up disk space to prevent this happening.",action:g.a.MessageAction.Okay})}},{key:"_handleRatioClick",value:function(){y.default.toasts.pushMessage({text:"Due to low disk space your cache size was restricted. View your General Settings to reset your cache size.",action:g.a.MessageAction.OpenGeneralSettings})}},{key:"_handleBlockClick",value:function(){}},{key:"_handleCookiesClick",value:function(){}},{key:"onClickBackup",value:function(){var e=this;this.isBackingUp.set(!0),x.a.backupAll().then((function(){return e.isBackingUp.set(!1)}))}},{key:"onClickEnableBackups",value:function(){x.a.enable()}},{key:"onClickCheckUpdates",value:function(e,t){var a=this;this.state.hasUpdate?p.default.reload():y.default.AppCache.update((function(e){a.updateMessage.set(e?"Installing...":"Up to date")}))}},{key:"_handleIconWarningClick",value:function(e){N.a.authAccount(e,y.default.pluginManager.getPlugin(g.a.PluginID.Gmail).googleScopes(),p.default.emptyFn)}},{key:"componentDidUpdate",value:function(){this.refs.menu.updateState()}},{key:"_renderAccounts",value:function(){var e,t,a,n,r=this.state,i=[];for(var o in r.syncTimes)if(r.syncTimes.hasOwnProperty(o)){var l=r.syncTimes[o];if(e=void 0,t=void 0,a=void 0,n=l?o+": "+l.toString(y.default.International.getFormat(g.a.DFormat.ShortDayTime)):o+": Not synced",N.a.isLoaded){var s=N.a.getError(o);if(s)e="icon-warning",t=s,a=this._handleIconWarningClick.bind(this,o);else y.default.pluginManager.getPlugin(g.a.PluginID.Gmail).verifyAuthorization(o)||(e="icon-warning",t="Missing authorization",a=this._handleIconWarningClick.bind(this,o))}i.push(C.a.createElement(w.a,{key:o,icon:e,iconTooltip:t,onClickIcon:a},n))}return i.length>0&&C.a.createElement(C.a.Fragment,null,C.a.createElement("hr",null),C.a.createElement(w.a,{className:"onlineStatusHeader"},"Email accounts"),i)}},{key:"render",value:function(){var e=this.state,t=+g.a.jsVersion,a="".concat(t,": ").concat(new Date(t).toString("MMMM d, h:mm tt")),n=this._renderAccounts();return C.a.createElement(D.a,r()({},this.props,{ref:"menu",minWidth:250,key:"contextMenuOnlineStatus",id:"contextMenuOnlineStatus",element:this.props.element}),C.a.createElement(w.a,{className:"onlineStatusHeader"},"Last Sync"),C.a.createElement(w.a,null,e.lastSyncText),C.a.createElement("hr",null),C.a.createElement(w.a,{className:"onlineStatusHeader",height:36},"Last Backup",C.a.createElement(S.a,{primary:!0,onClick:this.onClickBackup},"Backup now")),C.a.createElement(w.a,null,e.lastBackupText),e.hasWarning&&C.a.createElement("div",null,C.a.createElement("hr",null),C.a.createElement(w.a,{className:"onlineStatusHeader"},"Warnings"),!e.supportsOffline&&C.a.createElement(w.a,{clickCloses:!1,tooltip:"Learn More"},"Your browser does not support offline access"),e.nearQuota&&C.a.createElement(w.a,{clickCloses:!1,tooltip:"Learn More",onClick:this._handleQuotaNearClick},"Nearly out of disk space"),e.hasUnsavedData&&C.a.createElement(w.a,{clickCloses:!1,tooltip:"Learn More",onClick:this._handleUnsavedClick},"Unsaved changes will be lost"),e.cacheRatioWarning&&C.a.createElement(w.a,{clickCloses:!1,tooltip:"Learn More",onClick:this._handleRatioClick},"Your data is not efficiently being cached")),n,C.a.createElement("hr",null),C.a.createElement(w.a,{className:"onlineStatusHeader",height:36},"App version",e.updateMessage&&!e.hasUpdate?C.a.createElement("div",{style:{paddingLeft:48}},e.updateMessage):C.a.createElement(S.a,{primary:!0,onClick:this.onClickCheckUpdates},e.hasUpdate?"Update":"Check for updates")),v.a.isBeta&&C.a.createElement(w.a,null,"Beta"),C.a.createElement(w.a,null,a))}}]),a}(b.a);t.default=I},440:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(3),o=a.n(i),l=a(401),s=a(70),c=a(21);t.default=Object(c.b)((function(e){return o.a.createElement(s.a,r()({},e,{key:"contextMenuHeart",id:"contextMenuHeart",element:e.element}),o.a.createElement(l.a,null))}))},441:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(7),o=a.n(i),l=a(8),s=a.n(l),c=a(17),u=a.n(c),d=a(18),m=a.n(d),h=a(9),f=a.n(h),p=a(0),g=a(1),v=a(4),y=a(39),E=a(10),k=a(209),C=a(3),b=a.n(C),x=a(33),D=a(70),w=a(43);function S(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=f()(e);if(t){var r=f()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return m()(this,a)}}var M=function(e){u()(a,e);var t=S(a);function a(){return o()(this,a),t.apply(this,arguments)}return s()(a,[{key:"onClickSettings",value:function(){v.default.menus.openSettings()}},{key:"onClickDisplaySettings",value:function(){v.default.menus.openDisplaySettings()}},{key:"onClickImport",value:function(){v.default.menus.openModal(g.a.Modals.ImportData)}},{key:"onClickExport",value:function(){v.default.menus.openModal(g.a.Modals.ExportData)}},{key:"onClickRevision",value:function(){v.default.menus.openModal(g.a.Modals.Backups)}},{key:"onClickFeedback",value:function(){v.default.menus.openModal(g.a.Modals.ReportBug)}},{key:"onClickBlog",value:function(){p.default.openUrl("https://www.moo.do/blog/")}},{key:"onClickLogout",value:function(){v.default.setup.logoutClicked()}},{key:"onClickShare",value:function(){v.default.menus.openContextMenu({componentName:"ReactContextMenuShare",element:this.props.element})}},{key:"onClickDownloadApp",value:function(){p.default.openUrl(E.a.getAppDownloadURL())}},{key:"onClickTrial",value:function(){v.default.menus.openSettings("Account")}},{key:"onClickHelp",value:function(){v.default.intro.showHelp()}},{key:"onClickHotkeys",value:function(){v.default.intro.showHotkeys()}},{key:"onClickImportMoodo",value:function(){(new k.a).authAndImportDocuments()}},{key:"render",value:function(){var e=v.default.billingManager,t=y.a.getAccountName(),a=e.isTrialState()&&!v.default.settings.trialOverHidden.get(),n=e.isTrialOver(),i=!p.default.isDemoMode(),o=e.daysLeftInTrial.get();return b.a.createElement(D.a,r()({},this.props,{key:"contextMenuOptions",id:"contextMenuOptions",supportArrows:!0}),b.a.createElement(w.a,{onClick:this.onClickSettings},"Settings"),b.a.createElement(w.a,{onClick:this.onClickDisplaySettings},"Display Settings"),b.a.createElement("hr",null),b.a.createElement(w.a,{onClick:this.onClickHelp},"Help"),b.a.createElement(w.a,{onClick:this.onClickHotkeys},"Hotkeys"),i&&b.a.createElement("hr",null),i&&b.a.createElement(w.a,{onClick:this.onClickImport},"Import Data"),i&&b.a.createElement(w.a,{onClick:this.onClickExport},"Export Data"),i&&b.a.createElement(w.a,{onClick:this.onClickRevision},"Revision History"),i&&b.a.createElement(w.a,{onClick:this.onClickImportMoodo},"Import old Moo.do"),b.a.createElement("hr",null),i&&b.a.createElement(w.a,{onClick:this.onClickFeedback},"Contact Support"),b.a.createElement(w.a,{onClick:this.onClickBlog},"Moo.do Blog"),b.a.createElement(w.a,{onClick:this.onClickShare},"Share Moo.do"),E.a.canDownloadNativeApp()&&b.a.createElement(w.a,{onClick:this.onClickDownloadApp},"Get "+E.a.getPlatformName()+" app"),b.a.createElement("hr",null),a&&b.a.createElement(w.a,{className:n?"error":"",onClick:this.onClickTrial},n?"Trial over":"Trial: "+o+" days"),b.a.createElement(w.a,{onClick:this.onClickLogout},"Logout"),b.a.createElement(w.a,{className:"username",faded:!0,hoverEffects:!1},t),b.a.createElement(w.a,{className:"useremail",faded:!0,hoverEffects:!1},v.default.settings.getUserIdentifier()))}}]),a}(x.a);t.default=M},442:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(7),o=a.n(i),l=a(8),s=a.n(l),c=a(17),u=a.n(c),d=a(18),m=a.n(d),h=a(9),f=a.n(h),p=a(1),g=a(4),v=a(3),y=a.n(v),E=a(33),k=a(70),C=a(20);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=f()(e);if(t){var r=f()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return m()(this,a)}}var x=function(e){u()(a,e);var t=b(a);function a(){return o()(this,a),t.apply(this,arguments)}return s()(a,[{key:"onClickUpsell",value:function(){var e=!g.default.billingManager.isTrialOver();g.default.menus.closeContextMenu(),e?g.default.billingManager.startTrial():g.default.menus.openSettings("Account")}},{key:"render",value:function(){var e=this.props,t=!g.default.billingManager.isTrialOver();return y.a.createElement(k.a,r()({},e,{id:"contextMenuBoardsUpsell"}),y.a.createElement("div",null,y.a.createElement("div",null,e.premiumMessage),y.a.createElement("br",null),t&&y.a.createElement("div",null,"Start your "+p.a.TrialDuration+" day free trial to enable "+e.enableMessage+"."),!t&&y.a.createElement("div",null,"Go Premium to enable "+e.enableMessage+".")),y.a.createElement("br",null),y.a.createElement("div",{className:"center"},y.a.createElement(C.a,{primary:!0,raised:!0,onClick:this.onClickUpsell},t?"Start Trial":"Go Premium")))}}]),a}(E.a);t.default=x},443:function(e,t,a){"use strict";a.r(t);var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(0),f=a(1),p=a(4),g=a(3),v=a.n(g),y=a(33),E=a(70),k=a(86),C=a(5);function b(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var x=function(e){s()(a,e);var t=b(a);function a(){return r()(this,a),t.apply(this,arguments)}return o()(a,[{key:"init",value:function(){var e=p.default.pluginManager.getPlugin(f.a.PluginID.Drive);this.createObservables({isHovered:!1,isDriveEnabled:e.isEnabled()}),this.refMenu=v.a.createRef(),this.refPicker=v.a.createRef(),this.refInputUrl=v.a.createRef()}},{key:"doUpload",value:function(e){for(var t=0,a=p.default.pluginManager.getPluginDrive(),n=0;n<e.length;n++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;a.handleDropFile(e[n],this.props.pane,void 0,this.onUploadComplete.bind(this,0===n))}this.refMenu.current.close()}},{key:"onUploadComplete",value:function(e,t){var a=this.props,n=a.item,r=a.itemParent,i=a.pane,o=isNaN(a.insertIndex)?a.paneObject.index+1:a.insertIndex;if(e&&n)n.setText(t,f.a.ChangeType.Local);else{var l=r||n.parent(),s=i.createVMLI({text:t},{parent:l,changeType:f.a.ChangeType.AllLocal});l.insertItem(s,o)}return n}},{key:"onChangeFile",value:function(e){return e.target.files&&e.target.files.length>0&&this.doUpload(e.target.files),!1}},{key:"onDragEnter",value:function(){this.isHovered.set(!0)}},{key:"onDragLeave",value:function(){this.isHovered.set(!1)}},{key:"onDrop",value:function(e){var t=e.dataTransfer;t.files&&t.files.length>0&&this.doUpload(t.files)}},{key:"onClickEnableDrive",value:function(){this.refMenu.current.close(),p.default.menus.openSettings("Plugins")}},{key:"onClick",value:function(){this.refPicker.current.click()}},{key:"onClickAddUrl",value:function(){this.refMenu.current.close();var e=this.props,t=this.refInputUrl.current.getValue();if(e.pane.setIgnoreRestoreScroll(),this.props.item)C.a.selectIndex(this.props.paneObject.index,0,0),this.props.item.onInsertLink({href:t},p.default.settings.showImagesInline.get());else{var a=e.itemParent,n=e.pane.createVMLI({text:p.default.settings.getDefaultItemText()},{parent:a,changeType:f.a.ChangeType.AllLocal});a.insertItem(n,e.insertIndex),C.a.selectIndex(e.insertIndex,n.getParsedText().length),n.onInsertLink({href:t},p.default.settings.showImagesInline.get())}}},{key:"render",value:function(){var e=this.props,t=this.state,a=this.state.isHovered,n=e.image,r=h.default.classNames("uploadDropZone",{"hovered c-bg-light":a}),i=n?"image":"file";return v.a.createElement(E.a,{key:"contextMenuDropZone",id:"contextMenuDropZone",name:"ReactContextMenuDropZone",element:e.element,pos:e.pos,ref:this.refMenu},n&&v.a.createElement(k.a,{focused:!0,placeholder:"Enter an image address",height:32,buttonText:"ADD",onButtonClick:this.onClickAddUrl,ref:this.refInputUrl}),n&&v.a.createElement("div",{className:"dropOr center c-foreground-faded"},"or"),t.isDriveEnabled&&v.a.createElement("div",{className:r,onClick:this.onClick,onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDrop:this.onDrop},(a?"Drop file(s)":"Drag files here or click")+" to add "+i+".",v.a.createElement("input",{type:"file",ref:this.refPicker,className:"hidden",multiple:!0,onChange:this.onChangeFile})),!t.isDriveEnabled&&v.a.createElement("div",{className:r,onClick:this.onClickEnableDrive},"Enable the Google Drive plugin to upload files"))}}]),a}(y.a);t.default=x},444:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(7),o=a.n(i),l=a(8),s=a.n(l),c=a(17),u=a.n(c),d=a(18),m=a.n(d),h=a(9),f=a.n(h),p=a(1),g=a(0),v=a(3),y=a(396),E=(a(395),a(4)),k=a(181),C=a(25),b=a(59),x=a(33),D=a(20),w=a(140),S=a(70),M=a(86),N=0;function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=f()(e);if(t){var r=f()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return m()(this,a)}}for(var I=Object(y.c)(y.a),T=["All day"],A=0;A<24;A++){if(N++>5e3&&__infLoop&&__infLoop(N))throw new RangeError;var R=A%12===0?"12":A>12?A-12:A,O=A>=12?"pm":"am";T.push(R+":00 "+O),T.push(R+":30 "+O)}var L=function(e){u()(a,e);var t=P(a);function a(){return o()(this,a),t.apply(this,arguments)}return s()(a,[{key:"init",value:function(){var e;this.refInput=v.createRef(),this.refTimes=v.createRef(),this.mooDate=null===(e=this.props.item)||void 0===e?void 0:e.getMooDate();var t=E.default.pluginManager.getPluginGCalendar();if(t.isEnabled()&&!this.mooDate&&t.getSetting("syncPopup")&&(this.pendingCalendarID=t.getDefaultExportCalendarID()),this.createObservables({selectedDate:{start:void 0,end:void 0},selectedTimes:[],text:void 0}),this.updateText(),this.textOffset=this.props.textOffset,void 0===this.textOffset&&this.props.item){var a=this.props.item.getParsedText(),n=a.indexOf(p.a.CharDate);this.textOffset=n>=0?n:a.length}}},{key:"onMount",value:function(){this.updateDateTime(),E.default.onIntroAction("Date")}},{key:"onUnmount",value:function(){g.default.clearTimeoutOnce("ctxMenuDateUpdateDate");var e=this.props,t=e.onSelect,a=e.onUnmount,n=this.mooDate;this.setMooDateOnItem(n),n&&t&&t(n.getDate()),a&&a()}},{key:"setMooDate",value:function(e){this.mooDate=e,g.default.timeoutOnce("ctxMenuDateUpdateDate",this._onInputChangeTimeout,200)}},{key:"setMooDateOnItem",value:function(e){var t=this.props,a=t.paneObject,n=t.item;if(n){var r=this.textOffset,i=a?a.getDisplayText():n.getDisplayText(!1);if(n.setMooDate(e,p.a.ChangeType.Local,(null===e||void 0===e?void 0:e.duration)?["duration"]:[]),e&&void 0!==r&&n.getRawText().indexOf(p.a.CharDate)<0){var o=r,l=0,s="";i[r-1]&&i[r-1]!==p.a.PrefixDate&&" "!==i[o]&&(s=" "),i[r-1]===p.a.PrefixDate&&(o--,l++);var c=a||{item:n,showMarkdown:function(){return E.default.settings.showMarkdown.get()}},u=n.elsNew.spliceText(s+p.a.CharDate+" ",o,l,c);if(u[r-1]===p.a.PrefixDate&&(u=g.default.stringRemove(u,o-1,1)),n.setText(u,p.a.ChangeType.Local),this.pendingCalendarID)E.default.pluginManager.getPluginGCalendar().setCalendarForItem(n,this.pendingCalendarID),delete this.pendingCalendarID}}}},{key:"_onInputChangeTimeout",value:function(){this.setMooDateOnItem(this.mooDate)}},{key:"getMooDateOnItem",value:function(){var e=this.props.item;return null===e||void 0===e?void 0:e.getMooDate()}},{key:"onInputChange",value:function(e){if(e){var t=C.a.parseText(e);this.setMooDate(t)}else this.setMooDate(void 0);this.updateDateTime(),this.text.set(e)}},{key:"onClickClearDate",value:function(){this.onInputChange("")}},{key:"onClickSave",value:function(){E.default.menus.closeContextMenu("ReactContextMenuDate")}},{key:"updateDateTime",value:function(){var e=this.mooDate;if(e){var t=e.getTime();if(t){var a=0;t=Math.round(t/36e4);for(var n=2*Math.floor(t/10)+(t%10>0?1:0),r=e.getDuration()/(30*p.a.MSPerMinute)||2,i=[],o=n;o<n+r;o++){if(a++>5e3&&__infLoop&&__infLoop(a))throw new RangeError;i.push(o+1)}this.selectedTimes.set(i),this.refTimes.current&&(this.refTimes.current.scrollTop=28*(n-3))}else this.selectedTimes.set([]);if(e.isRange()){var l=e.getStart(),s=e.getEnd();l||(l=new Date),s||(s=new Date(l).addMonths(3)),this.selectedDate.set({start:l,end:s})}else this.selectedDate.set(e.getAllDates())}else this.selectedDate.set(void 0)}},{key:"onMouseDownTime",value:function(e){this._mouseDownOnTime=e,this.selectedTimes.set([e]);var t=this.mooDate;if(t||(t=b.a.now(),this.setMooDate(t)),0===e)t.clearTime(),t.setDuration(void 0);else{var a=e-1;t.setHours(a/2),t.setDuration(30*p.a.MSPerMinute)}this.updateText(),document.addEventListener("mouseup",this.onMouseUpTime)}},{key:"onMouseMoveTime",value:function(e){if(void 0!==this._mouseDownOnTime){var t,a,n=0,r=this.selectedTimes.get();e<=this._mouseDownOnTime?(t=e,a=this._mouseDownOnTime):(t=this._mouseDownOnTime,a=e),r=[];for(var i=t;i<=a;i++){if(n++>5e3&&__infLoop&&__infLoop(n))throw new RangeError;r.push(i)}this.duration=r.length>0?30*r.length*p.a.MSPerMinute:void 0,this.mooDate.setDuration(this.duration),this.updateText(),this.selectedTimes.set(r)}}},{key:"onMouseUpTime",value:function(){this._mouseDownOnTime=void 0,document.removeEventListener("mouseup",this.onMouseUpTime)}},{key:"onSelectDate",value:function(e){var t;this.selectedDate.set(e);var a=null===(t=this.mooDate)||void 0===t?void 0:t.getTime(),n=a?a/p.a.MSPerHour:0;this.setMooDate(e.start&&e.end?b.a.fromRange(e.start,e.end,n):void 0),this.updateText()}},{key:"onChangeRepeatComplete",value:function(e){var t=this.mooDate;if(t){var a=this.props.item;t.setRepeatOnComplete(e),a.onMooDateUpdated(p.a.ChangeType.Local)}}},{key:"onInputEnter",value:function(){E.default.menus.closeContextMenu("ReactContextMenuDate")}},{key:"updateText",value:function(){var e=this.mooDate;this.text.set(e?e.toText():""),this.refInput.current&&this.refInput.current.selectEnd()}},{key:"onChangeCalendar",value:function(e){var t=this.props.item,a=E.default.pluginManager.getPluginGCalendar();t.getMooDate()?a.setCalendarForItem(t,e):this.pendingCalendarID=e}},{key:"renderCalendarSelector",value:function(){var e=this.props.item,t=E.default.pluginManager.getPluginGCalendar(),a=e.hasPluginAttachment(p.a.PluginID.GCalendar),n=t.getWriteableCalendarsForItem(e),r=n.calendars,i=n.selected;return this.pendingCalendarID&&(i=this.pendingCalendarID),r?v.createElement(k.a,{defaultValue:i,style:{height:26,marginTop:2},ref:this.refSelectCalendar,onChange:this.onChangeCalendar,noPadding:!0},v.createElement("option",{value:""},(a?"Remove from":"Add to")+" calendar"),r.map((function(e){return v.createElement("option",{key:e.id,value:e.id},e.summary)}))):void 0}},{key:"render",value:function(){var e=this,t=this.state,a=t.text,n=t.selectedTimes,i=t.selectedDate,o=this.props.item,l=this.mooDate,s=l&&l.repeatComplete||!1,c=T.map((function(t,a){var r=n.indexOf(a)>=0,i=g.default.classNames({"c-popup-item":!r},{selected:r});return v.createElement("div",{key:t,className:i,onMouseDown:e.onMouseDownTime.bind(e,a),onMouseMove:e.onMouseMoveTime.bind(e,a)},t)}));return v.createElement(S.a,r()({},this.props,{id:"contextMenuDate",width:352,maxHeight:1800}),v.createElement("div",{className:"flexbox"},v.createElement(M.a,{className:"f1",placeholder:"Type or select a date",onChange:this.onInputChange,onEnter:this.onInputEnter,value:a,focused:!0,border:!1,ref:this.refInput}),o&&v.createElement(D.a,{height:40,onClick:this.onClickClearDate},"Clear"),!o&&v.createElement(D.a,{height:40,onClick:this.onInputEnter},"Save")),o&&v.createElement("div",{className:"flexbox",style:{padding:"0 8px"}},v.createElement(w.a,{className:"f1",initialChecked:s,onChange:this.onChangeRepeatComplete},"Repeat from completion"),this.renderCalendarSelector()),v.createElement("div",{className:"calendarContainer flexbox c-border-heavy",style:{width:352,height:200}},v.createElement(y.b,{Component:I,autoFocus:!1,width:252,height:200,rowHeight:36,selected:i,onSelect:this.onSelectDate,locale:{weekStartsOn:E.default.settings.dayWeekStart.get()},displayOptions:{showHeader:!1,showOverlay:!1}}),v.createElement("div",{className:"times c-border-heavy scrollable f1",ref:this.refTimes},c)))}}]),a}(x.a);t.default=L},445:function(e,t,a){"use strict";a.r(t);var n=a(7),r=a.n(n),i=a(8),o=a.n(i),l=a(17),s=a.n(l),c=a(18),u=a.n(c),d=a(9),m=a.n(d),h=a(3),f=a(33),p=a(20),g=a(86),v=a(70);function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=m()(e);if(t){var r=m()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return u()(this,a)}}var E=function(e){s()(a,e);var t=y(a);function a(){return r()(this,a),t.apply(this,arguments)}return o()(a,[{key:"init",value:function(){}},{key:"onClickSavePassword",value:function(){this.refs.pass1.getValue(),this.refs.pass2.getValue()}},{key:"render",value:function(){var e=this.props,t={marginTop:8,width:240};return h.createElement(v.a,{key:"contextMenuDocumentPassword",id:"contextMenuDocumentPassword",className:"padded",element:e.element},h.createElement("div",{className:"bold"},"Enter a password"),h.createElement("div",null,h.createElement(g.a,{type:"password",placeholder:"Password",ref:"pass1",style:t,onEnter:this.onClickSavePassword}),h.createElement(g.a,{type:"password",placeholder:"Confirm Password",ref:"pass2",style:t,onEnter:this.onClickSavePassword})),h.createElement("div",{style:{marginTop:8}},h.createElement(p.a,{raised:!0,primary:!0,onClick:this.onClickSavePassword},"Save")))}}]),a}(f.a);t.default=E},446:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(6),o=a.n(i),l=a(13),s=a.n(l),c=a(7),u=a.n(c),d=a(8),m=a.n(d),h=a(17),f=a.n(h),p=a(18),g=a.n(p),v=a(9),y=a.n(v),E=a(1),k=a(10),C=a(3),b=(a(395),a(5)),x=a(4),D=a(58),w=a(33),S=a(72),M=a(106),N=a(70),P=a(43);function I(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=y()(e);if(t){var r=y()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return g()(this,a)}}var T=function(e){f()(a,e);var t=I(a);function a(){return u()(this,a),t.apply(this,arguments)}return m()(a,[{key:"init",value:function(){this.refMenu=C.createRef()}},{key:"onClickLink",value:function(){var e=this.props.paneObject;x.default.menus.openContextMenu({componentName:"ReactContextMenuInsertLink",element:this.props.element,onInsertLink:function(t){var a=t.text,n=t.href;e.item.elsNew=new M.a([new S.a(a,{link:{href:n,text:a}})]),e.item.setTextFromEls(E.a.ChangeType.Local),b.a.selectIndex(e.index,-1)}})}},{key:"onClickFile",value:function(e){var t=this.props.paneObject;x.default.menus.openContextMenu({componentName:"ReactContextMenuDropZone",element:this.props.element,pane:t.pane,item:t.item,image:e,paneObject:t})}},{key:"onClickPicker",value:function(){var e=s()(o.a.mark((function e(){var t,a;return o.a.wrap((function(e){for(var n=0;;){if(n++>5e3&&__infLoop&&__infLoop(n))throw new RangeError;switch(e.prev=e.next){case 0:return t=this.props.paneObject.item,a=x.default.pluginManager.getPluginDrive(),e.next=4,a.pickFilesFromDrive();case 4:e.sent.forEach((function(e,a){if(0===a)t.setText(e,E.a.ChangeType.Local);else{var n=t.parent(),r=n.getIndexOf(t.id);t=b.a.getPane().createVMLI({text:e},{parent:n,changeType:E.a.ChangeType.AllLocal}),n.insertItem(t,r+1,!1)}}));case 6:case"end":return e.stop()}}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"insert",value:function(e,t){if("string"===typeof e){var a=this.props.paneObject;a.item.setText(e,E.a.ChangeType.Local),b.a.selectIndex(a.index,-1),t&&D.a.updateFromPane({owner:a,index:a.index,start:b.a.getStartOffset(),element:b.a.getStartElement(),forceShow:!0})}else e()}},{key:"renderItem",value:function(e,t,a,n,r,i,o){var l="icon-bullet"===e?26:void 0;return C.createElement(P.a,{icon:e,iconSize:l,onClick:i||this.insert.bind(this,n,r),height:36,iconColor:o},C.createElement("div",{className:"f1"},t),a&&C.createElement("div",{className:"hHotkey c-bg-light"},a))}},{key:"render",value:function(){var e=x.default.pluginManager.isDriveEnabled();return C.createElement(N.a,r()({},this.props,{id:"contextMenuSlashHelp",supportArrows:!0,ref:this.refMenu}),this.renderItem("icon-project","Project","# + Space","# "),this.renderItem("prefixTask","Task","[ + Space","[ "),this.renderItem("icon-bullet","Bullet","".concat(E.a.Prefix.Bullet," Space"),"".concat(E.a.Prefix.Bullet," ")),this.renderItem("icon-numlist","Numbered List","1. + Space","1. "),this.renderItem("icon-hash","Tag","#tag","#",!0),this.renderItem("icon-user","Contact","+Name","+",!0),this.renderItem("icon-calendar","Date or reminder","!","!",!0),this.renderItem("icon-hr","Line","---","---"),this.renderItem("icon-hr-heavy","Heavy Line","===","===",void 0,void 0,"c-foreground"),this.renderItem("icon-link","Link",k.a.priModKey+" + K",this.onClickLink),this.renderItem("icon-moodo","Link to item","[[","[[",!0),e&&this.renderItem("icon-drive-file","Upload File",void 0,this.onClickFile.bind(this,!1)),e&&this.renderItem("icon-image","Upload Image",void 0,this.onClickFile.bind(this,!0)),e&&this.renderItem("icon-drive-file","Choose Drive File",void 0,this.onClickPicker))}}]),a}(w.a);t.default=T},447:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a(3),i=a.n(r),o=a(70),l=a(30),s=a(21),c=a(43);t.default=Object(s.b)((function(e){var t=e.pane,a=e.element,r=l.a.getSelectedItems(t),s=!0,u=!0;r.forEach((function(e){s=s&&e.isComplete.get(),u=u&&e.isRead.get()}));var d=function(e){l.a.forEach(t,(function(t){return e(t)}))};return i.a.createElement(o.a,{key:"contextMenuInboxItem",element:a},i.a.createElement(c.a,{icon:"icon-check",iconSize:14,hotkey:{name:"Complete",group:"Inbox"},onClick:function(){d((function(e){return e.setComplete(!s,Date.now(),n.a.ChangeType.Local)}))}},s?"Uncomplete":"Complete"),i.a.createElement(c.a,{icon:u?"icon-unread":"icon-drafts",iconSize:14,hotkey:{name:u?"MarkUnread":"MarkRead",group:"Inbox"},onClick:function(){d((function(e){return e.setRead(!u,n.a.ChangeType.Local)}))}},u?"Mark as unread":"Mark as read"),i.a.createElement(c.a,{icon:"icon-align-left",hotkey:{name:"CopyToItem",group:"Inbox"},onClick:function(){d((function(e){return t.autocompleteCopy()}))}},"Copy to Item"),i.a.createElement(c.a,{icon:"icon-add",hotkey:{name:"CopyToNewItem",group:"Inbox"},onClick:function(){d((function(e){return t.autocompleteCreateTask()}))}},"Copy to New Item"))}))},449:function(e,t,a){"use strict";a.r(t);var n=a(19),r=a.n(n),i=a(0),o=a(1),l=a(4),s=a(10),c=a(3),u=a.n(c),d=a(75),m=a(401),h=a(7),f=a.n(h),p=a(8),g=a.n(p),v=a(17),y=a.n(v),E=a(18),k=a.n(E),C=a(9),b=a.n(C),x=a(38),D=a.n(x),w=a(33),S=a(20),M=a(48),N=a(21),P=a(24),I=a(14),T=a(409),A=a.n(T),R=Object(N.b)((function(e){var t,a=e.title,n=e.description,l=e.checkedObservable,s=e.disabled,c=e.onChange,d=e.getCheckedFromObservable,m=e.getValueFromChecked;var h=Object(P.a)(l),f=r()(h,1)[0],p=null!==(t=null===d||void 0===d?void 0:d(f))&&void 0!==t?t:f,g=function(e){var t;return l.set(null!==(t=null===m||void 0===m?void 0:m(e))&&void 0!==t?t:e)},v=i.default.classNames("cursor-pointer py-4"),y=i.default.classNames("relative flex items-center cursor-pointer c-button-raised-primary c-shadow-thin borderBox",p?"justify-end":"justify-start",A.a.toggleOuter),E=i.default.classNames("c-background c-shadow-light",A.a.toggleInner),k={backgroundColor:p?o.a.ColorBrand:"#888"};return u.a.createElement("div",{className:v,onClick:function(){if(!s){var e=!p;g(e),c&&!1===c(e)&&g(!e)}}},u.a.createElement("div",{className:"flex"},u.a.createElement(M.b.div,{animate:!0,className:y,style:k},u.a.createElement(M.b.div,{animate:!0,key:"check",className:E,transition:o.a.TransitionSpringSlow})),u.a.createElement("div",{className:i.default.classNames(A.a.title,"pl-3 f1 font-bold")},a)),n&&u.a.createElement("div",{className:i.default.classNames("c-foreground-light text-xs pt-1 leading-tight",A.a.description)},n))})),O=a(402),L=a.n(O),F=Object(N.b)((function(e){var t,a=e.valueObservable,n=e.title,o=e.description,l=e.options,s=e.style,c=e.styleTitle,d=e.className,m=e.onChange,h=e.getValueFromSelected,f=e.getSelectedFromObservable,p=Object(P.a)(a),g=r()(p,1)[0],v=null!==(t=null===f||void 0===f?void 0:f(g))&&void 0!==t?t:g,y=i.default.classNames("c-background c-border-heavy my-2 rounded"),E=Object.assign({textIndent:4,width:100,height:32,fontSize:12},s);return u.a.createElement("div",{className:i.default.classNames("py-2",d)},u.a.createElement("div",null,n&&u.a.createElement("span",{className:i.default.classNames("font-bold pr-8 inline-block",L.a.title),style:c},n),u.a.createElement("select",{className:y,onChange:function(e){var t,n=null!==(t=null===h||void 0===h?void 0:h(e.target.value))&&void 0!==t?t:e.target.value;a.set(n),m&&m(n,g)},value:v,style:E},l.map((function(e){var t="string"===typeof e,a=t?e:Object.keys(e)[0],n=t?e:e[a];return u.a.createElement("option",{key:a,value:a},n)})))),o&&u.a.createElement("div",{className:"c-foreground-light text-xs leading-tight"},o))}));function _(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=b()(e);if(t){var r=b()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return k()(this,a)}}var G=[{"":"None"},D()({},o.a.Prefix.Task,"Task"),D()({},o.a.Prefix.Bullet,"Bullet")],B=function(e){y()(a,e);var t=_(a);function a(){return f()(this,a),t.apply(this,arguments)}return g()(a,[{key:"init",value:function(){var e=this;this.createObservables({isStoragePersisted:!1,usage:NaN,quota:NaN}),s.a.isStoragePersisted((function(t){e.isStoragePersisted.set(t)})),s.a.estimateAvailableStorage((function(t){e.usage.set(t.usage),e.quota.set(t.quota)}),(function(){}))}},{key:"onCacheRatioClick",value:function(){this.getCacheRatio()<.98&&(l.default.settings.cacheSizeRatio.set(1),i.default.sendEvent("CacheRatio","Changed",1),l.default.toasts.pushMessage({text:"Success!",action:o.a.MessageAction.Okay}))}},{key:"parseFn",value:function(e){return parseFloat(e.toFixed(2))}},{key:"getCacheRatio",value:function(){return this.parseFn(l.default.pluginManager.getCacheSizeRatio())}},{key:"onPersistClick",value:function(e){var t=this;if(this.state.isStoragePersisted)return!1;e&&s.a.requestStoragePersistence((function(){t.isStoragePersisted.set(!0)}),(function(){t.isStoragePersisted.set(!1)}))}},{key:"render",value:function(){var e=this.getCacheRatio()<.98,t=!s.a.app&&s.a.supportsPersistedStorage(),a=s.a.supportsEstimatedStorage(),n=+(this.usage.get()/1024/1024).toFixed(2),r=+(this.quota.get()/1024/1024).toFixed(2);return u.a.createElement("div",{key:"content",className:"px-3"},u.a.createElement(F,{title:"Default item type",description:"The default prefix for all new items. If you prefer the bulleted look of an Outliner, choose Bullet. If you prefer a checklist, choose Task. If you prefer the flat look of a document, choose None.",valueObservable:l.default.settings.defaultItemPrefix,options:G}),u.a.createElement(R,{checkedObservable:l.default.settings.showMarkdown,title:"Show Markdown formatting",description:"Show the raw Markdown formatting characters in selected items"}),u.a.createElement(R,{checkedObservable:l.default.settings.showFormattingToolbar,title:"Enable formatting toolbar",description:"Show a toolbar with formatting hotkeys when text is selected",getCheckedFromObservable:function(e){return e>=0},getValueFromChecked:function(e){return e?1:-1}}),u.a.createElement(R,{checkedObservable:l.default.settings.showImagesInline,title:"Show images inline",description:"Show images inline by default when inserting a link to an image, dragging a file from the Drive pane, or uploading an image from your computer. If disabled, it will show a link to the image."}),u.a.createElement(R,{checkedObservable:l.default.settings.openEvernoteApp,title:"Open Evernote links in Evernote app",description:"If not enabled, Evernote links will open the Evernote website"}),s.a.isBeta&&u.a.createElement(R,{checkedObservable:l.default.settings.testBetaFeatures,title:"Test beta features",description:u.a.createElement("span",null,"Beta test new UI features that may be unstable. See ",u.a.createElement("a",{href:"https://www.moo.do/beta/",target:"_blank"},"the Slack community")," for details.")}),u.a.createElement("hr",null),t&&u.a.createElement(R,{checkedObservable:this.isStoragePersisted,getValueFromChecked:function(){return!0},title:"Enable persistent storage",description:"Allow Moo.do to store your data offline without potential for the browser to delete it. This can help Moo.do's performance if your disk is low on free-space."}),e&&u.a.createElement("div",{className:"modal-row"},u.a.createElement(S.a,{raised:!0,onClick:this.onCacheRatioClick},"Reset Cache Ratio"),u.a.createElement("div",{className:"modal-subtext c-foreground-faded"},"If you have run out of disk space in the past, we may not be efficiently caching your data. If you have resolved any disk space issues, click this button to efficiently cache your data again.")),a&&u.a.createElement("div",{className:"modal-row pt-4"},u.a.createElement("div",{className:"modal-row-title"},"Estimated disk usage"),u.a.createElement("div",{className:"modal-subtext"},u.a.createElement("b",null,"Usage: "),Math.round(n)," MB / ",u.a.createElement("b",null,"Quota: "),Math.round(r)," MB")))}}]),a}(w.a),U=a(39),j=a(29),V=a(140),H=a(398),K=a(86),W=a(94);function z(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=b()(e);if(t){var r=b()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return k()(this,a)}}var Y=[o.a.PluginID.Contacts,o.a.PluginID.Gmail,o.a.PluginID.Drive,o.a.PluginID.GCalendar],q=function(e){y()(a,e);var t=z(a);function a(){return f()(this,a),t.apply(this,arguments)}return g()(a,[{key:"init",value:function(){this.pluginsEnabled={},this.pluginOptions={},this.accountRefs={},this.createObservables({errorMessage:"",linkingAccount:void 0,isAddEnabled:!1,modifyingAccounts:{},useLegacyGmail:!1,useLegacyDrive:!1}),this.refAddGmail=u.a.createRef(),this.refAddCalendar=u.a.createRef(),this.refAddContacts=u.a.createRef(),this.refAddDrive=u.a.createRef(),this.refAddAccount=u.a.createRef(),d.a.refresh(),this.listenTo(j.a.onAccountsUpdated)}},{key:"getState",value:function(){var e,t=0,a=j.a.getDefaultAccountID(),n=l.default.settings.syncAccounts.get(),r=Object.keys(n);a&&r.length>1&&r[0]!==a&&(r.remove(a),r.splice(0,0,a));var i={isSaveEnabled:d.a.isSaveEnabled,premiumStatus:l.default.billingManager._premiumStatus,authTokens:j.a.authTokens,syncAccounts:n,accountsList:r,defaultID:a,googleID:null===(e=U.a.getGoogleProvider())||void 0===e?void 0:e.email,isAuthLoaded:j.a.isLoaded,hasPremiumFeatures:l.default.billingManager.hasPremiumFeatures(),erroredAuthTokens:j.a.erroredAuthTokens,supportsGmail:Object.keys(j.a.authTokens).some((function(e){return j.a.authTokens[e].scopes.includes(o.a.GScope.GmailModify)}))};i.showGmail=i.supportsGmail||this.useLegacyGmail.get();for(var s=d.a.pluginsAvailable,c=0;c<s.length;++c){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var u=s[c];this.pluginsEnabled[u]=i[u+"Enabled"]=d.a.getPluginEnabledObservable(u);var m=d.a.getPluginOptions(u);for(var h in m)if(m.hasOwnProperty(h)){var f=u+"_"+h;this.pluginOptions[f]=i[f]=m[h]}}return i}},{key:"updatePluginEnabled",value:function(){var e=i.default.clone(l.default.settings.syncAccounts.get()||{});[o.a.PluginID.Contacts].forEach((function(t){var a=Object.keys(e).some((function(a){return e[a][t]}));a!==d.a.isPluginEnabled(t)&&(a?(console.log("Enabling",t),d.a.enablePlugin(t)):(console.log("Disabling",t),d.a.disablePlugin(t)))}))}},{key:"getAccountCheckboxValue",value:function(e,t){var a=this.accountRefs[e];if(a[t])return a[t].getValue()}},{key:"onClickSaveButton",value:function(e,t,a,n){var r=this;l.default.onIntroAction("PluginSettings");var o=i.default.clone(l.default.settings.syncAccounts.get()||{}),s=[];o[e]={},Y.forEach((function(t){var a=r.getAccountCheckboxValue(e,t);o[e][t]=a,a&&s.push(t)}));var c=function(){return r.modifyingAccounts.set(Object.assign({},r.modifyingAccounts.get(),D()({},e,!1)))};if(s.length>0){var u=l.default.pluginManager.getAllPluginScopes(s,this.state.useLegacyDrive);return(t?j.a.doAuthForAccount:j.a.authAccount).bind(j.a)(e,u,(function(e){e&&(l.default.settings.syncAccounts.set(o),r.refAddAccount.current.clearValue(),r.updatePluginEnabled(),c()),n()})),t}l.default.settings.syncAccounts.set(o),this.updatePluginEnabled(),c()}},{key:"onClickAddButton",value:function(e,t){var a=this;if(!i.default.isDemoMode()){this.errorMessage.set("");var n=this.refAddAccount.current.getValue();if(!this.state.syncAccounts||!this.state.syncAccounts[n]){var r,s,c,u=i.default.clone(l.default.settings.syncAccounts.get()||{}),d=[];u[n]={},(null===(r=this.refAddGmail.current)||void 0===r?void 0:r.getValue())&&(d.push(o.a.PluginID.Gmail),u[n][o.a.PluginID.Gmail]=!0),this.refAddCalendar.current.getValue()&&(d.push(o.a.PluginID.GCalendar),u[n][o.a.PluginID.GCalendar]=!0),(null===(s=this.refAddContacts.current)||void 0===s?void 0:s.getValue())&&(d.push(o.a.PluginID.Contacts),u[n][o.a.PluginID.Contacts]=!0),(null===(c=this.refAddDrive.current)||void 0===c?void 0:c.getValue())&&(d.push(o.a.PluginID.Drive),u[n][o.a.PluginID.Drive]=!0);var m=l.default.pluginManager.getAllPluginScopes(d,this.state.useLegacyDrive);j.a.authAccount(n,m,(function(e){e&&(a.updatePluginEnabled(),l.default.settings.syncAccounts.set(u),a.refAddAccount.current.clearValue(),a.isAddEnabled.set(!1),l.default.onIntroAction("PluginSettings")),t()}))}return!0}}},{key:"onClickRemoveEmail",value:function(e){var t=this;l.default.menus.confirm("Are you sure you want to remove ".concat(e,"?"),(function(a){if(a){j.a.removeAccount(e);var n=i.default.clone(l.default.settings.syncAccounts.get());delete n[e],l.default.settings.syncAccounts.set(n),t.updatePluginEnabled()}}))}},{key:"fixAuth",value:function(e){var t=this.state.syncAccounts,a=t&&t[e],n=a&&Object.keys(a).filter((function(e){return a[e]}));if(n){var r=l.default.pluginManager.getAllPluginScopes(n,this.state.useLegacyDrive);j.a.doAuthForAccount(e,r)}}},{key:"onClickCheckbox",value:function(e,t,a){this.modifyingAccounts.set(Object.assign({},this.modifyingAccounts.get(),D()({},e,!0)))}},{key:"onClickEnablePremium",value:function(e,t){return l.default.billingManager.isTrialOver()?this.props.openSection("Account"):l.default.billingManager.startTrial().then((function(){t()})),!0}},{key:"onClickCalendarSettings",value:function(){this.props.openSection("Calendar")}},{key:"onChangeAdd",value:function(){var e=this,t=this.refAddAccount.current.getValue();setTimeout((function(){var a,n,r;e.isAddEnabled.set(!!t&&t.includes("@")&&t.includes(".")&&!!((null===(a=e.refAddGmail.current)||void 0===a?void 0:a.getValue())||e.refAddCalendar.current.getValue()||(null===(n=e.refAddContacts.current)||void 0===n?void 0:n.getValue())||(null===(r=e.refAddDrive.current)||void 0===r?void 0:r.getValue())))}),0)}},{key:"renderFeature",value:function(e,t,a){return u.a.createElement("div",{className:"feature f1 c-bg-light"},u.a.createElement("div",{className:"featureImg"},u.a.createElement("img",{src:t})),u.a.createElement("div",{className:"bold"},e),a&&u.a.createElement("div",{className:"featurePremium c-bg-lighter"},"PREMIUM"))}},{key:"renderEmptyCheckbox",value:function(){return u.a.createElement("div",{className:"column"})}},{key:"renderAccountCheckbox",value:function(e,t,a){var n=this,r=this.state,i=r.syncAccounts,o=r.hasPremiumFeatures,l=i[e]&&i[e][t],s=a&&!o;return u.a.createElement("div",{className:"column"},u.a.createElement(V.a,{initialChecked:l||!1,disabled:s,tooltip:s&&"The ".concat(t," plugin is a premium feature."),onChange:this.onClickCheckbox.bind(this,e,t),ref:function(a){return n.accountRefs[e][t]=a}}))}},{key:"renderAccount",value:function(e){var t=this,a=this.state,n=a.defaultID,r=a.googleID,l=a.showGmail,s=a.modifyingAccounts,c=e===n,d=e===r,m=s[e],h=i.default.classNames("accountRow c-border flexbox");this.accountRefs[e]||(this.accountRefs[e]={});var f=j.a.accountHasError(e);return u.a.createElement("div",{key:"row"+e,className:h},u.a.createElement("div",{className:"f1"},e),f&&u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"flex justify-center",style:{width:176}},u.a.createElement(S.a,{raised:!0,primary:!0,onClick:function(){return t.fixAuth(e)},style:{height:36}},"FIX AUTHENTICATION")),u.a.createElement("div",{className:"column"},!d&&!m&&u.a.createElement(S.a,{icon:"icon-close",iconSize:20,width:40,height:40,onClick:this.onClickRemoveEmail.bind(this,e)}))),!f&&u.a.createElement(u.a.Fragment,null,c?this.renderAccountCheckbox(e,o.a.PluginID.Contacts):this.renderEmptyCheckbox(),l&&this.renderAccountCheckbox(e,o.a.PluginID.Gmail),this.renderAccountCheckbox(e,o.a.PluginID.GCalendar,!0),c?this.renderAccountCheckbox(e,o.a.PluginID.Drive,!0):this.renderEmptyCheckbox(),u.a.createElement("div",{className:"column"},m&&u.a.createElement(S.a,{padding:0,width:44,primary:m,raised:!0,onClick:this.onClickSaveButton.bind(this,e,!m)},m?"SAVE":"FIX"),!d&&!m&&u.a.createElement(S.a,{icon:"icon-close",iconSize:20,width:40,height:40,onClick:this.onClickRemoveEmail.bind(this,e)}))))}},{key:"renderAddAccount",value:function(){var e=this.state,t=e.hasPremiumFeatures,a=e.accountsList,n=e.showGmail,r=0===a.length,o=i.default.classNames("accountRow c-border flexbox");return u.a.createElement("div",{key:"rowAdding",className:o},u.a.createElement(K.a,{className:"addAccount f1",ref:this.refAddAccount,floatingText:"Add Account Email",padding:{left:16,right:16},height:44,onChange:this.onChangeAdd}),r?u.a.createElement("div",{className:"column"},u.a.createElement(V.a,{initialChecked:!1,ref:this.refAddContacts,onChange:this.onChangeAdd})):this.renderEmptyCheckbox(),n&&(r?u.a.createElement("div",{className:"column"},u.a.createElement(V.a,{initialChecked:!1,ref:this.refAddGmail,onChange:this.onChangeAdd})):this.renderEmptyCheckbox()),u.a.createElement("div",{className:"column"},u.a.createElement(V.a,{initialChecked:!1,ref:this.refAddCalendar,disabled:!t,onChange:this.onChangeAdd})),r?u.a.createElement("div",{className:"column"},u.a.createElement(V.a,{initialChecked:!1,ref:this.refAddDrive,disabled:!t,onChange:this.onChangeAdd})):this.renderEmptyCheckbox(),u.a.createElement("div",{className:"column"},u.a.createElement(S.a,{padding:0,width:44,primary:!0,raised:!0,enabled:this.state.isAddEnabled,onClick:this.onClickAddButton},"ADD")))}},{key:"render",value:function(){var e=this,t=l.default.billingManager,a=this.state.accountsList,n=this.state,r=n.isAuthLoaded,c=n.hasPremiumFeatures,d=n.supportsGmail,m=n.showGmail,h=n.useLegacyGmail;n.useLegacyDrive;return u.a.createElement("div",{key:"content",className:"new-modal-group"},u.a.createElement("div",{className:"title"},"Integrate with your other services"),u.a.createElement("div",{className:"setupSubtext subtext c-foreground-light"},u.a.createElement("b",null,"Moo.do")," connects with your Google services to integrate everything together. Plugin data is cached locally on your device and is never sent to any server. See our ",u.a.createElement("span",{className:"link"},"Privacy Policy")," for more details."),u.a.createElement("div",{className:"setupFeaturesNew flexbox"},this.renderFeature("Google Contacts","/img/plugin-gcontacts.png",!1),m&&this.renderFeature("Gmail","/img/plugin-gmail.png",!1),this.renderFeature("Google Calendar","/img/plugin-gcal.png",!0),this.renderFeature("Google Drive","/img/plugin-gdrive.png",!0)),!c&&u.a.createElement("div",{className:"flexbox flex-center mt-6"},u.a.createElement(S.a,{raised:!0,primary:!0,onClick:this.onClickEnablePremium},t.isTrialOver()?"Go Premium":"Start your free trial"),u.a.createElement("span",{style:{marginLeft:8}},"to enable Premium plugins")),u.a.createElement("div",{className:"pt-4 pl-4"},u.a.createElement("div",{className:"font-bold text-xl"},"Gmail"),u.a.createElement("div",{className:"flex pt-3"},u.a.createElement(S.a,{raised:!0,primary:!0,onClick:function(){return i.default.openUrl(s.a.getChromeExtensionURL())}},"CHROME EXTENSION"))),r?u.a.createElement(H.a,{className:"gmailAccountTable py-4"},u.a.createElement("div",{key:"header",className:"tableHeader flexbox"},u.a.createElement("div",{className:"f1"},"Account"),u.a.createElement("div",{className:"column"},u.a.createElement("img",{src:"/img/plugin-gcontacts.png"})),m&&u.a.createElement("div",{className:"column"},u.a.createElement("img",{src:"/img/plugin-gmail.png"})),u.a.createElement("div",{className:"column"},u.a.createElement("img",{src:"/img/plugin-gcal.png"})),u.a.createElement("div",{className:"column"},u.a.createElement("img",{src:"/img/plugin-gdrive.png"})),u.a.createElement("div",{className:"column"})),a.map((function(t){return e.renderAccount(t)})),this.renderAddAccount()):u.a.createElement(W.a,{style:{marginTop:100}},"Loading Authorization"),this.pluginsEnabled[o.a.PluginID.GCalendar].get()&&0===l.default.pluginManager.getPluginGCalendar().getImportCalendarList().length&&u.a.createElement("div",{className:"flexbox flex-center mt48"},"See the",u.a.createElement(S.a,{raised:!0,style:{marginLeft:8,marginRight:8},onClick:this.onClickCalendarSettings},"Google Calendar settings"),"to sync your calendars."),u.a.createElement("div",{className:"mt-6"},(!d||h)&&u.a.createElement(R,{checkedObservable:this.useLegacyGmail,title:"Use Legacy Gmail Plugin",description:"Only select this if you've previously authenticated the Gmail plugin. Disable this if you get an error."}),u.a.createElement(R,{checkedObservable:this.useLegacyDrive,title:"Use Legacy Drive Access",description:"Only select this if you've previously authenticated for full Drive access. Disable this if you get an error."})))}}]),a}(w.a),Z=a(6),X=a.n(Z),J=a(13),Q=a.n(J),$=a(27),ee=a(84),te="text-xs bold c-foreground-very-faded mt-8 mb-4",ae=Object(N.b)((function(){var e,t,a=l.default.billingManager,n=Object(P.a)(a._hasValidBillingData,a._premiumStatus,a.daysLeftInTrial,l.default.settings.trialOverHidden,U.a.user),s=r()(n,5),c=s[0],d=(s[1],s[2]),m=s[3],h=s[4],f=Object(ee.a)(),p=function(){var e=Q()(X.a.mark((function e(t,a){return X.a.wrap((function(e){for(var t=0;;){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;switch(e.prev=e.next){case 0:return e.next=2,U.a.linkWithGoogle();case 2:a(),f();case 4:case"end":return e.stop()}}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),g=function(){var e=Q()(X.a.mark((function e(t,a){return X.a.wrap((function(e){for(var t=0;;){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;switch(e.prev=e.next){case 0:return e.next=2,U.a.unlinkEmail();case 2:a(),f();case 4:case"end":return e.stop()}}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),v=function(){var e=Q()(X.a.mark((function e(t,a){return X.a.wrap((function(e){for(var t=0;;){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;switch(e.prev=e.next){case 0:return e.next=2,U.a.unlinkGoogle();case 2:a(),f();case 4:case"end":return e.stop()}}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),y=U.a.getAccountName(),E=U.a.getAccountEmail(),k=a.getMonthlyPrice(),C=a.getYearlyPrice(),b=a.hasPremium(),x=a.hasSubscription(),D=a.isTrialOver(),w=null===(e=U.a.getGoogleProvider())||void 0===e?void 0:e.email,M=null===(t=U.a.getEmailProvider())||void 0===t?void 0:t.email,N=!!$.a.getURLParam("threeYear");return u.a.createElement("div",{key:"content",className:"new-modal-group"},a.isTrialOver()&&!m&&u.a.createElement("div",{className:"new-modal-row-1c"},u.a.createElement("div",{className:"new-modal-row trialEnd"},u.a.createElement("div",null,"Your trial has ended. Please sign up to continue using Premium features."),u.a.createElement("div",{className:"center",style:{marginTop:16}},u.a.createElement(S.a,{raised:!0,onClick:function(){l.default.settings.trialOverHidden.set(!0)}},"DISMISS"))),u.a.createElement("hr",null)),u.a.createElement("div",{className:"text-2xl bold center"},y&&"Hi "+y),c&&a.isTrialState()&&u.a.createElement("div",{className:"subtext center"},"We hope your trial of Premium is going well."),c&&b&&u.a.createElement("div",{className:"subtext center"},"We are very happy to have you as a Premium Member."),c&&!b&&!a.isTrialState()&&u.a.createElement("div",{className:"subtext center"},"We hope Moo.do is helping you be productive."),u.a.createElement("div",{className:te},"ACCOUNT STATUS"),u.a.createElement("div",{className:"new-modal-subrow"},u.a.createElement("div",null,u.a.createElement("div",{className:"subtitle"},"Account email"),u.a.createElement("div",{className:"subtext"},E)),u.a.createElement("div",null,u.a.createElement("div",{className:"subtitle"},"Member since"),u.a.createElement("div",{className:"subtext"},a.getJoinDate().toString(l.default.International.getFormat(o.a.DFormat.LongStrDate)))),a.isTrialState()&&!a.isTrialOver()&&u.a.createElement("div",null,u.a.createElement("div",{className:"subtitle"},"Days left in trial"),u.a.createElement("div",{className:"subtext"},d)),b&&u.a.createElement("div",null,u.a.createElement("div",{className:"subtitle"},"Premium since"),u.a.createElement("div",{className:"subtext"},a.getPremiumStartDate().toString(l.default.International.getFormat(o.a.DFormat.LongStrDate)))),a.canceledUserHasPremiumAccess()&&u.a.createElement("div",null,u.a.createElement("div",{className:"subtitle"},"Premium end"),u.a.createElement("div",{className:"subtext"},a.premiumEndDateText())),b&&x&&u.a.createElement("div",null,u.a.createElement("div",{className:"subtitle"},"Next billing cycle"),u.a.createElement("div",{className:"subtext"},a.nextBillingDateText()))),u.a.createElement("div",{className:te},"MANAGE SIGNIN"),u.a.createElement("div",{className:"new-modal-subrow"},h&&u.a.createElement(u.a.Fragment,null,M&&w&&u.a.createElement("div",{className:"flexbox"},u.a.createElement("div",null,u.a.createElement("div",null,u.a.createElement("b",null,"Email signin:")),u.a.createElement("div",{className:"mt-1"},M)),u.a.createElement("div",{className:"ml-4"},u.a.createElement(S.a,{raised:!0,height:32,marginLeft:16,onClick:g},"UNLINK"))),!M&&u.a.createElement("div",null,u.a.createElement(S.a,{height:32,raised:!0,onClick:function(e,t){return l.default.menus.confirm("Please reauthenticate your Google account first.",function(){var e=Q()(X.a.mark((function e(a){return X.a.wrap((function(e){for(var n=0;;){if(n++>5e3&&__infLoop&&__infLoop(n))throw new RangeError;switch(e.prev=e.next){case 0:if(!a){e.next=7;break}return e.next=3,U.a.reauthenticateGoogle();case 3:e.sent&&l.default.menus.promptComplex("Create Account",[{placeholder:"Email"},{placeholder:"Password",type:"password"},{placeholder:"Confirm Password",type:"password"}],(function(e){var t=r()(e,3),a=t[0],n=t[1],o=t[2];return(i.default.isEmail(a)?n!==o&&"Passwords do not match":"Invalid email address")||n.length<6&&"Please use a longer password for better security."}),function(){var e=Q()(X.a.mark((function e(a){var n,i,o;return X.a.wrap((function(e){for(var l=0,s=0;;){if(s++>5e3&&__infLoop&&__infLoop(s))throw new RangeError;if(l++>5e3&&__infLoop&&__infLoop(l))throw new RangeError;switch(e.prev=e.next){case 0:if(!a){e.next=5;break}return n=r()(a,3),i=n[0],o=n[1],n[2],e.next=4,U.a.linkWithEmail(i,o);case 4:f();case 5:t();case 6:case"end":return e.stop()}}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=8;break;case 7:t();case 8:case"end":return e.stop()}}}),e)})));return function(t){return e.apply(this,arguments)}}(),{textYes:"OK",textNo:"CANCEL"}),!0}},"SETUP EMAIL SIGNIN")),M&&w&&u.a.createElement("div",{className:"flexbox"},u.a.createElement("div",null,u.a.createElement("div",null,u.a.createElement("b",null,"Google signin:")),u.a.createElement("div",{className:"mt-1"},w)),u.a.createElement("div",{className:"ml-4"},u.a.createElement(S.a,{raised:!0,height:32,onClick:v},"UNLINK"))),!w&&u.a.createElement("div",null,u.a.createElement(S.a,{raised:!0,height:32,onClick:p},"SETUP GOOGLE SIGNIN")))),u.a.createElement("div",{className:te},"MANAGE ACCOUNT"),u.a.createElement("div",{className:"new-modal-subrow"},!b&&u.a.createElement("div",null,u.a.createElement(S.a,{raised:!0,height:32,onClick:a.onTapDeleteAccount},"DELETE ACCOUNT")),b&&x&&u.a.createElement("div",null,u.a.createElement(S.a,{raised:!0,height:32,onClick:a.onTapUpdatePaymentMethod},"UPDATE PAYMENT METHOD")),b&&x&&u.a.createElement("div",null,u.a.createElement(S.a,{raised:!0,height:32,onClick:a.cancelSubscription},"CANCEL PREMIUM"))),x&&u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:te},"INVOICES"),u.a.createElement("div",null,u.a.createElement(S.a,{raised:!0,height:32,onClick:a.onTapViewInvoices},"VIEW INVOICES"))),!b&&u.a.createElement("div",{id:"accountSettingsPremium",className:"mt-8"},u.a.createElement("hr",null),u.a.createElement("div",{className:"new-modal-title",style:{marginTop:24}},u.a.createElement("div",{className:"title"},"Moo.do Premium"),u.a.createElement("div",{className:"subtext center"},"Integrate more of your services together and unlock advanced organization and customization features."),u.a.createElement("div",{className:"center",style:{marginTop:24}},!D&&u.a.createElement("div",{style:{marginTop:16}},u.a.createElement(S.a,{fontSize:14,raised:!0,primary:!0,onClick:function(){l.default.billingManager.startTrial()}},"Start ".concat(o.a.TrialDuration," day free trial"))),u.a.createElement("div",{style:{marginTop:16}},u.a.createElement(S.a,{fontSize:14,raised:!0,primary:!0,onClick:a.onTapSignupMonth},"$"+k+" / month"),u.a.createElement(S.a,{fontSize:14,raised:!0,primary:!0,marginLeft:16,onClick:a.onTapSignupYear},"$"+C+" / year"),N&&u.a.createElement(S.a,{fontSize:14,raised:!0,primary:!0,marginLeft:16,onClick:a.onTapSignupThreeYear},"$"+3*+C+" / 3 years")))),u.a.createElement("div",{id:"premiumFeatures"},u.a.createElement("div",{className:"flexbox c-border"},u.a.createElement("div",{className:"premiumImg premiumShadow"},u.a.createElement("img",{src:"/img/about/DrivePane.png"})),u.a.createElement("div",{className:"premiumDesc"},u.a.createElement("div",{className:"premiumTitle"},"Google Drive Pane"),u.a.createElement("div",{className:"premiumText"},"Attach documents to your tasks. Dragging a file from your computer into Moo.do automatically uploads it to Drive."))),u.a.createElement("div",{className:"flexbox c-border"},u.a.createElement("div",{className:"premiumImg premiumShadow"},u.a.createElement("img",{src:"/img/about/GCalSettings.jpg"})),u.a.createElement("div",{className:"premiumDesc"},u.a.createElement("div",{className:"premiumTitle"},"Google Calendar Sync"),u.a.createElement("div",{className:"premiumText"},"Two way sync: Manage your Google Calendar in Moo.do and/or sync your Moo.do events with your Google Calendar."))),u.a.createElement("div",{className:"flexbox c-border"},u.a.createElement("div",{className:"premiumImg premiumShadow"},u.a.createElement("img",{src:"/blog/img/update-workspaces.png"})),u.a.createElement("div",{className:"premiumDesc"},u.a.createElement("div",{className:"premiumTitle"},"More than 5 Boards"),u.a.createElement("div",{className:"premiumText"},"Save sets of panes to easily switch between workflows."))),u.a.createElement("div",{className:"flexbox c-border"},u.a.createElement("div",{className:"premiumImg premiumShadow"},u.a.createElement("img",{src:"/img/about/DisplaySettings-Small.jpg"})),u.a.createElement("div",{className:"premiumDesc"},u.a.createElement("div",{className:"premiumTitle"},"Advanced Display Settings"),u.a.createElement("div",{className:"premiumText"},"Customize Moo.do's look and feel to your liking."))),u.a.createElement("div",{className:"flexbox c-border"},u.a.createElement("div",{className:"premiumImg"},u.a.createElement("img",{src:"/img/about/GmailCache.jpg"})),u.a.createElement("div",{className:"premiumDesc"},u.a.createElement("div",{className:"premiumTitle"},"Gmail Sync Time"),u.a.createElement("div",{className:"premiumText"},"Cache emails for up to ",o.a.MaxGmailSyncTime.Premium," days for access while offline and quicker load time.")))),u.a.createElement("table",{id:"pricingTable"},u.a.createElement("tbody",null,u.a.createElement("tr",{className:"c-border c-bg-faded"},u.a.createElement("td",null),u.a.createElement("td",null,"Free"),u.a.createElement("td",null,"Premium")),u.a.createElement("tr",{className:"empty"},u.a.createElement("td",null),u.a.createElement("td",null),u.a.createElement("td",null)),u.a.createElement("tr",{className:"header price"},u.a.createElement("td",null,"Price"),u.a.createElement("td",null,"$0"),u.a.createElement("td",null,u.a.createElement("div",null,"$"+k+" / month"),u.a.createElement("div",null,"$"+C+" / year"))),u.a.createElement("tr",{className:"header"},u.a.createElement("td",null,"Core Features"),u.a.createElement("td",null),u.a.createElement("td",null)),u.a.createElement("tr",null,u.a.createElement("td",null,"Unlimited items"),u.a.createElement("td",{className:"icon-check"}),u.a.createElement("td",{className:"icon-check"})),u.a.createElement("tr",null,u.a.createElement("td",null,"Powerful search"),u.a.createElement("td",{className:"icon-check"}),u.a.createElement("td",{className:"icon-check"})),u.a.createElement("tr",null,u.a.createElement("td",null,"Realtime collaboration"),u.a.createElement("td",{className:"icon-check"}),u.a.createElement("td",{className:"icon-check"})),u.a.createElement("tr",null,u.a.createElement("td",null,"Maximum Number of Boards"),u.a.createElement("td",null,"5"),u.a.createElement("td",null,"Unlimited")),u.a.createElement("tr",null,u.a.createElement("td",null,"Board Folders"),u.a.createElement("td",null),u.a.createElement("td",{className:"icon-check"})),u.a.createElement("tr",null,u.a.createElement("td",null,"Day, Week, Month views"),u.a.createElement("td",null),u.a.createElement("td",{className:"icon-check"})),u.a.createElement("tr",null,u.a.createElement("td",null,"Custom Hotkeys"),u.a.createElement("td",null),u.a.createElement("td",{className:"icon-check"})),u.a.createElement("tr",{className:"empty"},u.a.createElement("td",null),u.a.createElement("td",null),u.a.createElement("td",null)),u.a.createElement("tr",{className:"header"},u.a.createElement("td",null,"Plugins"),u.a.createElement("td",null),u.a.createElement("td",null)),u.a.createElement("tr",null,u.a.createElement("td",null,u.a.createElement("img",{src:"/img/plugin-gcontacts.png"}),"Google Contacts"),u.a.createElement("td",{className:"icon-check"}),u.a.createElement("td",{className:"icon-check"})),u.a.createElement("tr",null,u.a.createElement("td",null,u.a.createElement("img",{src:"/img/plugin-mailbird.png"}),"Mailbird"),u.a.createElement("td",{className:"icon-check"}),u.a.createElement("td",{className:"icon-check"})),u.a.createElement("tr",null,u.a.createElement("td",null,u.a.createElement("img",{src:"/img/plugin-gdrive.png"}),"Google Drive"),u.a.createElement("td",null),u.a.createElement("td",{className:"icon-check"})),u.a.createElement("tr",{className:"empty"},u.a.createElement("td",null),u.a.createElement("td",null),u.a.createElement("td",null)),u.a.createElement("tr",{className:"header"},u.a.createElement("td",null,u.a.createElement("img",{src:"/img/plugin-gmail.png"}),"Gmail"),u.a.createElement("td",null),u.a.createElement("td",null)),u.a.createElement("tr",null,u.a.createElement("td",null,"Standard email features"),u.a.createElement("td",{className:"icon-check"}),u.a.createElement("td",{className:"icon-check"})),u.a.createElement("tr",null,u.a.createElement("td",null,"Offline sync"),u.a.createElement("td",null,"5 days"),u.a.createElement("td",null,"120 days")),u.a.createElement("tr",{className:"empty"},u.a.createElement("td",null),u.a.createElement("td",null),u.a.createElement("td",null)),u.a.createElement("tr",{className:"header"},u.a.createElement("td",null,u.a.createElement("img",{src:"/img/plugin-gcal.png"}),"Google Calendar"),u.a.createElement("td",null),u.a.createElement("td",null)),u.a.createElement("tr",null,u.a.createElement("td",null,"Sync Moo.do tasks"),u.a.createElement("td",null),u.a.createElement("td",{className:"icon-check"})),u.a.createElement("tr",null,u.a.createElement("td",null,"Manage Calendar in Moo.do"),u.a.createElement("td",null),u.a.createElement("td",{className:"icon-check"})),u.a.createElement("tr",{className:"empty"},u.a.createElement("td",null),u.a.createElement("td",null),u.a.createElement("td",null)),u.a.createElement("tr",{className:"header"},u.a.createElement("td",null,"Customization"),u.a.createElement("td",null),u.a.createElement("td",null)),u.a.createElement("tr",null,u.a.createElement("td",null,"Display settings presets"),u.a.createElement("td",{className:"icon-check"}),u.a.createElement("td",{className:"icon-check"})),u.a.createElement("tr",null,u.a.createElement("td",null,"Advanced display settings"),u.a.createElement("td",null),u.a.createElement("td",{className:"icon-check"})),u.a.createElement("tr",{className:"empty"},u.a.createElement("td",null),u.a.createElement("td",null),u.a.createElement("td",null)),u.a.createElement("tr",{className:"header"},u.a.createElement("td",null,"We love you",u.a.createElement("i",{className:"icon-heart"})),u.a.createElement("td",null),u.a.createElement("td",null)),u.a.createElement("tr",null,u.a.createElement("td",null,"Premium support"),u.a.createElement("td",null),u.a.createElement("td",{className:"icon-check"})),u.a.createElement("tr",{className:"empty"},u.a.createElement("td",null),u.a.createElement("td",null),u.a.createElement("td",null))))))})),ne=Object(N.b)((function(e){e.openSection;var t=Object(c.useState)(!1),a=r()(t,2),n=a[0],o=a[1],s=Object(c.useRef)();return u.a.createElement("div",{key:"content",className:"new-modal-group"},u.a.createElement("div",{className:"new-modal-title"},u.a.createElement("div",{className:"title"},"Send Feedback"),u.a.createElement("div",{className:"subtext middle"},"Send the developers bug reports, feedback, or suggestions. Your feedback is very helpful in planning what to do next.")),u.a.createElement("div",{className:"earlyAccessFeedback"},u.a.createElement("textarea",{className:"feedbackTextArea c-background c-foreground",ref:s,style:{marginBottom:16,color:n?"#aaa":null}}),u.a.createElement("div",{style:{textAlign:"right"}},u.a.createElement(S.a,{raised:!0,onClick:function(){s.current.value="",s.current.focus()}},"DISCARD"),u.a.createElement(S.a,{raised:!0,primary:!0,marginLeft:16,onClick:function(e,t){var a=s.current.value;if(a&&a.length>2){o(!0);return l.default.sendFeedback("Moo.do Feedback",a).then((function(){s.current.value="",o(!1),t&&i.default.isFunction(t)&&t()})),!0}}},"SEND"))))})),re=a(195),ie=Object(N.b)((function(e){var t,a=e.valueObservable,n=e.title,o=e.description,l=e.minValue,s=e.maxValue,c=e.interval,d=e.readonly,m=(e.style,e.styleTitle),h=e.className,f=e.onChange,p=e.getNumberFromObservable,g=e.getValueFromNumber,v=Object(P.a)(a),y=r()(v,1)[0],E=null!==(t=null===p||void 0===p?void 0:p(y))&&void 0!==t?t:y;return u.a.createElement("div",{className:i.default.classNames("py-2",h)},u.a.createElement("div",null,n&&u.a.createElement("span",{className:i.default.classNames("font-bold pr-8 inline-block",L.a.title),style:m},n),u.a.createElement(re.a,{value:E,minValue:l,maxValue:s,interval:c,readonly:d,onChange:function(e){var t,n=null!==(t=null===g||void 0===g?void 0:g(e))&&void 0!==t?t:e;a.set(n),f&&f(n)}})),o&&u.a.createElement("div",{className:"c-foreground-light text-xs pt-3 leading-tight"},o))}));function oe(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=b()(e);if(t){var r=b()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return k()(this,a)}}var le=function(e){y()(a,e);var t=oe(a);function a(){return f()(this,a),t.apply(this,arguments)}return g()(a,[{key:"init",value:function(){this.hadCalendarSyncUpdated=!1,this.createObservables({addingCalendar:!1}),this.refAddCalendar=u.a.createRef(),d.a.refresh()}},{key:"openSection",value:function(e){this.props.openSection(e)}},{key:"onUnmount",value:function(){if(this.hadCalendarSyncUpdated){var e=l.default.pluginManager.getPlugin(o.a.PluginID.GCalendar);e.isActive()&&e.forceRemoteEventSync()}}},{key:"getState",value:function(){var e=l.default.pluginManager.getPluginGCalendar(),t={premiumStatus:l.default.billingManager._premiumStatus,hasAccounts:e.getSyncAccounts().length>0,GCalendarsAvailable:d.a.GCalendarsAvailable,GCalendarSyncErrors:d.a.GCalendarSyncErrors,GCalendarAddFailure:d.a.GCalendarAddFailure,GCalendarListFailure:d.a.GCalendarListFailure,GCalendarListLoading:d.a.GCalendarListLoading},a=d.a.getPluginOptions(o.a.PluginID.GCalendar);for(var n in a){if(a.hasOwnProperty(n))t[o.a.PluginID.GCalendar+"_"+n]=a[n]}return t}},{key:"toggleCalendarImport",value:function(e){var t=o.a.PluginSettingsID.GCalendar.ImportCalendars,a=(this.state[o.a.PluginID.GCalendar+"_"+t]||[]).slice(0),n=this.isExportCalendar(e);n&&this.disableCalendarExport();var r=a.indexOfWithProperty("id",e.id);if(r>=0)a.removeAt(r);else{try{i.default.PAssert(827,!n,"Export calendar state must be matching with import calendar state")}catch(l){i.default.reportError(l)}try{i.default.PAssert(828,e.accountID,"Calendar should have an accountID")}catch(l){i.default.reportError(l)}a.push({id:e.id,summary:e.summary,accessRole:e.accessRole,accountID:e.accountID})}d.a.setPluginOption(o.a.PluginID.GCalendar,t,a,!1),this.hadCalendarSyncUpdated=!0}},{key:"enableCalendarExport",value:function(e){d.a.setPluginOption(o.a.PluginID.GCalendar,o.a.PluginSettingsID.GCalendar.ExportCalendar,e.id,!1),this.hadCalendarSyncUpdated=!0,this.isImportCalendar(e)||this.toggleCalendarImport(e)}},{key:"disableCalendarExport",value:function(){d.a.setPluginOption(o.a.PluginID.GCalendar,o.a.PluginSettingsID.GCalendar.ExportCalendar,null,!1)}},{key:"toggleCalendarExport",value:function(e){this.isExportCalendar(e)?this.disableCalendarExport():this.enableCalendarExport(e)}},{key:"onAddCalendarClick",value:function(e){var t=this;this.addingCalendar.set(e),setTimeout((function(){t.refAddCalendar.current.focus()}),0)}},{key:"onAddButtonClick",value:function(e,t){d.a.addCalendar(e,t),this.addingCalendar.set(!1)}},{key:"isImportCalendar",value:function(e){var t=!1;if(this.state.GCalendar_importCalendars)for(var a=0,n=0;n<this.state.GCalendar_importCalendars.length;++n){if(a++>5e3&&__infLoop&&__infLoop(a))throw new RangeError;var r=this.state.GCalendar_importCalendars[n];if(i.default.isObject(r)||(r={id:r}),r.id===e.id){t=!0;break}}return t}},{key:"isExportCalendar",value:function(e){var t=!1;return this.state.GCalendar_exportCalendar&&(t=this.state.GCalendar_exportCalendar===e.id),t}},{key:"updateCalendarEvents",value:function(){var e=l.default.pluginManager.getPlugin(o.a.PluginID.GCalendar);try{i.default.PAssert(829,e,"GCalendar plugin does not exist. HOW?")}catch(t){i.default.reportError(t)}e&&e.runCalendarSync()}},{key:"onChangeWeeks",value:function(){clearTimeout(this.timeoutUpdateCalendarEvents),this.timeoutUpdateCalendarEvents=setTimeout(this.updateCalendarEvents,5e3)}},{key:"comparatorCalendar",value:function(e,t){var a=e.accountID&&t.accountID?e.accountID.localeCompare(t.accountID):0;if(0===a)return e.summary.localeCompare(t.summary);var n=j.a.getDefaultAccountID();return e.accountID===n&&(a=-1),t.accountID===n&&(a=1),a}},{key:"onClickSyncAccounts",value:function(){this.openSection("Plugins")}},{key:"renderTableRows",value:function(){var e=this,t=this.state,a=t.GCalendarsAvailable,n=t.GCalendarSyncErrors,r=l.default.settings.syncAccounts.get(),s=Object.keys(r),c=l.default.pluginManager.getPlugin(o.a.PluginID.GCalendar),d={},m=[];a.sort(this.comparatorCalendar),a.forEach((function(e){d[e.accountID]||(d[e.accountID]=[]),d[e.accountID].push(e)}));var h=j.a.getDefaultAccountID();return s.includes(h)&&(s.remove(h),s.splice(0,0,h)),s.forEach((function(a){var r=d[a];if(m.push(u.a.createElement("div",{className:"calendarAccount bold c-blue",key:"account_"+a},u.a.createElement("div",null,"Account: "+a),!r&&u.a.createElement(S.a,{raised:!0,style:{width:"auto"},onClick:e.onClickSyncAccounts},"Sync this account"))),r){r.forEach((function(t){var r=e.isImportCalendar(t),l=e.isExportCalendar(t),s="owner"===t.accessRole||"writer"===t.accessRole,d=i.default.classNames("calendarSettingsName",{import:r},{export:l});if(n){var h=n.indexOfWithProperty("id",t.id),f=null,p=null;if(h>=0){var g=n[h];g.result===o.a.SyncResult.FailureNoRead?f=!0:g.result===o.a.SyncResult.FailureNoRead&&(p=!0)}}var v=c.getCalendarBackgroundColor(t.id);m.push(u.a.createElement("div",{key:t.id+a},u.a.createElement("div",{className:d},t.summary||t.id),u.a.createElement(V.a,{checked:r,error:f,checkedColor:v,onChange:e.toggleCalendarImport.bind(e,t)}),s?u.a.createElement(V.a,{checked:l,checkedColor:v,error:f||p,radio:!0,onChange:e.toggleCalendarExport.bind(e,t)}):u.a.createElement("div",null)))}));var l=t.addingCalendar===a;m.push(u.a.createElement(u.a.Fragment,{key:"add"+a},t.GCalendarAddFailure&&u.a.createElement("div",{key:"footerError"},u.a.createElement("div",{style:{textAlign:"center"}},"There was an error creating your new calendar. Please try again.")),l&&u.a.createElement("div",{key:"footer"},u.a.createElement(K.a,{ref:e.refAddCalendar,floatingText:"New calendar name",padding:{left:0,right:24},height:50,buttonText:"ADD",onButtonClick:e.onAddButtonClick.bind(e,a)})),!l&&u.a.createElement("div",{key:"footer"},u.a.createElement("div",{style:{textAlign:"center"}},u.a.createElement(S.a,{height:"auto",onClick:e.onAddCalendarClick.bind(e,a)},"ADD NEW CALENDAR")))))}})),m}},{key:"renderCalendarSettings",value:function(){var e,t,a=this.state,n=0,r=a.GCalendarSyncErrors,i=!1;if(r)for(var s=0,c=0;c<r.length;c++){if(s++>5e3&&__infLoop&&__infLoop(s))throw new RangeError;var m=r[c].result;m===o.a.SyncResult.FailureOAuth?i=!0:m!==o.a.SyncResult.FailureNoRead&&m!==o.a.SyncResult.FailureNoWrite||n++}var h=l.default.pluginManager.getPlugin(o.a.PluginID.GCalendar);return l.default.billingManager.hasPremiumFeatures()?i&&0===a.GCalendarsAvailable.length?t=u.a.createElement("div",{className:"center"},u.a.createElement("div",{className:"error"},"We encountered a sync error. Please allow access to your calendar."),u.a.createElement("br",null),u.a.createElement(S.a,{raised:!0,primary:!0,onClick:d.a.enablePlugin.bind(d.a,o.a.PluginID.GCalendar)},"ALLOW")):a.GCalendarListFailure?t=u.a.createElement("div",{className:"center"},u.a.createElement("div",{className:"error"},"There was an error syncing your calendar list. Please try again."),u.a.createElement("br",null),u.a.createElement(S.a,{raised:!0,primary:!0,onClick:d.a.updateCalendarList.bind(d.a)},"RETRY")):a.GCalendarListLoading?t=u.a.createElement(W.a,null,"Loading Google Calendars..."):(n>0&&(t=u.a.createElement("div",{className:"center"},u.a.createElement("div",{style:{maxWidth:600,lineHeight:1.5,marginBottom:16},className:"error"},"There was an error reading or saving to your calendars. Please check your Google Calendar settings. The affected calendars are marked with a ",u.a.createElement(V.a,{checked:!0,error:!0,style:{marginLeft:5,marginRight:5}})," below."))),e=u.a.createElement(H.a,{className:"calendarSettingsTable new-modal-row"},u.a.createElement("div",{key:"header",className:"fancyTableHeader"},u.a.createElement("div",null,"Calendar Name"),u.a.createElement("div",null,"Sync"),u.a.createElement("div",null,"Default Save")),this.renderTableRows())):t=u.a.createElement("div",{className:"center"},u.a.createElement("div",{className:"error"},"You must have an active Premium subscription or Trial to use Google Calendar."),u.a.createElement("br",null),u.a.createElement(S.a,{raised:!0,primary:!0,onClick:this.openSection.bind(this,"Account")},"ABOUT PREMIUM")),u.a.createElement("div",null),u.a.createElement("div",null),u.a.createElement("div",{className:"calendarSettings"},t,e,u.a.createElement("div",null,u.a.createElement(ie,{title:"Weeks in the past",className:"py-4",valueObservable:h.getSettingObs(o.a.PluginSettingsID.GCalendar.WeeksPast),minValue:0,maxValue:-o.a.CalendarMinSyncWeeks,onChange:this.onChangeWeeks,styleTitle:{width:140}}),u.a.createElement(ie,{title:"Weeks in the future",className:"py-4",valueObservable:h.getSettingObs(o.a.PluginSettingsID.GCalendar.WeeksFuture),minValue:0,maxValue:o.a.CalendarMaxSyncWeeks,onChange:this.onChangeWeeks,styleTitle:{width:140}})),u.a.createElement(R,{title:"Display overdue Google Calendar events in agenda",checkedObservable:h.getSettingObs(o.a.PluginSettingsID.GCalendar.DisplayOverdueInAgenda),description:"In the Agenda view of the Calendar Pane, display events from Google Calendar that happened in the past."}),u.a.createElement(R,{title:"Sync dragged events",checkedObservable:h.getSettingObs(o.a.PluginSettingsID.GCalendar.SyncDraggedEvents),description:"Add events to Google Calendar when dragging onto the Calendar pane."}),u.a.createElement(R,{title:"Sync new events created in add item popup by default",checkedObservable:h.getSettingObs(o.a.PluginSettingsID.GCalendar.SyncNewEvents),description:"When adding events in the New Item popup, an event will be created in the selected Google Calendar."}),u.a.createElement(R,{title:"Sync new events created in date popup by default",checkedObservable:h.getSettingObs(o.a.PluginSettingsID.GCalendar.SyncPopup),description:"When setting dates in the date popup popup, an event will be created in the selected Google Calendar."}),u.a.createElement(R,{title:"Create a local item for new calendar events by default",checkedObservable:h.getSettingObs(o.a.PluginSettingsID.GCalendar.CreateLocalEvents),description:"When adding events in the New Item popup, a Moo.do item will be created in the current document."}))}},{key:"render",value:function(){var e=this.state.hasAccounts;return u.a.createElement("div",{className:"new-modal-group"},e&&u.a.createElement("div",{className:"new-modal-row new-modal-row-1c"},this.renderCalendarSettings()),!e&&u.a.createElement("div",{className:"new-modal-row new-modal-row-1c"},u.a.createElement("div",{className:"subtext"},"No sync accounts available. Please check the Sync Accounts settings."),u.a.createElement("div",{style:{marginTop:24}},u.a.createElement(S.a,{raised:!0,primary:!0,onClick:this.onClickSyncAccounts},"Sync Accounts Settings"))))}}]),a}(w.a),se=a(64),ce=Object(N.b)((function(){var e=Object(P.a)(se.a._contacts),t=r()(e,1)[0];return u.a.createElement("div",{className:"settingPluginOptions"},u.a.createElement("div",{className:"subtext"},u.a.createElement("span",null,"We will not send emails or otherwise communicate with your contacts unless you ask us to."),u.a.createElement("span",null," If you need instant access to contacts you just added you can sync them by pressing the button below, otherwise your contacts will appear automatically after a few hours.")),u.a.createElement("div",{className:"center"},u.a.createElement(S.a,{id:"refreshContacts",raised:!0,primary:!0,onClick:d.a.onTapRefreshContacts},"REFRESH CONTACTS"),u.a.createElement("div",{id:"numContacts"},t.length+" contacts loaded")))})),ue=Object(N.b)((function(e){var t=e.openSection,a=Object(c.useRef)();Object(c.useEffect)((function(){return function(){if(a.current){var e=l.default.pluginManager.getPluginGmail();e.isActive()&&e._forceThreadSync()}}}),[]);var n=l.default.pluginManager.getPlugin(o.a.PluginID.Gmail),r=l.default.billingManager.hasPremiumFeatures()?o.a.MaxGmailSyncTime.Premium:o.a.MaxGmailSyncTime.Free;return u.a.createElement("div",{className:"new-modal-group gmailSettings"},u.a.createElement("div",{className:"new-modal-row new-modal-row-1c center"},u.a.createElement(S.a,{raised:!0,onClick:function(){t("Plugins")}},"SETUP ACCOUNTS")),u.a.createElement(ie,{title:"Offline sync days",className:"py-4",valueObservable:n.getSettingObs(o.a.PluginSettingsID.Gmail.SyncTime),minValue:0,maxValue:r,onChange:function(){a.current=!0},description:"The number of days in the past that your email will be saved for offline access (0 - ".concat(r,").").concat(l.default.billingManager.hasPremiumFeatures()?"":" Premium users can sync up to ".concat(o.a.MaxGmailSyncTime.Premium," days of emails."))}),u.a.createElement(R,{title:"Archive emails when scheduled",checkedObservable:n.getSettingObs(o.a.PluginSettingsID.Gmail.ArchiveOnSchedule),description:"If enabled, when you use the 'Schedule' feature to put an email on your calendar it will be archived."}),u.a.createElement(R,{title:"Archive emails when organized",checkedObservable:n.getSettingObs(o.a.PluginSettingsID.Gmail.ArchiveOnOrganize),description:"If enabled, when you drag an email to your outline it will be archived and marked as Moo.do/Handled."}),u.a.createElement(R,{title:"Insert signature before quoted text in replies",checkedObservable:n.getSettingObs(o.a.PluginSettingsID.Gmail.InsertSignatureAboveReplies),description:"If enabled, your signature will be inserted above the quoted text in replies and will remove the '--' line that precedes it."}),u.a.createElement("div",{className:"new-modal-row new-modal-row-1c center"},u.a.createElement(S.a,{raised:!0,onClick:function(e,t){return l.default.pluginManager.getPluginGmail().syncAllAccountsFull(t),!0}},"Force Full Sync")))})),de=a(194),me=a(56),he=a.n(me),fe=a(66),pe=a.n(fe);function ge(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=b()(e);if(t){var r=b()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return k()(this,a)}}var ve=function(e){y()(a,e);var t=ge(a);function a(){return f()(this,a),t.apply(this,arguments)}return g()(a,[{key:"init",value:function(){this.amtMoved=void 0,this.prevPos=void 0,this.isDragging=!1,this.createObservables({dragPosition:void 0})}},{key:"getElement",value:function(){return this.refs.element}},{key:"getDraggingElement",value:function(){return this.refs.draggingElement}},{key:"getDragPosition",value:function(){return this.state.dragPosition}},{key:"onMouseDown",value:function(e){var t=this.props.horizontal,a=t?e.clientX:e.clientY;this.amtMoved=0,this.prevPos={left:e.clientX,top:e.clientY},this.dragOffset=i.default.offset(this.refs.element)[t?"left":"top"]-a,this.props.allowDragOut&&(this.startPos={left:e.clientX,top:e.clientY}),document.addEventListener("mousemove",this.onMouseMoveDragging),document.addEventListener("mouseup",this.onMouseUpDragging)}},{key:"onMouseMoveDragging",value:function(e){var t=this.props,a=t.horizontal,n=a?e.clientX:e.clientY;if(this.amtMoved+=Math.abs(e.clientX-this.prevPos.left)+Math.abs(e.clientY-this.prevPos.top),this.amtMoved>3){this.isDragging||(this.isDragging=!0,t.onDragStart(this)),t.onDragMove(this,e);var r=a?"left":"top",o=this.refs.element.parentElement,l=i.default.offset(o),s=n+this.dragOffset-l[r],c={};a?(c.left=s,t.allowDragOut&&(c.top=e.clientY-this.startPos.top)):(c.top=s,t.allowDragOut&&(c.left=e.clientX-this.startPos.left)),this.dragPosition.set(c)}this.prevPos={left:e.clientX,top:e.clientY}}},{key:"onMouseUpDragging",value:function(e){this.isDragging&&this.props.onDragEnd(this,e),this.amtMoved=void 0,this.prevPos=void 0,this.dragOffset=void 0,this.isDragging=!1,this.dragPosition.set(void 0),document.removeEventListener("mousemove",this.onMouseMoveDragging),document.removeEventListener("mouseup",this.onMouseUpDragging)}},{key:"render",value:function(){var e=this.state,t=this.props,a=e.dragPosition,n=!i.default.isEmpty(a),r=i.default.classNames(t.className,"fancySortableItem",{noClick:t.noDrag},{dragging:n||t.isDragging}),o=i.default.classNames((n||t.isDragging)&&t.classDragging),l={};return a&&(l[s.a.transform.react]="translate3d("+(a.left||0)+"px,"+(a.top||0)+"px,0)"),u.a.createElement("div",{className:r,onMouseDownCapture:this.onMouseDown,ref:"element"},u.a.createElement("span",{className:o},t.children),n&&u.a.createElement("div",{className:"draggingElement",style:l,ref:"draggingElement"},t.children))}}]),a}(w.a);function ye(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=b()(e);if(t){var r=b()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return k()(this,a)}}var Ee=function(e){y()(a,e);var t=ye(a);function a(){return f()(this,a),t.apply(this,arguments)}return g()(a,[{key:"init",value:function(){this.createObservables({draggingChild:void 0})}},{key:"getElement",value:function(){return this.refs.element}},{key:"onDragStart",value:function(e){this.isDraggingInside=!0,this.dragDidMove=!1,this.draggingChild.set(e)}},{key:"findTargetIndex",value:function(e){for(var t=0,a=u.a.Children.count(this.props.children),n=this.props.horizontal?"left":"top",r=this.props.horizontal?"width":"height",o=e.props.owner===this?e.props.index:-1,l=e.getDraggingElement(),s=i.default.offset(l)[n],c=l.getBoundingClientRect()[r],d=-1,m=!1,h=0;h<a;h++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var f=this.refs["el_"+h];if(f!==this.draggingChild.get()){var p=f.getElement(),g=i.default.offset(p)[n],v=p.getBoundingClientRect()[r],y=Math.min(v,c)/2;if(h>o)s+y>=g&&(d=h,h===a-1&&!m&&s>g+y&&(d=a));else if(s<=g+y)return h}else m=!0}return d}},{key:"onDragMove",value:function(e,t){if(e.getDraggingElement()){var a=this,n=e.props.index,r=e.props.owner;0,this.props.getDragTargetFromElement&&!(a=this.props.getDragTargetFromElement(t.target))&&this.isDraggingInside&&(this.isDraggingInside=!1,this.props.onDragOut(n,r)),a&&(this.isDraggingInside=!0,a.handleDragMove(e,t))}}},{key:"handleDragMove",value:function(e,t){var a=e.props.index,n=e.props.owner,r=this.findTargetIndex(e);r>=0&&(r!==a||this!==n)&&(this.dragDidMove=!0,this.props.moveChild(a,r,n,this))}},{key:"onDragEnd",value:function(e,t){if(this.draggingChild.set(void 0),this.props.onDragEnd){var a=!1;if(this.props.getDragTargetFromElement){var n=this.props.getDragTargetFromElement(t.target);a=n&&n!==this}this.props.onDragEnd(e,a,this.dragDidMove||a)}}},{key:"render",value:function(){var e=this,t=this.props,a=(t.moveChild,t.horizontal),n=(t.getDragTargetFromElement,t.onDragOut,t.classDragging,t.onDragEnd,pe()(t,["moveChild","horizontal","getDragTargetFromElement","onDragOut","classDragging","onDragEnd"])),r=i.default.classNames("fancySortableList",t.className,{dragging:!!this.state.draggingChild},{flexbox:a}),o=u.a.Children.map(t.children,(function(n,r){return u.a.createElement(ve,{owner:e,onDragStart:e.onDragStart,onDragMove:e.onDragMove,onDragEnd:e.onDragEnd,ref:"el_"+r,index:r,horizontal:a,noDrag:n.props["data-nodrag"],isDragging:n.props["data-isdragging"],allowDragOut:!!t.getDragTargetFromElement,classDragging:t.classDragging},n)}));return u.a.createElement("div",he()({},n,{className:r,ref:"element"}),o)}}]),a}(w.a);function ke(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=b()(e);if(t){var r=b()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return k()(this,a)}}var Ce=["overdue","starred","important","#next","#soon","#later","#someday"],be=function(e){y()(a,e);var t=ke(a);function a(){return f()(this,a),t.apply(this,arguments)}return g()(a,[{key:"init",value:function(){for(var e=0,t=0,a=0,n=l.default.timeline.agendaSort.get(),r=[],i=Object.keys(n).map((function(e){return{key:e,value:n[e]}})),o=0;o<15;o++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;i.push(o)}for(i.sort(this.sortComparator),o=0;o<Ce.length;o++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var s=Ce[o];i.indexOfWithProperty("key",s)<0&&r.push({key:s,value:0})}var c=de.a.getAll();for(o=0;o<c.length;o++){if(a++>5e3&&__infLoop&&__infLoop(a))throw new RangeError;var u="#"+c[o].text;i.indexOfWithProperty("key",u)<0&&r.push({key:u,value:0})}r.sort(this.sortComparatorNonSort),this.createObservables({sortArray:i,nonSortArray:r,selected:{array:"sort",index:0}})}},{key:"sortComparatorNonSort",value:function(e,t){var a=e.key[0],n=t.key[0];return"#"===a&&"#"!==n?1:"#"===n&&"#"!==a?-1:e.key.localeCompare(t.key)}},{key:"sortComparator",value:function(e,t){return(isNaN(e)?e.value:100*e)-(isNaN(t)?t.value:100*t)}},{key:"moveChild",value:function(e,t,a,n){var r=this.state,i=a&&a!==this.refs.sortList?"nonSort":"sort",o=n&&n!==this.refs.nonSortList?"sort":"nonSort",l=r[i+"Array"],s=r[o+"Array"],c=l===s,u="sort"===i?r.nonSortArray:r.sortArray,d=l[e];c?l.splice(e,1):d.isDragging=!0;var m=u.indexOfWithProperty("key",d.key);m>=0&&u.splice(m,1),s.splice(t,0,d),this[i+"Array"].set(l,!1),this[o+"Array"].set(s,!0)}},{key:"onDragOut",value:function(e,t){var a=t&&t!==this.refs.sortList?"nonSort":"sort",n=this.state[a+"Array"],r="sort"===a?this.nonSortArray:this.sortArray,i=n[e],o=r.indexOfWithProperty("key",i.key);o>=0&&r.splice(o,1)}},{key:"onDragEnd",value:function(e,t,a){var n=e.props.owner,r=e.props.index,i=n&&n!==this.refs.sortList?"nonSort":"sort",o=this.state[i+"Array"][r];if(o.isDragging=!1,t){var l=e.props.owner;(l&&l!==this.refs.nonSortList?this.sortArray:this.nonSortArray).splice(e.props.index,1)}this.sortArray.indexOf(o)<0&&this.nonSortArray.indexOf(o)<0&&this.nonSortArray.push(o),this.sortArray.notify(),a&&this.saveAfterTimeout()}},{key:"saveAfterTimeout",value:function(){this._saveTimeout&&clearTimeout(this._saveTimeout),this._saveTimeout=setTimeout(this.saveToSettings,200)}},{key:"saveToSettings",value:function(){for(var e,t=0,a=this.state.sortArray,n={},r=-1,i=0;i<a.length;i++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=a[i];if(isNaN(o)){var s=100*r,c=e&&e>s?e+1:s+1;n[o.key]=c,e=c}else r=o}l.default.timeline.saveAgendaSort(n)}},{key:"getDragTargetFromElement",value:function(e){var t=i.default.findParent(e,"fancySortableList"),a=this.refs;return t===a.sortList.getElement()?a.sortList:t===a.nonSortList.getElement()?a.nonSortList:void 0}},{key:"onClickMoveToOtherList",value:function(){var e=this.state.selected,t=e.array,a=e.index,n="sort"===t?"nonSort":"sort",r=this.state[t+"Array"][a];isNaN(r)&&(this[t+"Array"].splice(a,1),this[n+"Array"].splice(0,0,r)),this.saveAfterTimeout()}},{key:"onClickListItem",value:function(e,t){this.selected.set({array:e,index:t})}},{key:"renderListItem",value:function(e,t,a,n){var r=this.state,o=this.onClickListItem.bind(this,n,t);if(isNaN(e)){var l=e.key.capitalize(),s=i.default.classNames(a,{"tag c-tag":l.startsWith("#")},{"selected c-popup-item":r.selected.array===n&&r.selected.index===t});return u.a.createElement("div",{key:l,className:s,onClick:o,"data-isdragging":e.isDragging},l)}return u.a.createElement("div",{key:e,className:a+" date c-date","data-nodrag":!0},u.a.createElement("span",{className:"icon-calendar"}),u.a.createElement("span",null,"Today"+(e>0?" + "+e+" days":"")))}},{key:"render",value:function(){var e,t=0,a=0,n=this.state,r=n.sortArray,o=n.nonSortArray,l=[],s=[],c=n.selected.array,d=i.default.classNames("agendaSortSettingsItem c-background"),m=i.default.classNames({"icon-arrow_forward":"sort"===c},{"icon-arrow_back":"nonSort"===c});for(e=0;e<r.length;e++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;l.push(this.renderListItem(r[e],e,d,"sort"))}for(e=0;e<o.length;e++){if(a++>5e3&&__infLoop&&__infLoop(a))throw new RangeError;s.push(this.renderListItem(o[e],e,d,"nonSort"))}return u.a.createElement("div",{className:"agendaSortListsContainer modal-row flexbox flexvert",style:{height:"100%"}},u.a.createElement("div",{className:"modal-row-title"},"Change agenda sort"),u.a.createElement("div",{className:"modal-subtext c-foreground-faded"},"Customize the sort order of the Agenda. Drag and drop tags and blocks to arrange them relative to dates."),u.a.createElement("div",{className:"modal-row agendaSortLists flexbox f1"},u.a.createElement("div",{className:"agendaSortListWrapper flexbox flexvert f1"},u.a.createElement("div",{className:"bold"},"Order on Agenda"),u.a.createElement(Ee,{className:"agendaSortList f1 c-border-light",moveChild:this.moveChild,onDragEnd:this.onDragEnd,onDragOut:this.onDragOut,ref:"sortList",getDragTargetFromElement:this.getDragTargetFromElement,classDragging:"c-foreground-very-faded"},l)),u.a.createElement("div",{className:"flexbox flexvert height100"},u.a.createElement(S.a,{raised:!0,round:!1,icon:m,onClick:this.onClickMoveToOtherList})),u.a.createElement("div",{className:"agendaSortListWrapper flexbox flexvert f1"},u.a.createElement("div",{className:"bold"},"Not on Agenda"),u.a.createElement(Ee,{className:"agendaSortList agendaSortList f1 c-border-light",moveChild:this.moveChild,onDragEnd:this.onDragEnd,onDragOut:this.onDragOut,ref:"nonSortList",getDragTargetFromElement:this.getDragTargetFromElement,classDragging:"c-foreground-very-faded"},s))))}}]),a}(w.a),xe=[D()({},o.a.DateFormat.MDY,"M/D/Y"),D()({},o.a.DateFormat.DMY,"D/M/Y"),D()({},o.a.DateFormat.DMYDot,"D.M.Y"),D()({},o.a.DateFormat.YMD,"Y/M/D"),D()({},o.a.DateFormat.YMDDot,"Y.M.D")],De=[{Sunday:"Sunday"},{Monday:"Monday"}],we=Object(N.b)((function(){return u.a.createElement("div",{key:"content"},u.a.createElement(F,{title:"Date format",valueObservable:l.default.settings.dateFormat,options:xe,style:{width:80},styleTitle:{width:100}}),u.a.createElement(F,{title:"Start week on",valueObservable:l.default.settings.dayWeekStart,getValueFromSelected:function(e){return"Monday"===e?1:0},getSelectedFromObservable:function(e){return 1===e?"Monday":"Sunday"},options:De,style:{width:80},styleTitle:{width:100}}),u.a.createElement(ie,{title:"Number of days in custom calendar view (Premium)",className:"py-4",valueObservable:l.default.settings.calendarCustomDays,minValue:1,maxValue:14,readonly:!l.default.billingManager.hasPremiumFeatures()}),s.a.supportsNotifications()&&u.a.createElement(u.a.Fragment,null,u.a.createElement("hr",null),u.a.createElement(R,{checkedObservable:l.default.settings.disableNotifications,title:"Enable notifications",description:"Display native notifications for items that use a specific @date and time in their text. These are only displayed for the currently open document on this device.",getCheckedFromObservable:function(e){return!e},getValueFromChecked:function(e){return!e},onChange:function(e){e?s.a.usesHTML5Notifications()?s.a.hasNotificationPermission()||Notification.requestPermission((function(e){"granted"===e?l.default.timeline.updateNotifications():(l.default.settings.disableNotifications.set(!0),l.default.toasts.pushMessage({text:"To enable notifications in the future, you must first give permission in your browser.",action:o.a.MessageAction.OpenURL,actionText:"LEARN MORE",data:{url:"https://support.google.com/chrome/answer/6148059"}}))})):l.default.timeline.updateNotifications():l.default.timeline.clearNotifications()}}),u.a.createElement(ie,{title:"Notification time",valueObservable:l.default.settings.notificationDelay,minValue:0,maxValue:120,interval:5,description:"Time in minutes before event to display a notification about the event.",onChange:function(e){i.default.sendEvent("NotificationDelay","Changed",e)}})))})),Se=a(154),Me=a(25);var Ne=["Minutes","Hours","Days"],Pe=function(e){return"Days"===e&&o.a.MSPerDay||"Hours"===e&&o.a.MSPerHour||"Minutes"===e&&o.a.MSPerMinute},Ie=Object(N.b)((function(){var e=this,t=Object(c.useState)((function(){var e,t=Se.a.getLastBackup();if(t>0){var a=new Date(t);e=Me.a.toHumanText(a)}else e="Not backed up";return e})),a=r()(t,2),n=a[0],s=a[1],d=Object(P.a)(l.default.settings.backupFrequency),m=r()(d,1)[0],h=function(e,t){var a=Object(c.useMemo)((function(){return new I.a(e)}),[]);if(t){var n=Object(P.a)(a),i=r()(n,1)[0];return e!==i&&a.set(e),[a,i]}return[a]}(function(e){return e>=o.a.MSPerDay?"Days":e>=o.a.MSPerHour?"Hours":e>=0?"Minutes":void 0}(m),!0),f=r()(h,2),p=f[0],g=f[1],v=Math.floor(m);console.log("backup frequency",m);var y=Object(c.useCallback)((function(e){if(e&&!i.default.isDemoMode()){var t=function(){l.default.settings.backupFrequency.set(o.a.DefaultBackupFrequency)};Se.a.isDriveBackupAuthorized()?t():Se.a.authorize((function(e){e?t():l.default.settings.backupFrequency.set(0)}))}}),[]),E=Object(c.useCallback)((function(e){return Math.floor(e/Pe(g))}),[g]),k=Object(c.useCallback)((function(e){return Math.floor(e*Pe(g))}),[g]),C=Object(c.useCallback)((function(e,t){return l.default.settings.backupFrequency.set(v/Pe(t)*Pe(e))}),[v]);return u.a.createElement("div",{key:"content"},u.a.createElement(R,{checkedObservable:l.default.settings.backupFrequency,getCheckedFromObservable:function(e){return e>0},getValueFromChecked:function(e){return e?o.a.DefaultBackupFrequency:0},title:"Enable Drive backups",description:'Automatically backup all data into the "Moo.do Backups" folder in your Google Drive. Backups will run on the following frequency, only if there are any new changes to back up. Moo.do keeps its own encrypted revision history, but this gives you an extra level of security that your data is safe. Note that backups to Drive are not encrypted.',onChange:y}),u.a.createElement("div",null,u.a.createElement("div",{className:"settingsName ib bold"},"Every"),u.a.createElement(ie,{className:"ib",valueObservable:l.default.settings.backupFrequency,getNumberFromObservable:E,getValueFromNumber:k,minValue:0,maxValue:60,interval:1}),u.a.createElement(F,{className:"ib",valueObservable:p,options:Ne,style:{marginLeft:16,height:32},onChange:C})),u.a.createElement("div",{className:"py-4"},u.a.createElement(S.a,{raised:!0,onClick:function(){s("Backing up..."),Se.a.backupAll().then((function(){return e.backupText.set("Backup complete")}))}},"BACKUP NOW"),n&&u.a.createElement("div",{className:"pt-2"},n)),u.a.createElement("div",{className:"py-4"},u.a.createElement(S.a,{raised:!0,onClick:function(){l.default.menus.closeModal(o.a.Modals.Settings),l.default.menus.openModal(o.a.Modals.Backups)}},"SEE BACKUP HISTORY")))})),Te=a(76);function Ae(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=b()(e);if(t){var r=b()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return k()(this,a)}}var Re=function(e){y()(a,e);var t=Ae(a);function a(){return f()(this,a),t.apply(this,arguments)}return g()(a,[{key:"init",value:function(){this.createObservables({error:"",isChanging:!1}),l.default.onIntroAction("Encryption")}},{key:"getState",value:function(){var e=l.default.settings.encryptionKeys;return{encryptionKeys:e,hasUserPassword:e.get()&&!!e.get()[o.a.EncryptionKeys.UserPassword]}}},{key:"onClickSave",value:function(e,t){var a=this,n=this.refs.pass1.getValue(),r=this.refs.pass2.getValue(),s=o.a.EncryptionKeys.UserPassword;if(n){if(n!==r)this.error.set("Passwords do not match");else if(n.length<5)this.error.set("Password is too short. Please enter a longer password to make it secure.");else if(!i.default.isDemoMode())return l.default.menus.confirmEncrypt(n,(function(e){e?Se.a.backupAuto().then((function(){(a.state.isChanging?l.default.crypto.updateKey:l.default.crypto.addKey)({name:s,password:n,sentinelSalt:U.a.getEncryptionUid()}).then((function(e){Te.a.updateUserEncryption(e).then((function(){a.isChanging.set(!1),t()}))}))})):t()})),!0}else this.error.set("No password entered")}},{key:"onClickContact",value:function(){l.default.menus.openModal(o.a.Modals.ReportBug)}},{key:"onClickChange",value:function(){this.isChanging.set(!0)}},{key:"onClickRemove",value:function(e,t){l.default.menus.confirm("Are you sure you want to remove your encryption password?",(function(e){e?Te.a.updateUserEncryption(l.default.crypto.getGlobalKeyInfo()).then((function(){t()})):t()}))}},{key:"render",value:function(){var e=this.state,t=!e.hasUserPassword||e.isChanging,a={marginTop:8,width:240};return c.createElement("div",{key:"content"},c.createElement("div",{className:"modal-row"},t?c.createElement(c.Fragment,null,c.createElement("div",null,c.createElement("div",{className:"settingsName ib bold"},"Encrypt data with a password"),c.createElement("div",{className:"modal-subtext c-foreground-faded"},"Your data is encrypted client-side before sending it to the database. For an extra level of security, you can enter your own password for the encryption. This makes it so that even the developers cannot read your data, and it cannot be recovered.")),c.createElement("div",{style:{marginTop:16}},c.createElement(K.a,{type:"password",placeholder:"Password",ref:"pass1",style:a,onButtonClick:this.onClickSave}),c.createElement(K.a,{type:"password",placeholder:"Confirm Password",ref:"pass2",style:a,onButtonClick:this.onClickSave})),e.error&&c.createElement("div",{className:"error",style:{marginTop:8}},e.error),c.createElement("div",{className:"modal-warning flexbox c-warning"},c.createElement("i",{className:"icon-warning"}),c.createElement("div",null,"If you lose this password, all your data will be lost! For your security, Moo.do cannot recover your password, so keep your password safe. This is competely optional (see above).")),c.createElement("div",{style:{marginTop:8}},c.createElement(S.a,{raised:!0,primary:!0,onClick:this.onClickSave},"Save"))):c.createElement(c.Fragment,null,c.createElement("div",null,c.createElement("div",{className:"settingsName ib bold"},"Your data is encrypted with your password"),c.createElement("div",{style:{marginTop:16}},c.createElement(S.a,{raised:!0,primary:!0,onClick:this.onClickChange},"Change"),c.createElement(S.a,{raised:!0,cancel:!0,marginLeft:16,onClick:this.onClickRemove},"Remove"))))))}}]),a}(w.a),Oe=a(15),Le=Object(N.b)((function(){return u.a.createElement("div",{key:"content"},u.a.createElement("div",{className:"modal-row"},u.a.createElement("div",{style:{marginTop:8}},u.a.createElement(S.a,{raised:!0,onClick:function(){l.default.menus.confirm("This will clear your local data and sign you out. Are you sure?",(function(e){e&&Oe.a.clearLocalData()}))}},"Clear Local Data")),u.a.createElement(R,{checkedObservable:l.default.settings.showDebugInfo,title:"Show Extra Debug Info",description:"Only enable this if the developers asked you for help tracking down an issue."}),u.a.createElement(R,{checkedObservable:l.default.settings.disableAnimations,title:"Disable animations",description:"Disable pane and item animations."})))})),Fe=o.a.KeyCode,_e=Object(N.b)((function(e){var t=e.className,a=e.style,n=e.value,d=e.width,m=e.height,h=e.fontSize,f=e.border,p=e.onChange,g=e.backgroundTheme,v=e.disabled,y=e.requiresModifier,E=Object(c.useState)(n),k=r()(E,2),C=k[0],b=k[1],x=Object(c.useState)(),D=r()(x,2),w=D[0],S=D[1],M=Object(c.useRef)(),N=function(){i.default.batchRenderUpdates((function(){b(""),p("")})),M.current.blur()},P=C?l.default.hotkeys.printHotkey(C):"";return u.a.createElement(K.a,{className:t,placeholder:"Enter a hotkey",width:d,value:P,onKeyDown:function(e){if(e.keyCode!==Fe.Ctrl&&e.keyCode!==Fe.LeftMeta&&e.keyCode!==Fe.Alt&&e.keyCode!==Fe.Shift&&(!y||e.metaKey||e.ctrlKey||e.altKey)){var t=function(e){var t=[],a=s.a.mac;(a&&e.metaKey||!a&&e.ctrlKey)&&t.push("Pr"),(a&&e.ctrlKey||!a&&e.altKey)&&t.push("Se"),a&&e.altKey&&t.push("Op"),e.shiftKey&&t.push("Sh");var n=e.nativeEvent.code.replace("Key","").replace("Digit","D");if("NumpadEnter"===n&&(n="Enter"),o.a.KeyCode[n])return t.push(n.capitalize()),t.join("+");l.default.toasts.pushMessage("Key unsupported: "+n+" "+e.keyCode)}(e);t&&(!1!==p(t)?b(t):b(""))}else e.keyCode===Fe.Delete||e.keyCode===Fe.Backspace?N():e.keyCode===Fe.Escape?(b(n),M.current.blur()):b(n);e.preventDefault()},style:Object.assign({caretColor:"transparent"},a),onFocus:function(){S(!0)},onBlur:function(){i.default.batchRenderUpdates((function(){""===C&&b(n),S(!1)}))},border:f,backgroundTheme:g,height:m,fontSize:h,disabled:v,ref:M,buttonText:w?"X":void 0,onButtonClick:N,blurOnEscape:!0})})),Ge=a(169),Be=Object(N.b)((function(){Object(c.useRef)();var e=Object(c.useState)(""),t=r()(e,2),a=t[0],n=t[1],i=Object(c.useState)(""),o=r()(i,2),d=o[0],m=o[1],h=Object(P.a)(l.default.settings.appHotkeys),f=r()(h,1)[0];Object(c.useEffect)((function(){l.default.ElectronBridge.getPrefs((function(e){n(e.backupDir),m(e.docsDir)}))}),[]);var p=function(e){return function(t){if(t){if(f.newEmail===t||f.newItem===t)return!1;l.default.settings.appHotkeys.setProperty(e,t)}else l.default.settings.appHotkeys.deleteProperty(e)}};return u.a.createElement("div",{key:"content"},u.a.createElement(R,{checkedObservable:l.default.settings.backupLocal,title:"Enable automatic backups",description:"Backups saved in: ".concat(a)}),u.a.createElement(R,{checkedObservable:l.default.settings.appSystemDarkMode,title:"Use system dark mode setting",onChange:function(e){e&&l.default.DisplaySettings.setSystemDarkMode(l.default.ElectronBridge.getDarkMode())}}),s.a.supportLocalFiles()&&u.a.createElement(u.a.Fragment,null,u.a.createElement("div",{className:"modal-row mt-8"},u.a.createElement("div",{className:"settingsName ib bold",style:{marginBottom:8}},"Save local files in:"),u.a.createElement(K.a,{readonly:!0,value:d,buttonText:"CHANGE",onButtonClick:function(){l.default.ElectronBridge.openDirectoryDialog((function(e){var t=e.filePaths[0];if(t){var a=!1,n=function(){console.log("setting docs folder to",t),l.default.ElectronBridge.setDocsFolder(t,a,(function(e){e||(m(t),Ge.a.reload())}))};Ge.a.numDocuments()>0?l.default.menus.confirm("Do you want move existing files to the new folder?",(function(e){a=e,n()})):n()}}))}})),u.a.createElement(R,{checkedObservable:l.default.settings.encryptLocalFiles,title:"Encrypt local files"})),u.a.createElement("div",{className:"mt-8"},u.a.createElement("div",{className:"text-xl font-bold"},"Global hotkeys"),u.a.createElement("div",{className:"flex my-4 items-center"},u.a.createElement("span",{className:"font-bold",style:{width:80}},"New Item:"),u.a.createElement(_e,{className:"mx-4",value:f.newItem,width:150,requiresModifier:!0,onChange:p("newItem")})),u.a.createElement("div",{className:"flex my-4 items-center"},u.a.createElement("span",{className:"font-bold",style:{width:80}},"New Email:"),u.a.createElement(_e,{className:"mx-4",value:f.newEmail,width:150,requiresModifier:!0,onChange:p("newEmail")}))))})),Ue=u.a.createContext([]),je=Object(N.b)((function(e){var t=e.className,a=e.columnOptions,n=e.header,r=e.borderLeft,o=e.borderRight,l=e.children,s=i.default.classNames(t,"border-b c-border-heavy borderBox",{"border-l":r},{"border-r":o},{f1:a.flex}),c={minWidth:a.width||a.minWidth,maxWidth:a.width};return(n||a.padded)&&(c.paddingLeft=12,c.paddingRight=12),u.a.createElement("div",{className:s,style:c},l)})),Ve=Object(N.a)(Object(c.forwardRef)((function(e,t){var a=e.className,n=e.header,r=e.children,o=Object(c.useContext)(Ue),l=i.default.classNames("flex",a),s=u.a.Children.toArray(r);return u.a.createElement("div",{className:l,ref:t},o.map((function(e,t){return s[t]?u.a.cloneElement(s[t],Object.assign({borderLeft:t>0,borderRight:s.length>1&&t<o.length-1,columnOptions:e,header:n},s[t].props)):u.a.createElement(je,{key:t,columnOptions:e})})))}))),He=Object(N.b)((function(e){var t=e.className,a=e.columnOptions,n=e.children,r=i.default.classNames(t,"c-border-heavy");return u.a.createElement(Ue.Provider,{value:a},u.a.createElement("div",{className:r},n))})),Ke=a(412),We=a.n(Ke),ze=a(90),Ye=["","Command","Key 1","Key 2","Key 3","Key 4"],qe=[{width:50},{minWidth:160,padded:!0,flex:!0},{width:100},{width:100},{width:100},{width:100}],Ze=function(e,t,a,n){var r=l.default.hotkeys.config,o=i.default.clone(r[e][t]);if(o[a]=n,o=o.filter((function(e){return!!e})),!1===l.default.hotkeys.setHotkey(e,t,o))return l.default.toasts.pushMessage("This hotkey is already taken"),!1},Xe=function(e,t,a){l.default.hotkeys.resetHotkey(e,t)},Je=Object(N.b)((function(e){var t=this,a=e.group,n=e.name,o=e.hasPremiumFeatures,s=e.requiresModifier,c=e.config,d=Object(ze.a)(),m=r()(d,2),h=m[0],f=m[1];return u.a.createElement(Ve,{key:n,ref:h},u.a.createElement(je,null,c!==l.default.hotkeys.defaultConfig[a][n]&&u.a.createElement(S.a,{padding:0,width:50,height:30,cancel:!0,display:"block",onClick:Xe.bind(this,a,n)},"Reset")),u.a.createElement(je,null,i.default.addSpacesToCamelCase(n)),c.map((function(e,r){return u.a.createElement(je,{key:e},u.a.createElement(_e,{value:e,onChange:Ze.bind(t,a,n,r),border:!1,backgroundTheme:"c-bg-light",height:30,fontSize:13,disabled:!o,requiresModifier:s}))})),f&&o&&c.length<4&&u.a.createElement(je,null,u.a.createElement(_e,{value:"",onChange:Ze.bind(this,a,n,c.length),border:!1,backgroundTheme:"c-bg-light",height:30,fontSize:13,requiresModifier:s})))})),Qe=Object(N.b)((function(e){var t=e.openSection,a=Object(P.a)(l.default.settings.hotkeys,l.default.billingManager.hasPremiumFeaturesObservable),n=r()(a,2),i=(n[0],n[1]),o=l.default.hotkeys.config;return u.a.createElement("div",{key:"content"},!i&&u.a.createElement("div",{className:"c-bg-autocomplete-highlight rounded-lg flex items-center mb-4 py-2 px-4"},u.a.createElement("div",{className:"flex-1"},"Custom Hotkeys is a Premium feature."),u.a.createElement(S.a,{raised:!0,primary:!0,onClick:function(){t("Account")}},"GO PREMIUM")),u.a.createElement("div",{className:"text-xl bold"},"Customize Hotkeys"),u.a.createElement("div",{className:"c-foreground-light text-xs pt-1 leading-tight pb-4 pt-2"},"Click on any key to change it."),u.a.createElement(He,{columnOptions:qe,className:We.a.table},u.a.createElement(Ve,{header:!0},Ye.map((function(e,t){return u.a.createElement(je,{key:e},e)}))),Object.keys(o).map((function(e){return u.a.createElement(u.a.Fragment,{key:e},u.a.createElement(Ve,null,u.a.createElement(je,{className:"bold px-2 text-lg leading-loose"},e)),Object.keys(o[e]).map((function(t){return u.a.createElement(Je,{key:t,group:e,name:t,requiresModifier:"Email"!==e,hasPremiumFeatures:i,config:o[e][t]})})))}))))})),$e=a(397),et=a(155);t.default=Object(N.b)((function(e){var t=e.section,a=Object(c.useState)(t||"General"),n=r()(a,2),h=n[0],f=n[1],p=P.a.apply(this,d.a.pluginsAvailable.map((function(e){return d.a.getPluginEnabledObservable(e)}))),g=function(e){return p[d.a.pluginsAvailable.indexOf(e)]},v=function(e){var t=!d.a.isSaveEnabled.get();t||l.default.menus.confirm("You have unsaved changes. Are you sure you want to cancel your changes?",(function(t){t&&(d.a.isSaveEnabled.set(!1),f(e))})),t&&f(e)},y=function(e){return function(){return v(e)}},E="General"===h&&B||"Plugins"===h&&q||"Invite"===h&&m.a||"Feedback"===h&&ne||"Account"===h&&ae||"Calendar"===h&&le||"Contacts"===h&&ce||"Gmail"===h&&ue||"Agenda"===h&&be||"Dates"===h&&we||"Backups"===h&&Ie||"Security"===h&&Re||"Debug"===h&&Le||"Desktop"===h&&Be||"Hotkeys"===h&&Qe;var k=function(e){var t=("Plugins"===e?"Sync Plugins":"Account"===e&&"Moo.do Account")||"Feedback"===e&&"Send Feedback"||"Invite"===e&&"Invite Friends"||"Desktop"===e&&"Desktop App"||e;return u.a.createElement(et.a,{name:e,onClick:y(e)},u.a.createElement("span",null,t))},C=function(e,t){var a=l.default.pluginManager.getPlugin(e),n=a&&a.hasSettingsError(),r="Calendar"===t?"Google Calendar":t,i=u.a.createElement("span",null,r);return n&&(i=u.a.createElement("span",null,i,u.a.createElement("span",{className:"error icon-warning"}))),u.a.createElement(et.a,{name:t,onClick:y(t)},i)};return u.a.createElement($e.a,{id:"modalSettings",width:900,height:900,sidebarWidth:180,modalID:o.a.Modals.Settings,scrollable:!0},u.a.createElement("div",{key:"sidebar"},u.a.createElement(et.b,{inset:!0,selected:h},u.a.createElement(et.a,{type:"header"},"SETTINGS"),k("General"),k("Dates"),k("Agenda"),s.a.isNativeApp()&&k("Desktop"),k("Backups"),!i.default.isDemoMode()&&k("Account"),k("Security"),k("Hotkeys"),u.a.createElement(et.a,{type:"header"},"PLUGINS"),k("Plugins"),g(o.a.PluginID.GCalendar)&&C(o.a.PluginID.GCalendar,"Calendar"),g(o.a.PluginID.Contacts)&&C(o.a.PluginID.Contacts,"Contacts"),g(o.a.PluginID.Gmail)&&C(o.a.PluginID.Gmail,"Gmail"),u.a.createElement(et.a,{type:"header"},"SUPPORT"),k("Feedback"),k("Debug"))),u.a.createElement("div",{key:"content"},i.default.isDemoMode()&&u.a.createElement("div",{className:"flex justify-center pb-6"},u.a.createElement("div",{className:"c-bg-lighter px-6 py-3 rounded-lg font-medium"},"Demo Mode: Settings will not be saved")),u.a.createElement(E,{openSection:v})))}))},450:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(6),o=a.n(i),l=a(13),s=a.n(l),c=a(19),u=a.n(c),d=a(66),m=a.n(d),h=a(1),f=a(3),p=a.n(f),g=a(4),v=a(20),y=a(86),E=a(397),k=a(31),C=a(73);function b(e){var t=Object(f.useState)({}),a=u()(t,2),n=a[0],r=a[1],i=function(){var e=Object(f.useRef)(!1),t=Object(f.useCallback)((function(){return e.current}),[]);return Object(f.useEffect)((function(){return e.current=!0,function(){e.current=!1}})),t}();return Object(f.useEffect)((function(){s()(o.a.mark((function t(){var a;return o.a.wrap((function(t){for(var n=0;;){if(n++>5e3&&__infLoop&&__infLoop(n))throw new RangeError;switch(t.prev=t.next){case 0:if(!i()){t.next=11;break}return t.prev=1,t.next=4,e();case 4:a=t.sent,i()&&r(a),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),r({error:t.t0});case 11:case"end":return t.stop()}}}),t,null,[[1,8]])})))()}),[]),n}var x=a(21),D=a(94);t.default=Object(x.b)((function(e){var t,a,n=e.folder,i=m()(e,["folder"]),l=b((function(){return C.a.getTemplateProperties(n.id)})),c=l.value,d=l.error,x=Object(f.useState)(),w=u()(x,2),S=w[0],M=w[1],N=Object(f.useState)(),P=u()(N,2),I=P[0],T=P[1],A=Object(f.useRef)();if((c||I)&&(t=p.a.createElement(p.a.Fragment,null,p.a.createElement("div",null,"You can share the template created from this board folder with the following URL:"),p.a.createElement("div",{className:"mt-4"},p.a.createElement(y.a,{readonly:!0,value:"".concat(window.location.origin,"/template/?").concat(n.id)})))),void 0===c&&void 0===d)a=p.a.createElement(D.a,{center:!0},"Checking for existing template");else if(d){var R;R="auth/network-request-failed"===(null===d||void 0===d?void 0:d.code)?"Error communicating with server. Please ensure you are online and try again.":"Error: "+JSON.stringify(d),a=p.a.createElement("div",null,R)}else I||(a=p.a.createElement(p.a.Fragment,null,c?p.a.createElement("div",{className:"mb-4 mt-4"},"Clicking SAVE will update the documents and boards in this saved template."):p.a.createElement("div",{className:"mb-8"},"This will create a new template that you can share publicly or with your friends. All data in the documents open in these boards will be copied into the template, but it will not continue to sync. If you'd like to update the template you can open this menu again."),p.a.createElement(y.a,{focused:!0,ref:A,placeholder:"Enter a name for your template",value:null===c||void 0===c?void 0:c.name}),S&&p.a.createElement("div",{className:"error mt-4"},S)));return p.a.createElement(E.a,r()({},i,{id:"modalCreateTemplate",title:"Create template",small:!0,minHeight:200,width:500,scrollable:!1,modalID:h.a.Modals.CreateTemplate}),p.a.createElement("div",{key:"content"},t,a,I&&p.a.createElement("div",{className:"mt-4 center"},"SAVED")),void 0!==c&&!I&&p.a.createElement("div",{key:"buttons"},p.a.createElement(v.a,{primary:!0,width:100,onClick:function(e,t){var a=A.current.getValue();if(a||c){M(void 0);var r=function(){var e=s()(o.a.mark((function e(){var r,i;return o.a.wrap((function(e){for(var o=0;;){if(o++>5e3&&__infLoop&&__infLoop(o))throw new RangeError;switch(e.prev=e.next){case 0:return e.next=2,k.a.getBoardFolderAsTemplate(n);case 2:return r=e.sent,e.next=5,C.a.createTemplate(n.id,a,null===c||void 0===c?void 0:c.created,JSON.stringify(r));case 5:(i=e.sent).value?(console.log("updated"),T(!0)):M("Error creating template: "+i.error),t();case 8:case"end":return e.stop()}}}),e)})));return function(){return e.apply(this,arguments)}}();c?g.default.menus.confirm("Are you sure you want to overwrite the existing template?",(function(e){e&&r()})):r()}else M("Please enter a template name");return!0}},"SAVE"),p.a.createElement(v.a,{cancel:!0,width:100,onClick:function(){return g.default.menus.closeModal(h.a.Modals.CreateTemplate)}},"CANCEL")))}))},451:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(66),o=a.n(i),l=a(7),s=a.n(l),c=a(8),u=a.n(c),d=a(17),m=a.n(d),h=a(18),f=a.n(h),p=a(9),g=a.n(p),v=a(0),y=a(1),E=a(4),k=a(15),C=a(3),b=a.n(C),x=a(33),D=a(10),w=a(28),S=a(117),M=a(406);function N(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=g()(e);if(t){var r=g()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return f()(this,a)}}var P=function(e){m()(a,e);var t=N(a);function a(){return s()(this,a),t.apply(this,arguments)}return u()(a,[{key:"onFocus",value:function(){var e=this.props.component.refs[this.props.target];e&&e.focus()}},{key:"render",value:function(){return b.a.createElement("input",{className:"fancyFocusGuard",onFocus:this.onFocus,tabIndex:this.props.tabIndex})}}]),a}(x.a),I=a(140),T=a(86),A=a(20),R=a(70),O=a(181);function L(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=g()(e);if(t){var r=g()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return f()(this,a)}}var F=function(e){m()(a,e);var t=L(a);function a(){return s()(this,a),t.apply(this,arguments)}return u()(a,[{key:"init",value:function(){var e=this.props.item,t=E.default.pluginManager.getPlugin(y.a.PluginID.GCalendar);this.createObservables({canSyncDate:e&&!!e.getMooDate(),addingLocal:!t.isActive()||E.default.pluginManager.getSetting(y.a.PluginID.GCalendar,y.a.PluginSettingsID.GCalendar.CreateLocalEvents),addingRemote:t.isActive()&&E.default.pluginManager.getSetting(y.a.PluginID.GCalendar,y.a.PluginSettingsID.GCalendar.SyncNewEvents),selectedDocument:e&&e.getDocumentOwner()?e.getDocumentOwner():k.a.getDefaultDocument()}),this.refSelectCalendar=Object(C.createRef)(),this.refSelectDocument=Object(C.createRef)(),this.refMenu=Object(C.createRef)(),this.refItem=Object(C.createRef)(),this.refAddTo=Object(C.createRef)(),this.refNoteText=Object(C.createRef)(),this.refCheckAddLocal=Object(C.createRef)(),this.refCheckAddCalendar=Object(C.createRef)(),this.refSave=Object(C.createRef)()}},{key:"getHotkeys",value:function(){return[E.default.hotkeys.create(y.a.KeyCode.Escape,!0,y.a.Primary.Either,y.a.Shift.Either,this.onEscape),E.default.hotkeys.create(y.a.KeyCode.D,!0,y.a.Primary.Yes,y.a.Shift.Yes,this.onHotkeyDate),E.default.hotkeys.create(y.a.KeyCode.C,!0,y.a.Primary.Never,y.a.Shift.No,this.onHotkeyCreateEvent)]}},{key:"getState",value:function(){var e=this.props.item;return{flags:e.flags,maxWidth:this.props.pane?Math.min(this.props.pane.getWidth()-20,400):400,isStarred:e.isStarred(),priority:e.getPriority()}}},{key:"onMount",value:function(){this.props.item.itemChanged.listen(this.onItemChanged),D.a.windowSize.listen(this.onResize),w.a.listen("panesChanged",this.onResize)}},{key:"onResize",value:function(){var e=this;this.updateState(),setTimeout((function(){e.refMenu&&e.refMenu.current.updateState()}),300)}},{key:"onUnmount",value:function(){this.props.item.itemChanged.unlisten(this.onItemChanged);var e=this.props;if(e.addOnSave&&this.needsSave){var t=this.addItem(),a=t.item,n=t.parent,r=t.insertIndex;e.beginSave&&e.beginSave();try{var i=e.options;if(i)for(var o=0,l=0;l<i.length;l++){if(o++>5e3&&__infLoop&&__infLoop(o))throw new RangeError;var s=i[l],c=this.refs[s.text];if(c&&c.getValue())try{s.cb(a)}catch(g){v.default.reportError(g)}}if(e.children)for(var u=0,d=0;d<e.children.length;d++){if(u++>5e3&&__infLoop&&__infLoop(u))throw new RangeError;var m=e.children[d].clone(a,y.a.ChangeType.Local);a.insertItem(m)}var h=E.default.pluginManager.getPluginGCalendar(),f=this.refCheckAddCalendar.current;if(h&&h.isAvailable()&&f&&f.getValue()&&this.refSelectCalendar.current){var p=this.refSelectCalendar.current.getValue();h.createEventForItem(a,p),h.forceRemoteEventSync()}isNaN(r)||n.insertItem(a,r)}catch(k){v.default.reportError(k)}e.endSave&&e.endSave(a)}D.a.windowSize.unlisten(this.onResize),w.a.unlisten("panesChanged",this.onResize)}},{key:"onItemChanged",value:function(){var e=this.props.item;this.canSyncDate.set(!!e.getMooDate())}},{key:"onHotkeyDate",value:function(){E.default.menus.openDate({element:this.refItem.current.getElement(),item:this.props.item,pane:this.props.pane})}},{key:"onHotkeyCreateEvent",value:function(){var e=E.default.pluginManager.getPluginGCalendar(),t=this.props.item;e&&(this.props.addOnSave?this.state.canSyncDate&&this.refCheckAddCalendar.current&&this.refCheckAddCalendar.current.setValue(!0):(e.createEventForItem(t),t.itemChanged.notify()))}},{key:"onKeyDownItem",value:function(e){D.a.getKeyCode(e)===y.a.KeyCode.Enter?(this.save(),e.preventDefault()):this.wasAKeyPressed=!0}},{key:"save",value:function(){this.props.item.hasText()?(this.needsSave=!0,E.default.menus.closeContextMenu()):E.default.toasts.pushMessage({text:"Please enter text for the item before adding it.",timeout:2e3})}},{key:"addItem",value:function(){var e=this.props.item,t=!0,a=E.default.pluginManager.getPluginGCalendar();if(a&&a.isAvailable()&&this.refCheckAddLocal.current&&(t=this.refCheckAddLocal.current.getValue()),e.getRawText().length>0){if(t){var n=this.props.parent,r=this.refAddTo.current.getItem();if(r&&(n=r.item),this.props.selectDocument&&!r)n=k.a.getDocumentById(this.refSelectDocument.current.getValue()).getRootItem();var i=e.clone(n,y.a.ChangeType.AllLocal),o=this.refNoteText.current.getValue();if(o){var l=i.createNote();l&&l.setText(o,y.a.ChangeType.Local)}return{item:i,parent:n,insertIndex:0}}return{item:e}}return{}}},{key:"onEscape",value:function(){this.wasEscapeKeyPressed=!0,E.default.menus.closeContextMenu()}},{key:"onNoteValueSet",value:function(){this.refMenu.current.updateState()}},{key:"onKeyDownNote",value:function(e){D.a.getKeyCode(e)===y.a.KeyCode.Enter&&(D.a.mac&&e.metaKey||!D.a.mac&&e.ctrlKey)&&this.save()}},{key:"onClickStar",value:function(){var e=this.props.item;e.setStarred(!e.isStarred(),y.a.ChangeType.Local)}},{key:"setPriority",value:function(e){var t=this.props.item;t.getPriority()===e&&(e=y.a.VMLIFlag.None),t.setPriority(e,y.a.ChangeType.Local)}},{key:"onChangeAddToCalendar",value:function(e){!e&&this.refCheckAddLocal.current&&this.refCheckAddLocal.current.setValue(!0),this.addingRemote.set(e)}},{key:"onChangeAddLocal",value:function(e){!e&&this.refCheckAddCalendar&&this.refCheckAddCalendar.current.setValue(!0),this.addingLocal.set(e)}},{key:"onChangeCalendar",value:function(e){if(!this.props.addOnSave){var t=this.props.item;E.default.pluginManager.getPluginGCalendar().setCalendarForItem(t,e)}}},{key:"onChangeDocument",value:function(e){this.selectedDocument.set(k.a.getDocumentById(e))}},{key:"renderCalendarSelector",value:function(){var e=this.props,t=e.item,a=e.addOnSave,n=this.state.addingRemote,r=E.default.pluginManager.getPluginGCalendar().getWriteableCalendarsForItem(t),i=r.calendars,o=r.selected;!o&&a&&(o=E.default.pluginManager.getSetting(y.a.PluginID.GCalendar,y.a.PluginSettingsID.GCalendar.ExportCalendar));var l=v.default.classNames("c-foreground-faded",{disabled:!n});return i?b.a.createElement("div",{className:"detailsSection flexbox"},b.a.createElement("span",{className:l},"Calendar:"),b.a.createElement(O.a,{defaultValue:o,style:{marginLeft:16,height:32},ref:this.refSelectCalendar,onChange:this.onChangeCalendar,disabled:!n},b.a.createElement("option",{value:""},"None"),i.map((function(e){return b.a.createElement("option",{key:e.id,value:e.id},e.summary)})))):void 0}},{key:"render",value:function(){var e,t=this.props,a=t.addOnSave,n=t.pane,i=t.item,l=t.selectDocument,s=o()(t,["addOnSave","pane","item","selectDocument"]),c=this.state,u=c.addingLocal,d=c.addingRemote,m=c.canSyncDate,h=c.priority,f=c.isStarred,p=c.selectedDocument,g=this.state.maxWidth,C=v.default.parentTextForItem(i),x=s.children||(n?n.getSubItems(i,!0):[]),D=i.allowTextEditing(),w=D&&(i.canHaveNote()||i.hasNote()),N=(m=m,E.default.pluginManager.getPlugin(y.a.PluginID.GCalendar)),L=N&&N.isAvailable()&&N.isEnabled(),F=L&&(m||s.showCalendarButtons),_=i.hasPluginAttachment(y.a.PluginID.GCalendar);if(x.length>0){var G=0;e=[];for(var B=0;B<x.length;B++){if(G++>5e3&&__infLoop&&__infLoop(G))throw new RangeError;var U=x[B];e.push(b.a.createElement(S.a,{key:U.id,item:U,pane:n,padded:!0,allowDrag:!1}))}}var j,V=10,H=v.default.classNames("c-foreground-faded",{disabled:!u});return l&&(j=k.a.getDocumentsArray()),b.a.createElement(R.a,r()({},s,{key:i.id+"_Edit",id:"contextMenuItemDetails",className:"flexbox flexvert",width:400,maxWidth:g,onEscape:this.onEscape,ref:this.refMenu}),b.a.createElement(P,{component:this,target:"buttonSave",tabIndex:V++}),C&&b.a.createElement("div",{className:"detailsSection flexbox itemContext c-foreground-faded"},b.a.createElement("div",{className:"c-foreground-faded"},"Parents"),b.a.createElement("div",null,C)),b.a.createElement("div",{className:"detailsSection flexbox noShrink"},b.a.createElement("div",{className:"c-foreground-faded"},"Item text"),b.a.createElement(S.a,{ref:this.refItem,className:"detailsItem c-background c-border",item:i,onKeyDown:this.onKeyDownItem,selectIndex:s.selectIndex,showPriority:!0,shouldSave:!a,autocompleteMode:"all",tabIndex:V,inItemDetails:!0,allowDrag:!a,pane:n,editable:D})),l&&b.a.createElement("div",{className:"detailsSection flexbox"},b.a.createElement("div",{className:H},"Document"),b.a.createElement(O.a,{className:"f1",ref:this.refSelectDocument,style:{height:32},defaultValue:p.id,onChange:this.onChangeDocument},j.map((function(e){return b.a.createElement("option",{key:e.id,value:e.id},e.text.get())})))),a&&b.a.createElement("div",{className:"detailsSection flexbox"},b.a.createElement("div",{className:H},"Add to"),b.a.createElement(T.a,{autocompleteMode:"item",autocompleteItem:p.getRootItem(),height:33,placeholder:"Select item to add to",tabIndex:V++,ref:this.refAddTo,pane:this.props.pane,disabled:!u,onKeyDown:this.onKeyDownItem})),w&&b.a.createElement("div",{className:"detailsSection flexbox"},b.a.createElement("div",{className:"c-foreground-faded"},"Note"),b.a.createElement(M.a,{className:"c-border",ref:this.refNoteText,item:i,heightEmpty:34,heightValue:150,onValueSet:this.onNoteValueSet,onKeyDown:this.onKeyDownNote,tabIndex:V++,shouldSave:!a})),b.a.createElement("div",{className:"detailsSection flexbox"},b.a.createElement("div",{className:"c-foreground-faded"},"Options"),b.a.createElement("span",{className:"itemDetailOption c-border pointer",onClick:this.onClickStar},b.a.createElement("span",{className:"c-foreground-super-faded"},"Star:"),b.a.createElement("i",{className:v.default.classNames("starButton icon-star c-foreground-super-faded",{selected:f})})),b.a.createElement("span",{className:"itemDetailOption c-border"},b.a.createElement("span",{className:"c-foreground-super-faded"},"Priority:"),b.a.createElement("span",{className:v.default.classNames("searchPriority searchP0",{selected:h===y.a.VMLIFlag.P0}),onClick:this.setPriority.bind(this,y.a.VMLIFlag.P0)}),b.a.createElement("span",{className:v.default.classNames("searchPriority searchP1",{selected:h===y.a.VMLIFlag.P1}),onClick:this.setPriority.bind(this,y.a.VMLIFlag.P1)}),b.a.createElement("span",{className:v.default.classNames("searchPriority searchP2",{selected:h===y.a.VMLIFlag.P2}),onClick:this.setPriority.bind(this,y.a.VMLIFlag.P2)}))),a&&(L||s.options)&&b.a.createElement("div",{className:"detailsSection"},F&&b.a.createElement(I.a,{key:"addLocal",initialChecked:u,ref:this.refCheckAddLocal,onChange:this.onChangeAddLocal,disabled:!F,tabIndex:F?V++:void 0},"Add to document"),F&&b.a.createElement(I.a,{key:"addToCalendar",initialChecked:d,ref:this.refCheckAddCalendar,onChange:this.onChangeAddToCalendar,disabled:!F,tabIndex:F?V++:void 0},"Add to Google Calendar"),s.options&&s.options.map((function(e){return b.a.createElement(I.a,{key:e.text,initialChecked:e.value,ref:e.text,tabIndex:V++},e.text)}))),(F||_)&&this.renderCalendarSelector(),e&&b.a.createElement("div",{className:"detailsSection"},b.a.createElement("div",{className:"c-foreground-faded"},"Subitems"),b.a.createElement("div",{className:"children c-border"},e)),a&&b.a.createElement("div",{className:"bottomRow flexbox"},b.a.createElement(A.a,{onClick:this.onEscape},"CANCEL"),b.a.createElement(A.a,{primary:!0,marginLeft:8,onClick:this.save,tabIndex:V++,ref:this.refSave},"SAVE")),b.a.createElement(P,{component:this,target:"item",tabIndex:V++}))}}]),a}(x.a);t.default=F},452:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(7),o=a.n(i),l=a(8),s=a.n(l),c=a(17),u=a.n(c),d=a(18),m=a.n(d),h=a(9),f=a.n(h),p=a(0),g=a(1),v=a(4),y=a(3),E=a(33),k=a(58),C=a(75),b=a(182),x=a(404);function D(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=f()(e);if(t){var r=f()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return m()(this,a)}}var w=function(e){u()(a,e);var t=D(a);function a(){return o()(this,a),t.apply(this,arguments)}return s()(a,[{key:"init",value:function(){this.DISABLE_LISTENER_ASSERT=!0}},{key:"getState",value:function(e){for(var t=0,a=e.pane,n=a.search,r={hasFilter:!1,showHelp:v.default.settings.shouldShowHelp("searchHelp"),viewState:a.viewState,viewMode:a.getViewMode(),sortModeBlocks:a.supportsSortBlocks()&&a.getSortModeBlocks(),sortModeItems:a.supportsSortItems()&&a.getSortModeItems(),calendars:C.a.GCalendarsAvailable,displayCalendars:a.displayCalendars,displayLocalItems:a.displayLocalItems,closedHelps:v.default.settings.closedHelps},i=0;i<n.filters.length;i++){if(t++>5e3&&__infLoop&&__infLoop(t))throw new RangeError;var o=n.filters[i];r[o.name]=o.value,r[o.name+"Enabled"]=o.enabled,0!==o.value.get()&&(r.hasFilter=!0)}return r}},{key:"onMount",value:function(){this.listenTo(this.props.pane.search.onChanged)}},{key:"componentWillReceiveProps",value:function(e){e.pane!==this.props.pane&&(this.refreshListeners(e),this.updateState(e))}},{key:"onClickSelectCalendars",value:function(e){v.default.menus.openContextMenu({componentName:"ReactContextMenuCalendars",element:e.target,pane:this.props.pane})}},{key:"saveScrollOfTop",value:function(){this.props.pane}},{key:"onToggleButton",value:function(e){this.saveScrollOfTop(),this.props.pane.search.toggleFilter(e)}},{key:"setPriority",value:function(e){this.saveScrollOfTop();var t=this.props.pane.search;t.getFilterValue("priority")===e&&(e=0),t.setFilter("priority",e)}},{key:"onClickCloseHelp",value:function(){v.default.settings.closeHelp("searchHelp")}},{key:"onClickShowHelp",value:function(){v.default.settings.uncloseHelp("searchHelp")}},{key:"renderSearchButton",value:function(e){var t=this.props.pane,a="showOnlyMatches"===e.name&&t.isViewFlatList()?1:e.value.get();return y.createElement(b.a,{key:e.name,filter:e,filterValue:a,search:t.search,hasBorder:!0})}},{key:"renderSearchPriority",value:function(){var e=this.props.pane.search.filter_priority.value.get(),t=p.default.classNames("searchPriorities c-border-light",{hasSelected:!!e}),a=p.default.classNames("searchPriority searchP0",{selected:e===g.a.VMLIFlag.P0}),n=p.default.classNames("searchPriority searchP1",{selected:e===g.a.VMLIFlag.P1}),r=p.default.classNames("searchPriority searchP2",{selected:e===g.a.VMLIFlag.P2});return y.createElement("span",{key:"priority",className:t},y.createElement("span",{className:a,"data-tooltip":"Show only high priority",onClick:this.setPriority.bind(this,g.a.VMLIFlag.P0)}),y.createElement("span",{className:n,"data-tooltip":"Show medium priority and higher",onClick:this.setPriority.bind(this,g.a.VMLIFlag.P1)}),y.createElement("span",{className:r,"data-tooltip":"Show low priority and higher",onClick:this.setPriority.bind(this,g.a.VMLIFlag.P2)}))}},{key:"render",value:function(){for(var e=0,t=this.state,a=this.props.pane,n=a.search,r=t.showHelp,i=[],o=[],l=p.default.classNames("filterSection flexbox",{showHelp:r}),s=0;s<n.filters.length;s++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var c=n.filters[s];c.enabled.get()&&(c.isOption?c.hideInView||o.push(this.renderSearchButton(c)):c.icon?i.push(this.renderSearchButton(c)):"priority"===c.name&&i.push(this.renderSearchPriority()))}if(a.isViewDates()){var u=a.isCalFilterActive(),d=p.default.classNames("buttonCalendars searchButton icon-calendar c-border-light c-button",{selected:u});o.push(y.createElement("div",{key:"calendars",className:d,onClick:this.onClickSelectCalendars,"data-tooltip":"Select calendars to display in this pane"}))}return y.createElement("div",{className:l},i.length>0&&y.createElement("div",null,y.createElement("div",{className:"searchFilters c-border-light"},i)),o.length>0&&y.createElement("div",null,y.createElement("div",{className:"searchFilters c-border-light"},o)))}}]),a}(E.a),S=a(20),M=a(70),N=a(95);function P(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var a,n=f()(e);if(t){var r=f()(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return m()(this,a)}}var I=function(e){u()(a,e);var t=P(a);function a(){return o()(this,a),t.apply(this,arguments)}return s()(a,[{key:"getState",value:function(){var e=0,t=this.props.pane,a=t.search,n={closedHelps:v.default.settings.closedHelps,hasFilter:!1,matches:k.a.matches,showHelp:v.default.settings.shouldShowHelp("searchHelp"),viewState:t.viewState,viewMode:t.getViewMode()};t.isViewDates()&&(n.calendars=C.a.GCalendarsAvailable,n.displayCalendars=t.displayCalendars,n.displayLocalItems=t.displayLocalItems);for(var r=0;r<a.filters.length;r++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var i=a.filters[r];n[i.name]=i.value,n[i.name+"Enabled"]=i.enabled,0!==i.value.get()&&(n.hasFilter=!0)}return n}},{key:"onMount",value:function(){this.listenTo(this.props.pane.search.onChanged),this.props.pane.onDestroyed.listen(this.close)}},{key:"onUnmount",value:function(){k.a.onClosed(),this.props.pane.onDestroyed.unlisten(this.close)}},{key:"close",value:function(){v.default.menus.isContextMenuOpen("ReactContextMenuSearch")&&v.default.menus.closeContextMenu("ReactContextMenuSearch")}},{key:"onSettingChanged",value:function(){this.updateState()}},{key:"onClickSelectCalendars",value:function(e){v.default.menus.openContextMenu({componentName:"ReactContextMenuCalendars",element:e.target,pane:this.props.pane})}},{key:"saveScrollOfTop",value:function(){this.props.pane}},{key:"onToggleButton",value:function(e){this.saveScrollOfTop(),this.props.pane.search.toggleFilter(e)}},{key:"setPriority",value:function(e){this.saveScrollOfTop();var t=this.props.pane.search;t.getFilterValue("priority")===e&&(e=0),t.setFilter("priority",e)}},{key:"onClickToggleHelp",value:function(){this.state.showHelp?v.default.settings.closeHelp("searchHelp"):v.default.settings.uncloseHelp("searchHelp")}},{key:"renderSearchButton",value:function(e){var t=this.props.pane;return y.createElement(b.a,{key:e.name,filter:e,filterValue:e.value.get(),search:t.search,hasBorder:!0})}},{key:"renderSearchPriority",value:function(){var e=this.props.pane.search.filter_priority.value.get(),t=p.default.classNames("searchPriorities",{hasSelected:!!e}),a=p.default.classNames("searchPriority searchP0",{selected:e===g.a.VMLIFlag.P0}),n=p.default.classNames("searchPriority searchP1",{selected:e===g.a.VMLIFlag.P1}),r=p.default.classNames("searchPriority searchP2",{selected:e===g.a.VMLIFlag.P2});return y.createElement("span",{key:"priority",className:t},y.createElement("span",{className:a,"data-tooltip":"Show only high priority",onClick:this.setPriority.bind(this,g.a.VMLIFlag.P0)}),y.createElement("span",{className:n,"data-tooltip":"Show medium priority and higher",onClick:this.setPriority.bind(this,g.a.VMLIFlag.P1)}),y.createElement("span",{className:r,"data-tooltip":"Show low priority and higher",onClick:this.setPriority.bind(this,g.a.VMLIFlag.P2)}))}},{key:"render",value:function(){for(var e=0,t=this.props,a=this.props.pane,n=this.state,i=a.search,o=[],l=[],s=0;s<i.filters.length;s++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var c=i.filters[s];c.enabled.get()&&(c.isOption?l.push(this.renderSearchButton(c)):c.icon?o.push(this.renderSearchButton(c)):"priority"===c.name&&o.push(this.renderSearchPriority()))}if(a.isViewDates()){var u=a.isCalFilterActive(),d=p.default.classNames("buttonCalendars",{selected:u});l.push(y.createElement(S.a,{key:"calendars",height:g.a.SearchHeight,className:d,onClick:this.onClickSelectCalendars,padding:8,tooltip:"Select calendars to display in this pane"},"Calendars"))}return y.createElement("div",null,y.createElement(M.a,r()({},t,{key:"contextMenuSearch"+a.id,id:"contextMenuSearch",maxHeight:400,element:t.element}),n.matches.length>0&&y.createElement(x.default,{onlyMatches:!0,matches:n.matches}),0===n.matches.length&&y.createElement("div",{className:"flexbox"},!1!==t.showFilters&&y.createElement(w,{pane:a}),y.createElement("div",{className:"f1"}),y.createElement(S.a,{className:"searchHelpButton",icon:"icon-question",iconSize:12,width:32,height:32,color:n.showHelp?g.a.ColorBrand:void 0,onClick:this.onClickToggleHelp}))),n.showHelp&&y.createElement(M.a,r()({},t,{key:"contextMenuSearchHelp"+a.id,id:"contextMenuSearchHelp",maxHeight:500,element:t.element,positionOffset:{top:40}}),y.createElement("div",{className:"rel"},y.createElement(N.a,null,"Hints"),y.createElement(S.a,{className:"searchHintsClose",icon:"icon-close",iconSize:14,width:36,height:28,onClick:this.onClickToggleHelp}),y.createElement("div",{className:"searchHints c-foreground-light"},y.createElement("div",null,y.createElement("span",null,"-",y.createElement("b",null,"word")),"hide items including ",y.createElement("b",null,"word")),y.createElement("div",null,y.createElement("span",null,y.createElement("b",null,"a")," or ",y.createElement("b",null,"b")),"show items matching ",y.createElement("b",null,"a")," or ",y.createElement("b",null,"b")),y.createElement("div",null,y.createElement("span",null,"#",y.createElement("b",null,"tag")),"show items with #",y.createElement("b",null,"tag")),y.createElement("div",null,y.createElement("span",null,"+",y.createElement("b",null,"name")),"show items with +",y.createElement("b",null,"name")),y.createElement("div",null,y.createElement("span",null,"date:",y.createElement("b",null,"date")),"show items on ",y.createElement("b",null,"date")),y.createElement("div",null,y.createElement("span",null,"date:today+",y.createElement("b",null,"num")),"show items ",y.createElement("b",null,"num")," days in the future"),y.createElement("div",null,y.createElement("span",null,"before:",y.createElement("b",null,"date")),"show items before ",y.createElement("b",null,"date")),y.createElement("div",null,y.createElement("span",null,"after:",y.createElement("b",null,"date")),"show items after ",y.createElement("b",null,"date")),y.createElement("div",null,y.createElement("span",null,"between:",y.createElement("b",null,"date1,date2")),"show items between ",y.createElement("b",null,"date1")," and ",y.createElement("b",null,"date2")),y.createElement("div",null,y.createElement("span",null,"date:overdue"),"show overdue items"),y.createElement("div",null,y.createElement("span",null,"date:any"),"show items with a date"),y.createElement("div",null,y.createElement("span",null,"date:none"),"show items with no date"),y.createElement("div",null,y.createElement("span",null,g.a.Prefix.Header," or ",g.a.Prefix.Header2),"show project items"),y.createElement("div",null,y.createElement("span",null,g.a.Prefix.Task),"show task items"),y.createElement("div",null,y.createElement("span",null,g.a.Prefix.Bullet),"show bullet items"),y.createElement("div",null,y.createElement("span",null,g.a.SearchFilterTexts.Star),"show starred items"),y.createElement("div",null,y.createElement("span",null,g.a.SearchFilterTexts.Pri2," or ",g.a.SearchFilterTexts.Pri1," or ",g.a.SearchFilterTexts.Pri0),"show priority items"),y.createElement("div",null,y.createElement("span",null,'"',y.createElement("b",null,"word1 word2"),'"'),"show the phrase ",y.createElement("b",null,'"word1 word2"')),y.createElement("div",null,y.createElement("span",null,g.a.PrefixItemAutocomplete,y.createElement("b",null,"item")),"zoom into ",y.createElement("b",null,"item"))))))}}]),a}(E.a);t.default=I},453:function(e,t,a){"use strict";a.r(t);var n=a(56),r=a.n(n),i=a(66),o=a.n(i),l=a(0),s=a(3),c=a(4),u=a(15),d=a(21);var m=function(e,t){var a=Object(s.useRef)();a.current||(a.current=null===e||void 0===e?void 0:e.listen(t)),Object(s.useEffect)((function(){return function(){var e;null===(e=a.current)||void 0===e||e.dispose(),a.current=void 0}}),[])},h=a(20),f=a(70),p=a(197);t.default=Object(d.b)((function(e){var t=e.pane,a=e.componentName,n=e.isAddPane,i=o()(e,["pane","componentName","isAddPane"]),d=s.useRef(),g=function(){c.default.menus.isContextMenuOpen(a)&&c.default.menus.closeContextMenu(a)};t&&m(t.onDestroyed,g);var v=function(){if(n){var e=d.current.getCreationProps(),t=e.pane,a=e.type;a?c.default.PaneManager.addPaneByButton(a):(t.setDocument(u.a.getDefaultDocument(),{forLoad:!0}),c.default.PaneManager.addPaneAtIndex(t)),c.default.onIntroAction("AddPane"),l.default.sendEvent("Menu","AddPane_"+a)}g()};return s.createElement(f.a,r()({},i,{id:"contextMenuPaneView",key:"contextMenuPaneView"+n,maxWidth:500,minWidth:0}),s.createElement(p.a,{pane:t,isAddPane:n,supportHotkeys:!0,onSelected:v,ref:d}),n&&s.createElement("div",{className:"center"},s.createElement(h.a,{className:"addButton",raised:!0,primary:!0,width:240,onClick:v},"Add Pane (Enter)")))}))},454:function(e,t,a){"use strict";a.r(t);var n=a(19),r=a.n(n),i=a(1),o=a(0),l=a(3),s=a.n(l),c=a(4),u=a(21),d=a(24),m={},h=i.a.Modals;m[h.Lightbox]=a(407),m[h.Prompt]=a(408),m[h.Settings]=a(449),m[h.Alert]=a(414),m[h.Billing]=a(415),m[h.Confirm]=a(416),m[h.Options]=a(417),m[h.ExportData]=a(418),m[h.ImportData]=a(419),m[h.Backups]=a(420),m[h.ReportProblem]=a(421),m[h.DeleteAccount]=a(422),m[h.Invoices]=a(423),m[h.ShareDoc]=a(424),m[h.ReportBug]=a(425),m[h.EnterCode]=a(426),m[h.ImportMoodo]=a(427),m[h.ConfirmEncrypt]=a(428),m[h.ModalPane]=a(429),m[h.ErrorCookies]=a(430),m[h.CreateTemplate]=a(450);var f=m;t.default=Object(u.b)((function(){var e=Object(d.a)(c.default.menus.modalStack),t=r()(e,1)[0],a=o.default.classNames("modals",{none:0===t.length});return s.a.createElement("div",{className:a},t.map((function(e){return s.a.createElement(f[e.id].default,Object.assign({key:e.id},e))})))}),(function(){return c.default.menus.modalStack.clear()}))},455:function(e,t,a){"use strict";a.r(t);var n=a(19),r=a.n(n),i=a(0),o=a(3),l=a.n(o),s=a(4),c=a(21),u=a(24),d={ReactAutocomplete:a(404),ReactContextMenuOverviewOptions:a(431),ReactContextMenuGmailSort:a(432),ReactContextMenuSearch:a(452),ReactContextMenuCalendars:a(433),ReactContextMenuInsertLink:a(434),ReactContextMenuContactDetails:a(435),ReactNotePopup:a(436),ReactItemDetailsPopup:a(451),ReactContextMenuEmailDetails:a(437),ReactContextMenuItem:a(438),ReactContextMenuOnlineStatus:a(439),ReactContextMenuShare:a(440),ReactContextMenuOptions:a(441),ReactContextMenuUpsell:a(442),ReactContextMenuDropZone:a(443),ReactContextMenuDate:a(444),ReactContextMenuDocumentPassword:a(445),ReactContextMenuPaneView:a(453),ReactContextMenuSlashHelp:a(446),ReactContextMenuInboxItem:a(447)};t.default=Object(c.b)((function(){for(var e=0,t=Object(u.a)(s.default.menus.contextMenuStack),a=r()(t,1)[0],n=function(e){var t=s.default.menus.getTopContextMenu();t&&s.default.menus.closeContextMenu(t),i.default.preventAndStop(e)},o=[],c=0;c<a.length;c++){if(e++>5e3&&__infLoop&&__infLoop(e))throw new RangeError;var m=a[c];if(m.noBackdrop||o.push(l.a.createElement("div",{key:"backdrop_"+c,className:"contextMenusBackdrop",onMouseDown:n})),m.fn)o.push(m.fn(m));else if(m.componentName){m.key=m.key||m.componentName,m.id=m.id||m.key;var h=d[m.componentName].default;o.push(l.a.createElement(h,m))}}var f=i.default.classNames("contextMenusReact",{open:o.length>0},{takeClick:o.length>0&&!m.noBackdrop},{none:0===o.length});return l.a.createElement("div",{className:f},o)}),(function(){return s.default.menus.contextMenuStack.clear()}))}}]);
